(()=>{"use strict";const e=(()=>{const e=()=>JSON.parse(localStorage.getItem("projects")||"[]"),t=t=>{const r=e(),n=r.find((e=>e.id==t.id));n?(n.projectName=t.projectName,n.tasks=t.tasks):(t.id=Math.floor(1e6*Math.random()),r.push(t)),localStorage.setItem("projects",JSON.stringify(r))};return{getProjects:e,getTasks:t=>e().find((e=>e.id==t)).tasks,saveProject:t,deleteProject:t=>{const r=e().filter((e=>e.id!=t));localStorage.setItem("projects",JSON.stringify(r))},deleteTask:(r,n)=>{const a=e().find((e=>e.id==r)),o=a.tasks.filter((e=>e.taskId!=n));a.tasks=o,t(a)},findTaskToUpdate:(t,r)=>e().find((e=>e.id==t)).tasks.find((e=>e.taskId==r)),updateTask:(t,r)=>{const n=e(),a=n.find((e=>e.id==t)),o=a.tasks,s=o.findIndex((e=>e.taskId==r.taskId));o[s]=r,a.tasks=o,localStorage.setItem("projects",JSON.stringify(n))}}})();function t(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function r(e){t(1,arguments);var r=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===r?new Date(e.getTime()):"number"==typeof e||"[object Number]"===r?new Date(e):("string"!=typeof e&&"[object String]"!==r||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function n(e){t(1,arguments);var n=r(e);return n.setHours(0,0,0,0),n}function a(e,r){t(2,arguments);var a=n(e),o=n(r);return a.getTime()===o.getTime()}function o(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}var s=36e5,c={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},i=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,d=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,l=/^([+-])(\d{2})(?::?(\d{2}))?$/;function u(e,r){t(1,arguments);var n=r||{},a=null==n.additionalDigits?2:o(n.additionalDigits);if(2!==a&&1!==a&&0!==a)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var s,c=m(e);if(c.date){var i=p(c.date,a);s=f(i.restDateString,i.year)}if(isNaN(s)||!s)return new Date(NaN);var d,l=s.getTime(),u=0;if(c.time&&(u=k(c.time),isNaN(u)||null===u))return new Date(NaN);if(!c.timezone){var g=new Date(l+u),E=new Date(0);return E.setFullYear(g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate()),E.setHours(g.getUTCHours(),g.getUTCMinutes(),g.getUTCSeconds(),g.getUTCMilliseconds()),E}return d=y(c.timezone),isNaN(d)?new Date(NaN):new Date(l+u+d)}function m(e){var t,r={},n=e.split(c.dateTimeDelimiter);if(n.length>2)return r;if(/:/.test(n[0])?(r.date=null,t=n[0]):(r.date=n[0],t=n[1],c.timeZoneDelimiter.test(r.date)&&(r.date=e.split(c.timeZoneDelimiter)[0],t=e.substr(r.date.length,e.length))),t){var a=c.timezone.exec(t);a?(r.time=t.replace(a[1],""),r.timezone=a[1]):r.time=t}return r}function p(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:null};var a=n[1]&&parseInt(n[1]),o=n[2]&&parseInt(n[2]);return{year:null==o?a:100*o,restDateString:e.slice((n[1]||n[2]).length)}}function f(e,t){if(null===t)return null;var r=e.match(i);if(!r)return null;var n=!!r[4],a=g(r[1]),o=g(r[2])-1,s=g(r[3]),c=g(r[4]),d=g(r[5])-1;if(n)return function(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}(0,c,d)?function(e,t,r){var n=new Date(0);n.setUTCFullYear(e,0,4);var a=7*(t-1)+r+1-(n.getUTCDay()||7);return n.setUTCDate(n.getUTCDate()+a),n}(t,c,d):new Date(NaN);var l=new Date(0);return function(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(v[t]||(S(e)?29:28))}(t,o,s)&&function(e,t){return t>=1&&t<=(S(e)?366:365)}(t,a)?(l.setUTCFullYear(t,o,Math.max(a,s)),l):new Date(NaN)}function g(e){return e?parseInt(e):1}function k(e){var t=e.match(d);if(!t)return null;var r=E(t[1]),n=E(t[2]),a=E(t[3]);return function(e,t,r){return 24===e?0===t&&0===r:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}(r,n,a)?r*s+6e4*n+1e3*a:NaN}function E(e){return e&&parseFloat(e.replace(",","."))||0}function y(e){if("Z"===e)return 0;var t=e.match(l);if(!t)return 0;var r="+"===t[1]?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return function(e,t){return t>=0&&t<=59}(0,a)?r*(n*s+6e4*a):NaN}var v=[31,null,31,30,31,30,31,31,30,31,30,31];function S(e){return e%400==0||e%4==0&&e%100}function j(e,n){t(1,arguments);var a=n||{},s=a.locale,c=s&&s.options&&s.options.weekStartsOn,i=null==c?0:o(c),d=null==a.weekStartsOn?i:o(a.weekStartsOn);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var l=r(e),u=l.getDay(),m=(u<d?7:0)+u-d;return l.setDate(l.getDate()-m),l.setHours(0,0,0,0),l}function h(e,r,n){t(2,arguments);var a=j(e,n),o=j(r,n);return a.getTime()===o.getTime()}const T=(()=>{const r=()=>{const t=e.getProjects();w(t)},n=e=>{if(function(e){return t(1,arguments),a(e,Date.now())}(u(e.dueDate)))return e},o=e=>{if(function(e,r){return t(1,arguments),h(e,Date.now(),r)}(u(e.dueDate)))return e},s=e=>{c();const t=document.querySelector(".notepad");e.forEach((e=>{D(e.id);const r=e.tasks,n=t.querySelector(`[data-project-id="${e.id}"]`),a=n.querySelector("ul"),o=n.querySelector(".add-task");r.forEach((e=>{const t=L(e);a.insertBefore(t,o.parentElement)}))}))},c=()=>{document.querySelector("#writing-area").querySelectorAll(".project").forEach((e=>e.remove()))};return{onProjectSelect:t=>{const r=e.getProjects();s(r);const n=r.find((e=>e.id==t)),a=document.querySelector("#sidebar").querySelector(`[data-project-id='${n.id}']`);document.querySelectorAll(".project").forEach((e=>{e.dataset.projectId!=t&&e.remove()})),C(a)},onProjectAdd:t=>{const n={projectName:t,tasks:[]};e.saveProject(n),r(),document.querySelector(`[data-project-id='${n.id}']`)},onProjectNameEdit:(t,n,a=e.getTasks(t))=>{e.saveProject({id:t,projectName:n,tasks:a}),r()},onTaskAdd:(t,r)=>{const n={item:t,taskId:Math.floor(1e6*Math.random()),priority:"low",dueDate:null,isComplete:!1},a=e.getProjects().find((e=>e.id==r));return a.tasks.push(n),e.saveProject(a),n},onTaskNameEdit:(t,r,n)=>{const a=e.findTaskToUpdate(t,r);e.updateTask(t,{item:n,taskId:a.taskId,priority:a.priority,dueDate:a.dueDate,isComplete:a.isComplete})},onTaskPriorityEdit:(t,r,n)=>{const a=e.findTaskToUpdate(t,r);e.updateTask(t,{item:a.item,taskId:a.taskId,priority:n,dueDate:a.dueDate,isComplete:a.isComplete})},onTaskDueDateEdit:(t,r,n)=>{const a=e.findTaskToUpdate(t,r);e.updateTask(t,{item:a.item,taskId:a.taskId,priority:a.priority,dueDate:n,isComplete:a.isComplete})},onTaskCompleteEdit:(t,r,n)=>{const a=e.findTaskToUpdate(t,r);e.updateTask(t,{item:a.item,taskId:a.taskId,priority:a.priority,dueDate:a.dueDate,isComplete:n})},onHomeTabSelect:(e,t)=>{s(e),C(t)},onTodayTabSelect:(e,t)=>{s(e),e.forEach((e=>{const t=e.tasks;0===t.filter((e=>n(e))).length&&document.querySelector(".notepad").querySelector(`[data-project-id="${e.id}"]`).remove(),t.filter((e=>!n(e))).forEach((e=>{const t=document.querySelector(`[data-task-id="${e.taskId}"]`);t&&t.remove()}))})),C(t)},onThisWeekTabSelect:(e,t)=>{s(e),e.forEach((e=>{const t=e.tasks;0===t.filter((e=>o(e))).length&&document.querySelector(".notepad").querySelector(`[data-project-id="${e.id}"]`).remove(),t.filter((e=>!o(e))).forEach((e=>{const t=document.querySelector(`[data-task-id="${e.taskId}"]`);t&&t.remove()}))})),C(t)}}})(),I=()=>({createListElement:e=>{const t=document.createElement("li");return t.setAttribute("class",e),t},createSpanElement:e=>{const t=document.createElement("span");return t.classList.add(e),t},createImageElement:(e,t)=>{const r=document.createElement("img");return r.classList.add(t),r.setAttribute("src",e),r.setAttribute("draggable","false"),r},createInputField:e=>{const t=document.createElement("input");return t.setAttribute("type","text"),t.setAttribute("placeholder",e),t.setAttribute("id","user-input"),t.required=!0,t},createForm:()=>document.createElement("form"),createDiv:e=>{const t=document.createElement("div");return t.setAttribute("class",e),t}}),b=()=>{const e=I(),t=e.createSpanElement("icons"),r=e.createImageElement("images/edit-icon.svg","edit-icon"),n=e.createImageElement("images/delete-icon.svg","delete-icon");return r.classList.add("edit-project"),n.classList.add("delete-project"),t.append(r,n),t},D=t=>{const r=I(),n=e.getProjects().find((e=>e.id==t)).projectName,a=document.querySelector("#writing-area"),o=r.createDiv("project");o.setAttribute("data-project-id",t);const s=r.createDiv("skip-line"),c=r.createDiv("project-heading"),i=document.createElement("h2");i.setAttribute("class","notepad-text"),i.textContent=n;const d=document.createElement("h3");d.setAttribute("class","notepad-text"),d.textContent="Due Date";const l=document.createElement("ul");l.classList.add("notepad-text","todos");const u=r.createListElement("task"),m=r.createSpanElement("add-task"),p=r.createImageElement("images/add-icon.svg","add-icon");m.append(p,"Add Task"),u.append(m),l.append(u,s),c.append(i,d),o.append(c,l),a.append(o)},q=()=>{const e=I().createSpanElement("due-date"),t=I().createImageElement("images/priority-icon.svg","priority-icon");t.classList.add("priority-low");const r=document.createElement("label");r.classList.add("date-label");const n=document.createElement("input");n.setAttribute("type","date"),n.required=!0;const a=I().createImageElement("images/calendar-icon.svg","calendar-icon");return r.append(n,a),e.append(t,r),n.addEventListener("change",(()=>{const e=n.closest(".project").dataset.projectId,t=n.closest("[data-task-id]").dataset.taskId,r=n.value;return T.onTaskDueDateEdit(e,t,r)})),e},N=(e,t)=>{const r=I(),n=r.createListElement("project-item");n.setAttribute("data-project-id",e);const a=r.createSpanElement("project-name");a.textContent=t;const o=b();return n.append(a,o),n},w=e=>{const t=document.querySelector(".project-list"),r=document.querySelector("[data-add-project]");[].slice.call(t.children).forEach((e=>{e.classList.contains("project-item")&&e.remove()}));for(const n of e){const e=N(n.id,n.projectName);t.insertBefore(e,r)}t.querySelectorAll(".project-item").forEach((e=>{e.addEventListener("click",(t=>{const r=document.querySelector("#user-input");"IMG"===t.target.nodeName||r||T.onProjectSelect(e.dataset.projectId)}))}))},L=e=>{const t=I(),r=t.createListElement("task");r.setAttribute("data-task-id",e.taskId);const n=t.createSpanElement("task-item"),a=t.createSpanElement("task-text");a.textContent=e.item;const o=b();n.append(a,o);const s=q();return s.querySelector(".priority-icon").classList.add(`priority-${e.priority}`),s.querySelector("input").value=e.dueDate,e.isComplete&&r.classList.add("completed"),r.append(n,s),r},C=e=>{const t=document.querySelector(".active");t&&t.classList.remove("active"),e.classList.add("active"),e.children.item(0)},P=()=>null!=document.querySelector("#user-input"),A=()=>{const e=document.querySelector("#user-input"),t=e.parentElement.parentElement,r=I().createSpanElement("project-name"),n=e.value.trim();n&&(r.textContent=n,e.parentElement.remove(),t.insertBefore(r,t.childNodes[0]))},x=()=>{if(P())return;(()=>{const e=I(),t=document.querySelector(".project-list"),r=e.createListElement("project-item"),n=e.createForm(),a=e.createInputField("Project name...");n.append(a);const o=b();r.append(n,o),t.insertBefore(r,t.lastElementChild),setTimeout((()=>{a.focus()}),0)})();const e=document.querySelector("#user-input"),t=e.parentElement,r=t.parentElement;e.addEventListener("blur",(function(){if(""==e.value.trim())return void r.remove();A();const t=r.firstElementChild.textContent;T.onProjectAdd(t);const n=document.querySelector(".project-list"),a=n.children[n.childElementCount-2].getAttribute("data-project-id");P()||D(a)})),t.addEventListener("submit",(function(e){e.preventDefault(),A();const t=r.firstElementChild.textContent;T.onProjectAdd(t);const n=document.querySelector(".project-list"),a=n.children[n.childElementCount-2].getAttribute("data-project-id");P()||D(a)}))},$=()=>{const e=document.querySelector("#user-input"),t=e.parentElement,r=t.parentElement.parentElement;e.addEventListener("blur",(function(){const t=r.closest("[data-project-id]").dataset.projectId,n=e.value;F(),n&&U(n,t,r)})),t.addEventListener("submit",(function(t){t.preventDefault();const n=r.closest("[data-project-id]").dataset.projectId,a=e.value;F(),a&&U(a,n,r)}))},U=(e,t,r)=>{if(r.dataset.taskId)return T.onTaskNameEdit(t,r.dataset.taskId,e);const n=T.onTaskAdd(e,t);r.setAttribute("data-task-id",n.taskId)},F=()=>{const e=document.querySelector("#user-input"),t=e.parentElement,r=t.parentElement,n=r.parentElement,a=e.value.trim(),o=I().createSpanElement("task-text");o.append(a),""!=a||n.dataset.taskId?""==a&&n.dataset.taskId||(t.remove(),r.prepend(o),M(o,n)):n.remove()},M=(e,t)=>{const r=42*Math.round(t.offsetHeight/42);e.style.height=`${r}px`,t.style.height=`${r}px`};window.onload=()=>{const t=e.getProjects(),r=document.querySelector('[data-tab="home"]'),n=new MutationObserver((e=>{e.forEach((e=>{if(e.addedNodes.length){const e=document.querySelectorAll(".task");console.log(e),e.forEach((e=>{if(e.querySelector(".add-task")){const t=e.querySelector(".add-task");M(e,t)}else{const t=e.querySelector(".task-text");M(e,t)}}))}}))})),a=document.querySelector("#writing-area");n.observe(a,{childList:!0}),w(t),T.onHomeTabSelect(t,r)},(()=>{const t=document.getElementById("bars-icon-mobile");window.innerWidth<=1024&&t.classList.contains("hidden")&&t.classList.toggle("hidden");const r=document.getElementById("sidebar"),n=()=>{r.classList.toggle("toggle-sidebar"),window.innerWidth<=1024&&t.classList.toggle("hidden")};document.querySelectorAll(".bars-icon").forEach((e=>{e.addEventListener("click",n)}));const a=r.querySelector('[data-tab="home"]'),o=r.querySelector('[data-tab="today"]'),s=r.querySelector('[data-tab="this-week"]');a.addEventListener("click",(()=>{const t=e.getProjects();T.onHomeTabSelect(t,a)})),o.addEventListener("click",(()=>{const t=e.getProjects();T.onTodayTabSelect(t,o)})),s.addEventListener("click",(()=>{const t=e.getProjects();T.onThisWeekTabSelect(t,s)}))})(),document.querySelector(".project-list").addEventListener("click",(t=>{if(t.target.closest(".delete-project")){if(!confirm("Are you sure you want to delete this project and all its tasks? This action cannot be undone."))return;const r=t.target.closest("[data-project-id]").dataset.projectId;document.querySelectorAll(`[data-project-id="${r}"]`).forEach((e=>e.remove())),e.deleteProject(r)}})),document.querySelector("[data-add-project]").addEventListener("click",x),document.querySelector(".project-list").addEventListener("click",(e=>{e.target.classList.contains("edit-project")&&(e=>{if(P())return;const t=I().createForm(),r=I().createInputField("Project name..."),n=e.target.parentElement.previousElementSibling;r.value=n.textContent,n.remove(),t.append(r);const a=e.target.closest(".project-item");a.insertBefore(t,a.childNodes[0]);const o=document.querySelector("#user-input");o.focus();const s=a.dataset.projectId;o.addEventListener("blur",(function(){""!=o.value&&A();const e=a.firstElementChild.textContent;c(s,e),T.onProjectNameEdit(s,e)})),t.addEventListener("submit",(function(e){e.preventDefault(),A();const t=a.firstElementChild.textContent;c(s,t),T.onProjectNameEdit(s,t)}));const c=(e,t)=>{const r=document.querySelector(".notepad").querySelector(`[data-project-id="${e}"]`);r&&(r.childNodes[0].childNodes[0].textContent=t)}})(e)})),document.querySelector(".notepad").addEventListener("click",(t=>{var r,n;t.target.classList.contains("task-text")?(e=>{e.classList.toggle("completed");let t=!1;e.classList.contains("completed")&&(t=!0);const r=e.closest(".project").dataset.projectId,n=e.dataset.taskId;T.onTaskCompleteEdit(r,n,t)})(t.target.closest(".task")):t.target.classList.contains("add-task")?((e=>{if(document.getElementById("user-input"))return;const t=I().createListElement("task"),r=I().createSpanElement("task-item"),n=I().createForm(),a=I().createInputField("Enter Task...");n.append(a),r.append(n);const o=I().createSpanElement("icons"),s=I().createImageElement("images/edit-icon.svg","edit-icon"),c=I().createImageElement("images/delete-icon.svg","delete-icon");o.append(s,c),r.append(o);const i=q();t.append(r,i);const d=e.closest(".todos"),l=d.childElementCount-2;d.insertBefore(t,d.children[l]),setTimeout((()=>{a.focus()}),0)})(t.target),$()):t.target.classList.contains("priority-icon")?(e=>{if(e.parentElement.parentElement.classList.contains("completed"))return;const t=e.closest(".project").dataset.projectId,r=e.closest("[data-task-id]").dataset.taskId,n=e.classList;n.contains("priority-low")?(n.remove("priority-low"),n.add("priority-medium"),T.onTaskPriorityEdit(t,r,"medium")):n.contains("priority-medium")?(n.remove("priority-medium"),n.add("priority-high"),T.onTaskPriorityEdit(t,r,"high")):n.contains("priority-high")&&(n.remove("priority-high"),n.add("priority-low"),T.onTaskPriorityEdit(t,r,"low"))})(t.target):t.target.classList.contains("edit-icon")?(e=>{if(e.classList.contains("completed"))return;const t=e.querySelector(".task-text"),r=t.textContent;t.remove();const n=I().createForm(),a=I().createInputField("Enter Task...");a.value=r,n.append(a);const o=e.querySelector(".task-item"),s=e.querySelector(".icons");o.insertBefore(n,s),e.prepend(o),a.focus(),$()})(t.target.closest(".task")):t.target.classList.contains("delete-icon")&&(r=t.target.closest("[data-project-id]").dataset.projectId,n=t.target.closest("[data-task-id]").dataset.taskId,document.querySelector(`[data-task-id="${n}"]`).remove(),e.deleteTask(r,n))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQUEsTUFpRkEsRUFqRnNCLE1BRWxCLE1BQU1BLEVBQWMsSUFFQ0MsS0FBS0MsTUFBTUMsYUFBYUMsUUFBUSxhQUFlLE1BVzlEQyxFQUFlQyxJQUNqQixNQUFNQyxFQUFXUCxJQUdYUSxFQUFXRCxFQUFTRSxNQUFLQyxHQUFXQSxFQUFRQyxJQUFNTCxFQUFjSyxLQUVsRUgsR0FDQUEsRUFBU0ksWUFBY04sRUFBY00sWUFDckNKLEVBQVNLLE1BQVFQLEVBQWNPLFFBRy9CUCxFQUFjSyxHQUFLRyxLQUFLQyxNQUFzQixJQUFoQkQsS0FBS0UsVUFHbkNULEVBQVNVLEtBQUtYLElBR2xCSCxhQUFhZSxRQUFRLFdBQVlqQixLQUFLa0IsVUFBVVosS0E4Q3BELE1BQU8sQ0FBRVAsWUFBQUEsRUFBYW9CLFNBdEVKQyxHQUNHckIsSUFDZVMsTUFBS0MsR0FBV0EsRUFBUUMsSUFBTVUsSUFDakNSLE1BbUVEUixZQUFBQSxFQUFhaUIsY0FsQnRCWCxJQUNuQixNQUNNWSxFQURXdkIsSUFDbUJ3QixRQUFPZCxHQUFXQSxFQUFRQyxJQUFNQSxJQUVwRVIsYUFBYWUsUUFBUSxXQUFZakIsS0FBS2tCLFVBQVVJLEtBY1FFLFdBWHpDLENBQUNkLEVBQUllLEtBQ3BCLE1BQ01DLEVBRFczQixJQUNnQlMsTUFBS0MsR0FBV0EsRUFBUUMsSUFBTUEsSUFHekRpQixFQUZXRCxFQUFnQmQsTUFFRFcsUUFBT0ssR0FBV0EsRUFBUUgsUUFBVUEsSUFDcEVDLEVBQWdCZCxNQUFRZSxFQUV4QnZCLEVBQVlzQixJQUd3REcsaUJBMUIvQyxDQUFDVCxFQUFXVSxJQUNoQi9CLElBQ2dCUyxNQUFLQyxHQUFXQSxFQUFRQyxJQUFNVSxJQUM1QlIsTUFDSEosTUFBS3VCLEdBQVFBLEVBQUtOLFFBQVVLLElBc0IwQkUsV0EzQ3ZFLENBQUNaLEVBQVdhLEtBRTNCLE1BQU0zQixFQUFXUCxJQUNYbUMsRUFBa0I1QixFQUFTRSxNQUFLQyxHQUFXQSxFQUFRQyxJQUFNVSxJQUN6RGUsRUFBYUQsRUFBZ0J0QixNQUc3QndCLEVBQXFCRCxFQUFXRSxXQUFXVCxHQUN0Q0EsRUFBUUgsUUFBVVEsRUFBWVIsU0FHekNVLEVBQVdDLEdBQXNCSCxFQUVqQ0MsRUFBZ0J0QixNQUFRdUIsRUFDeEJqQyxhQUFhZSxRQUFRLFdBQVlqQixLQUFLa0IsVUFBVVosT0FnQ3hELEdDakZlLFNBQVNnQyxFQUFhQyxFQUFVQyxHQUM3QyxHQUFJQSxFQUFLQyxPQUFTRixFQUNoQixNQUFNLElBQUlHLFVBQVVILEVBQVcsYUFBZUEsRUFBVyxFQUFJLElBQU0sSUFBTSx1QkFBeUJDLEVBQUtDLE9BQVMsWUM4QnJHLFNBQVNFLEVBQU9DLEdBQzdCTixFQUFhLEVBQUdPLFdBQ2hCLElBQUlDLEVBQVNDLE9BQU9DLFVBQVVDLFNBQVNDLEtBQUtOLEdBRTVDLE9BQUlBLGFBQW9CTyxNQUE0QixpQkFBYlAsR0FBb0Msa0JBQVhFLEVBRXZELElBQUlLLEtBQUtQLEVBQVNRLFdBQ0ksaUJBQWJSLEdBQW9DLG9CQUFYRSxFQUNsQyxJQUFJSyxLQUFLUCxJQUVTLGlCQUFiQSxHQUFvQyxvQkFBWEUsR0FBb0Qsb0JBQVpPLFVBRTNFQSxRQUFRQyxLQUFLLG9KQUViRCxRQUFRQyxNQUFLLElBQUlDLE9BQVFDLFFBR3BCLElBQUlMLEtBQUtNLE1DeEJMLFNBQVNDLEVBQVdDLEdBQ2pDckIsRUFBYSxFQUFHTyxXQUNoQixJQUFJZSxFQUFPakIsRUFBT2dCLEdBRWxCLE9BREFDLEVBQUtDLFNBQVMsRUFBRyxFQUFHLEVBQUcsR0FDaEJELEVDSk0sU0FBU0UsRUFBVUMsRUFBZUMsR0FDL0MxQixFQUFhLEVBQUdPLFdBQ2hCLElBQUlvQixFQUFxQlAsRUFBV0ssR0FDaENHLEVBQXNCUixFQUFXTSxHQUNyQyxPQUFPQyxFQUFtQmIsWUFBY2MsRUFBb0JkLFVDN0IvQyxTQUFTZSxFQUFVQyxHQUNoQyxHQUFvQixPQUFoQkEsSUFBd0MsSUFBaEJBLElBQXdDLElBQWhCQSxFQUNsRCxPQUFPWCxJQUdULElBQUlZLEVBQVNDLE9BQU9GLEdBRXBCLE9BQUlHLE1BQU1GLEdBQ0RBLEVBR0ZBLEVBQVMsRUFBSXhELEtBQUsyRCxLQUFLSCxHQUFVeEQsS0FBS0MsTUFBTXVELEdDVHJELElBQUlJLEVBQXVCLEtBR3ZCQyxFQUFXLENBQ2JDLGtCQUFtQixPQUNuQkMsa0JBQW1CLFFBQ25CQyxTQUFVLGNBRVJDLEVBQVksZ0VBQ1pDLEVBQVksNEVBQ1pDLEVBQWdCLGdDQTJETCxTQUFTQyxFQUFTckMsRUFBVXNDLEdBQ3pDNUMsRUFBYSxFQUFHTyxXQUNoQixJQUFJc0MsRUFBVUQsR0FBZ0IsR0FDMUJFLEVBQStDLE1BQTVCRCxFQUFRQyxpQkF0RUQsRUFzRXdEakIsRUFBVWdCLEVBQVFDLGtCQUV4RyxHQUF5QixJQUFyQkEsR0FBK0MsSUFBckJBLEdBQStDLElBQXJCQSxFQUN0RCxNQUFNLElBQUlDLFdBQVcsc0NBR3ZCLEdBQTBCLGlCQUFiekMsR0FBc0Usb0JBQTdDRyxPQUFPQyxVQUFVQyxTQUFTQyxLQUFLTixHQUNuRSxPQUFPLElBQUlPLEtBQUtNLEtBR2xCLElBQ0lHLEVBREEwQixFQUFjQyxFQUFnQjNDLEdBR2xDLEdBQUkwQyxFQUFZMUIsS0FBTSxDQUNwQixJQUFJNEIsRUFBa0JDLEVBQVVILEVBQVkxQixLQUFNd0IsR0FDbER4QixFQUFPOEIsRUFBVUYsRUFBZ0JHLGVBQWdCSCxFQUFnQkksTUFHbkUsR0FBSXJCLE1BQU1YLEtBQVVBLEVBQ2xCLE9BQU8sSUFBSVQsS0FBS00sS0FHbEIsSUFFSW9DLEVBRkFDLEVBQVlsQyxFQUFLUixVQUNqQjJDLEVBQU8sRUFHWCxHQUFJVCxFQUFZUyxPQUNkQSxFQUFPQyxFQUFVVixFQUFZUyxNQUV6QnhCLE1BQU13QixJQUFrQixPQUFUQSxHQUNqQixPQUFPLElBQUk1QyxLQUFLTSxLQUlwQixJQUFJNkIsRUFBWVQsU0FNVCxDQUNMLElBQUlsQixFQUFZLElBQUlSLEtBQUsyQyxFQUFZQyxHQU1qQ0UsRUFBUyxJQUFJOUMsS0FBSyxHQUd0QixPQUZBOEMsRUFBT0MsWUFBWXZDLEVBQVV3QyxpQkFBa0J4QyxFQUFVeUMsY0FBZXpDLEVBQVUwQyxjQUNsRkosRUFBT3BDLFNBQVNGLEVBQVUyQyxjQUFlM0MsRUFBVTRDLGdCQUFpQjVDLEVBQVU2QyxnQkFBaUI3QyxFQUFVOEMsc0JBQ2xHUixFQWJQLE9BRkFKLEVBQVNhLEVBQWNwQixFQUFZVCxVQUUvQk4sTUFBTXNCLEdBQ0QsSUFBSTFDLEtBQUtNLEtBZWIsSUFBSU4sS0FBSzJDLEVBQVlDLEVBQU9GLEdBR3JDLFNBQVNOLEVBQWdCb0IsR0FDdkIsSUFFSUMsRUFGQXRCLEVBQWMsR0FDZHVCLEVBQVFGLEVBQVdHLE1BQU1wQyxFQUFTQyxtQkFJdEMsR0FBSWtDLEVBQU1wRSxPQUFTLEVBQ2pCLE9BQU82QyxFQWdCVCxHQWJJLElBQUl5QixLQUFLRixFQUFNLEtBQ2pCdkIsRUFBWTFCLEtBQU8sS0FDbkJnRCxFQUFhQyxFQUFNLEtBRW5CdkIsRUFBWTFCLEtBQU9pRCxFQUFNLEdBQ3pCRCxFQUFhQyxFQUFNLEdBRWZuQyxFQUFTRSxrQkFBa0JtQyxLQUFLekIsRUFBWTFCLFFBQzlDMEIsRUFBWTFCLEtBQU8rQyxFQUFXRyxNQUFNcEMsRUFBU0UsbUJBQW1CLEdBQ2hFZ0MsRUFBYUQsRUFBV0ssT0FBTzFCLEVBQVkxQixLQUFLbkIsT0FBUWtFLEVBQVdsRSxVQUluRW1FLEVBQVksQ0FDZCxJQUFJSyxFQUFRdkMsRUFBU0csU0FBU3FDLEtBQUtOLEdBRS9CSyxHQUNGM0IsRUFBWVMsS0FBT2EsRUFBV08sUUFBUUYsRUFBTSxHQUFJLElBQ2hEM0IsRUFBWVQsU0FBV29DLEVBQU0sSUFFN0IzQixFQUFZUyxLQUFPYSxFQUl2QixPQUFPdEIsRUFHVCxTQUFTRyxFQUFVa0IsRUFBWXZCLEdBQzdCLElBQUlnQyxFQUFRLElBQUlDLE9BQU8sd0JBQTBCLEVBQUlqQyxHQUFvQix1QkFBeUIsRUFBSUEsR0FBb0IsUUFDdEhrQyxFQUFXWCxFQUFXWSxNQUFNSCxHQUVoQyxJQUFLRSxFQUFVLE1BQU8sQ0FDcEIxQixLQUFNLE1BRVIsSUFBSUEsRUFBTzBCLEVBQVMsSUFBTUUsU0FBU0YsRUFBUyxJQUN4Q0csRUFBVUgsRUFBUyxJQUFNRSxTQUFTRixFQUFTLElBQy9DLE1BQU8sQ0FDTDFCLEtBQWlCLE1BQVg2QixFQUFrQjdCLEVBQWlCLElBQVY2QixFQUMvQjlCLGVBQWdCZ0IsRUFBV2UsT0FBT0osRUFBUyxJQUFNQSxFQUFTLElBQUk3RSxTQUlsRSxTQUFTaUQsRUFBVWlCLEVBQVlmLEdBRTdCLEdBQWEsT0FBVEEsRUFBZSxPQUFPLEtBQzFCLElBQUkwQixFQUFXWCxFQUFXWSxNQUFNekMsR0FFaEMsSUFBS3dDLEVBQVUsT0FBTyxLQUN0QixJQUFJSyxJQUFlTCxFQUFTLEdBQ3hCTSxFQUFZQyxFQUFjUCxFQUFTLElBQ25DUSxFQUFRRCxFQUFjUCxFQUFTLElBQU0sRUFDckNTLEVBQU1GLEVBQWNQLEVBQVMsSUFDN0JVLEVBQU9ILEVBQWNQLEVBQVMsSUFDOUJXLEVBQVlKLEVBQWNQLEVBQVMsSUFBTSxFQUU3QyxHQUFJSyxFQUNGLE9BZ0ZKLFNBQTBCTyxFQUFPRixFQUFNRCxHQUNyQyxPQUFPQyxHQUFRLEdBQUtBLEdBQVEsSUFBTUQsR0FBTyxHQUFLQSxHQUFPLEVBakY5Q0ksQ0FBaUJ2QyxFQUFNb0MsRUFBTUMsR0F1RHRDLFNBQTBCRyxFQUFhSixFQUFNRCxHQUMzQyxJQUFJbkUsRUFBTyxJQUFJVCxLQUFLLEdBQ3BCUyxFQUFLeUUsZUFBZUQsRUFBYSxFQUFHLEdBQ3BDLElBQ0lFLEVBQW9CLEdBQVpOLEVBQU8sR0FBU0QsRUFBTSxHQURUbkUsRUFBSzJFLGFBQWUsR0FHN0MsT0FEQTNFLEVBQUs0RSxXQUFXNUUsRUFBS3lDLGFBQWVpQyxHQUM3QjFFLEVBekRFNkUsQ0FBaUI3QyxFQUFNb0MsRUFBTUMsR0FIM0IsSUFBSTlFLEtBQUtNLEtBS2xCLElBQUlHLEVBQU8sSUFBSVQsS0FBSyxHQUVwQixPQWdFSixTQUFzQnlDLEVBQU1rQyxFQUFPbEUsR0FDakMsT0FBT2tFLEdBQVMsR0FBS0EsR0FBUyxJQUFNbEUsR0FBUSxHQUFLQSxJQUFTOEUsRUFBYVosS0FBV2EsRUFBZ0IvQyxHQUFRLEdBQUssS0FqRXhHZ0QsQ0FBYWhELEVBQU1rQyxFQUFPQyxJQW9FbkMsU0FBK0JuQyxFQUFNZ0MsR0FDbkMsT0FBT0EsR0FBYSxHQUFLQSxJQUFjZSxFQUFnQi9DLEdBQVEsSUFBTSxLQXJFM0JpRCxDQUFzQmpELEVBQU1nQyxJQUlwRWhFLEVBQUt5RSxlQUFlekMsRUFBTWtDLEVBQU9qSCxLQUFLaUksSUFBSWxCLEVBQVdHLElBQzlDbkUsR0FKRSxJQUFJVCxLQUFLTSxLQVF0QixTQUFTb0UsRUFBY2tCLEdBQ3JCLE9BQU9BLEVBQVF2QixTQUFTdUIsR0FBUyxFQUduQyxTQUFTL0MsRUFBVVksR0FDakIsSUFBSVUsRUFBV1YsRUFBV1csTUFBTXhDLEdBQ2hDLElBQUt1QyxFQUFVLE9BQU8sS0FFdEIsSUFBSTBCLEVBQVFDLEVBQWMzQixFQUFTLElBQy9CNEIsRUFBVUQsRUFBYzNCLEVBQVMsSUFDakM2QixFQUFVRixFQUFjM0IsRUFBUyxJQUVyQyxPQXVERixTQUFzQjBCLEVBQU9FLEVBQVNDLEdBQ3BDLE9BQWMsS0FBVkgsRUFDaUIsSUFBWkUsR0FBNkIsSUFBWkMsRUFHbkJBLEdBQVcsR0FBS0EsRUFBVSxJQUFNRCxHQUFXLEdBQUtBLEVBQVUsSUFBTUYsR0FBUyxHQUFLQSxFQUFRLEdBNUR4RkksQ0FBYUosRUFBT0UsRUFBU0MsR0FJM0JILEVBQVF2RSxFQWxPWSxJQWtPV3lFLEVBQTZDLElBQVZDLEVBSGhFMUYsSUFNWCxTQUFTd0YsRUFBY0YsR0FDckIsT0FBT0EsR0FBU00sV0FBV04sRUFBTTVCLFFBQVEsSUFBSyxPQUFTLEVBR3pELFNBQVNULEVBQWM0QyxHQUNyQixHQUF1QixNQUFuQkEsRUFBd0IsT0FBTyxFQUNuQyxJQUFJaEMsRUFBV2dDLEVBQWUvQixNQUFNdkMsR0FDcEMsSUFBS3NDLEVBQVUsT0FBTyxFQUN0QixJQUFJaUMsRUFBdUIsTUFBaEJqQyxFQUFTLElBQWMsRUFBSSxFQUNsQzBCLEVBQVF4QixTQUFTRixFQUFTLElBQzFCNEIsRUFBVTVCLEVBQVMsSUFBTUUsU0FBU0YsRUFBUyxLQUFPLEVBRXRELE9BNENGLFNBQTBCa0MsRUFBUU4sR0FDaEMsT0FBT0EsR0FBVyxHQUFLQSxHQUFXLEdBN0M3Qk8sQ0FBaUJULEVBQU9FLEdBSXRCSyxHQUFRUCxFQUFRdkUsRUFyUEksSUFxUG1CeUUsR0FIckN6RixJQWlCWCxJQUFJaUYsRUFBZSxDQUFDLEdBQUksS0FBTSxHQUFJLEdBQUksR0FBSSxHQUFJLEdBQUksR0FBSSxHQUFJLEdBQUksR0FBSSxJQUVsRSxTQUFTQyxFQUFnQi9DLEdBQ3ZCLE9BQU9BLEVBQU8sS0FBUSxHQUFLQSxFQUFPLEdBQU0sR0FBS0EsRUFBTyxJQ3RPdkMsU0FBUzhELEVBQVkvRixFQUFXdUIsR0FDN0M1QyxFQUFhLEVBQUdPLFdBQ2hCLElBQUlzQyxFQUFVRCxHQUFnQixHQUMxQnlFLEVBQVN4RSxFQUFRd0UsT0FDakJDLEVBQXFCRCxHQUFVQSxFQUFPeEUsU0FBV3dFLEVBQU94RSxRQUFRMEUsYUFDaEVDLEVBQTRDLE1BQXRCRixFQUE2QixFQUFJekYsRUFBVXlGLEdBQ2pFQyxFQUF1QyxNQUF4QjFFLEVBQVEwRSxhQUF1QkMsRUFBc0IzRixFQUFVZ0IsRUFBUTBFLGNBRTFGLEtBQU1BLEdBQWdCLEdBQUtBLEdBQWdCLEdBQ3pDLE1BQU0sSUFBSXhFLFdBQVcsb0RBR3ZCLElBQUl6QixFQUFPakIsRUFBT2dCLEdBQ2RvRSxFQUFNbkUsRUFBS21HLFNBQ1h6QixHQUFRUCxFQUFNOEIsRUFBZSxFQUFJLEdBQUs5QixFQUFNOEIsRUFHaEQsT0FGQWpHLEVBQUtvRyxRQUFRcEcsRUFBS3FHLFVBQVkzQixHQUM5QjFFLEVBQUtDLFNBQVMsRUFBRyxFQUFHLEVBQUcsR0FDaEJELEVDZk0sU0FBU3NHLEVBQVduRyxFQUFlQyxFQUFnQmtCLEdBQ2hFNUMsRUFBYSxFQUFHTyxXQUNoQixJQUFJc0gsRUFBc0JULEVBQVkzRixFQUFlbUIsR0FDakRrRixFQUF1QlYsRUFBWTFGLEVBQWdCa0IsR0FDdkQsT0FBT2lGLEVBQW9CL0csWUFBY2dILEVBQXFCaEgsVUNyQ2hFLE1Bc01BLEVBdE1pQixNQUViLE1BQU1pSCxFQUFzQixLQUN4QixNQUFNL0osRUFBVyxnQkFDakJnSyxFQUFrQmhLLElBa0NoQmlLLEVBQVl4SSxJQUNkLEdDZk8sU0FBaUI0QixHQUU5QixPQURBckIsRUFBYSxFQUFHTyxXQUNUaUIsRUFBVUgsRUFBV1IsS0FBS3FILE9EYXZCQyxDQUFReEYsRUFBU2xELEVBQUsySSxVQUFXLE9BQU8zSSxHQTRCMUM0SSxFQUFlNUksSUFDakIsR0VsQ08sU0FBb0I0QixFQUFXd0IsR0FFNUMsT0FEQTdDLEVBQWEsRUFBR08sV0FDVHFILEVBQVd2RyxFQUFXUixLQUFLcUgsTUFBT3JGLEdGZ0MvQnlGLENBQVczRixFQUFTbEQsRUFBSzJJLFVBQVcsT0FBTzNJLEdBRzdDOEksRUFBbUJ2SyxJQUNyQndLLElBQ0EsTUFBTUMsRUFBVUMsU0FBU0MsY0FBYyxZQUV2QzNLLEVBQVM0SyxTQUFRekssSUFDYjBLLEVBQW9CMUssRUFBUUMsSUFFNUIsTUFBTTBLLEVBQWUzSyxFQUFRRyxNQUN2QnlLLEVBQW1CTixFQUFRRSxjQUFjLHFCQUFxQnhLLEVBQVFDLFFBQ3RFNEssRUFBWUQsRUFBaUJKLGNBQWMsTUFDM0NNLEVBQWFGLEVBQWlCSixjQUFjLGFBRWxERyxFQUFhRixTQUFRbkosSUFDakIsTUFBTXlKLEVBQVlDLEVBQVMxSixHQUMzQnVKLEVBQVVJLGFBQWFGLEVBQVdELEVBQVdJLHNCQUtuRGIsRUFBdUIsS0FDTEUsU0FBU0MsY0FBYyxpQkFDZFcsaUJBQWlCLFlBQ3JDVixTQUFRekssR0FBV0EsRUFBUW9MLFlBcUd4QyxNQUFPLENBQUVDLGdCQWxHZ0IxSyxJQUNyQixNQUFNZCxFQUFXLGdCQUNqQnVLLEVBQWdCdkssR0FDaEIsTUFBTXlMLEVBQWdCekwsRUFBU0UsTUFBS0MsR0FBV0EsRUFBUUMsSUFBTVUsSUFFdkQ0SyxFQURVaEIsU0FBU0MsY0FBYyxZQUNQQSxjQUFjLHFCQUFxQmMsRUFBY3JMLFFBQ3ZEc0ssU0FBU1ksaUJBQWlCLFlBRWxDVixTQUFRekssSUFDbEJBLEVBQVF3TCxRQUFRN0ssV0FBYUEsR0FDN0JYLEVBQVFvTCxZQUdoQkssRUFBZ0JGLElBcUZNRyxhQWxGSnhMLElBRWxCLE1BQU15TCxFQUFjLENBQ2hCekwsWUFBYUEsRUFDYkMsTUFBTyxJQUVYLGNBQTBCd0wsR0FFMUIvQixJQUM2QlcsU0FBU0MsY0FBYyxxQkFBcUJtQixFQUFXMUwsU0F5RWhEMkwsa0JBdERkLENBQUNqTCxFQUFXVCxFQUFhQyxFQUFRLFdBQXVCUSxNQUM5RSxjQUEwQixDQUN0QlYsR0FBSVUsRUFDSlQsWUFBYUEsRUFDYkMsTUFBT0EsSUFHWHlKLEtBK0N1RGlDLFVBdEV6QyxDQUFDdkssRUFBTXJCLEtBQ3JCLE1BQU02TCxFQUFVLENBQ1pDLEtBQU16SyxFQUNOTixPQUFRWixLQUFLQyxNQUFzQixJQUFoQkQsS0FBS0UsVUFDeEIwTCxTQUFVLE1BQ1YvQixRQUFTLEtBQ1RnQyxZQUFZLEdBR1Z4SyxFQURXLGdCQUNnQjFCLE1BQUtDLEdBQVdBLEVBQVFDLElBQU1BLElBSS9ELE9BSEF3QixFQUFnQnRCLE1BQU1JLEtBQUt1TCxHQUMzQixjQUEwQnJLLEdBRW5CcUssR0F5RDJESSxlQTVDL0MsQ0FBQ3ZMLEVBQVdLLEVBQVFtTCxLQUN2QyxNQUFNQyxFQUFlLG1CQUErQnpMLEVBQVdLLEdBQy9ELGFBQXlCTCxFQUFXLENBQzVCb0wsS0FBTUksRUFDTm5MLE9BQVFvTCxFQUFhcEwsT0FDckJnTCxTQUFVSSxFQUFhSixTQUN2Qi9CLFFBQVNtQyxFQUFhbkMsUUFDdEJnQyxXQUFZRyxFQUFhSCxjQXFDaURJLG1CQWpDM0QsQ0FBQzFMLEVBQVdLLEVBQVFzTCxLQUMzQyxNQUFNRixFQUFlLG1CQUErQnpMLEVBQVdLLEdBQy9ELGFBQXlCTCxFQUFXLENBQzVCb0wsS0FBTUssRUFBYUwsS0FDbkIvSyxPQUFRb0wsRUFBYXBMLE9BQ3JCZ0wsU0FBVU0sRUFDVnJDLFFBQVNtQyxFQUFhbkMsUUFDdEJnQyxXQUFZRyxFQUFhSCxjQTBCcUVNLGtCQXRCaEYsQ0FBQzVMLEVBQVdLLEVBQVF3TCxLQUMxQyxNQUFNSixFQUFlLG1CQUErQnpMLEVBQVdLLEdBQy9ELGFBQXlCTCxFQUFXLENBQzVCb0wsS0FBTUssRUFBYUwsS0FDbkIvSyxPQUFRb0wsRUFBYXBMLE9BQ3JCZ0wsU0FBVUksRUFBYUosU0FDdkIvQixRQUFTdUMsRUFDVFAsV0FBWUcsRUFBYUgsY0Fld0ZRLG1CQVhsRyxDQUFDOUwsRUFBV0ssRUFBUWlMLEtBQzNDLE1BQU1HLEVBQWUsbUJBQStCekwsRUFBV0ssR0FDL0QsYUFBeUJMLEVBQVcsQ0FDNUJvTCxLQUFNSyxFQUFhTCxLQUNuQi9LLE9BQVFvTCxFQUFhcEwsT0FDckJnTCxTQUFVSSxFQUFhSixTQUN2Qi9CLFFBQVNtQyxFQUFhbkMsUUFDdEJnQyxXQUFZQSxLQUl5SFMsZ0JBM0x6SCxDQUFDN00sRUFBVThNLEtBQy9CdkMsRUFBZ0J2SyxHQUNoQjRMLEVBQWdCa0IsSUF5TDhJQyxpQkF0THpJLENBQUMvTSxFQUFVOE0sS0FDaEN2QyxFQUFnQnZLLEdBRWhCQSxFQUFTNEssU0FBUXpLLElBQ2IsTUFBTUcsRUFBUUgsRUFBUUcsTUFLSyxJQUhQQSxFQUFNVyxRQUFPUSxHQUFRd0ksRUFBU3hJLEtBR2xDVSxRQUNJdUksU0FBU0MsY0FBYyxZQUNOQSxjQUFjLHFCQUFxQnhLLEVBQVFDLFFBQzNEbUwsU0FJRGpMLEVBQU1XLFFBQU9RLElBQVN3SSxFQUFTeEksS0FFdkNtSixTQUFRbkosSUFDaEIsTUFBTXVMLEVBQWdCdEMsU0FBU0MsY0FBYyxrQkFBa0JsSixFQUFLTixZQUNoRTZMLEdBQWVBLEVBQWN6QixlQUd6Q0ssRUFBZ0JrQixJQStKZ0tHLG9CQXhKeEosQ0FBQ2pOLEVBQVU4TSxLQUNuQ3ZDLEVBQWdCdkssR0FFaEJBLEVBQVM0SyxTQUFRekssSUFDYixNQUFNRyxFQUFRSCxFQUFRRyxNQUlRLElBSFBBLEVBQU1XLFFBQU9RLEdBQVE0SSxFQUFZNUksS0FHckNVLFFBQ0N1SSxTQUFTQyxjQUFjLFlBQ05BLGNBQWMscUJBQXFCeEssRUFBUUMsUUFDM0RtTCxTQUlFakwsRUFBTVcsUUFBT1EsSUFBUzRJLEVBQVk1SSxLQUUxQ21KLFNBQVFuSixJQUNuQixNQUFNdUwsRUFBZ0J0QyxTQUFTQyxjQUFjLGtCQUFrQmxKLEVBQUtOLFlBQ2hFNkwsR0FBZUEsRUFBY3pCLGVBR3pDSyxFQUFnQmtCLE1Bc0l4QixHR3RNTUksRUFBaUIsS0EyQ1osQ0FBQ0Msa0JBekNtQkMsSUFDdkIsTUFBTUMsRUFBSzNDLFNBQVM0QyxjQUFjLE1BRWxDLE9BREFELEVBQUdFLGFBQWEsUUFBU0gsR0FDbEJDLEdBc0NnQkcsa0JBbkNBSixJQUN2QixNQUFNSyxFQUFPL0MsU0FBUzRDLGNBQWMsUUFFcEMsT0FEQUcsRUFBS0MsVUFBVUMsSUFBSVAsR0FDWkssR0FnQ21DRyxtQkE3Qm5CLENBQUNDLEVBQUtULEtBQzdCLE1BQU1VLEVBQU1wRCxTQUFTNEMsY0FBYyxPQUluQyxPQUhBUSxFQUFJSixVQUFVQyxJQUFJUCxHQUNsQlUsRUFBSVAsYUFBYSxNQUFPTSxHQUN4QkMsRUFBSVAsYUFBYSxZQUFhLFNBQ3ZCTyxHQXdCdURDLGlCQWhCeENDLElBQ3RCLE1BQU1DLEVBQVl2RCxTQUFTNEMsY0FBYyxTQU16QyxPQUxBVyxFQUFVVixhQUFhLE9BQVEsUUFDL0JVLEVBQVVWLGFBQWEsY0FBZVMsR0FDdENDLEVBQVVWLGFBQWEsS0FBTSxjQUM3QlUsRUFBVWhNLFVBQVcsRUFFZGdNLEdBU3lFQyxXQXJCakUsSUFDR3hELFNBQVM0QyxjQUFjLFFBb0JtRGEsVUFON0VmLElBQ2YsTUFBTWdCLEVBQU0xRCxTQUFTNEMsY0FBYyxPQUVuQyxPQURBYyxFQUFJYixhQUFhLFFBQVNILEdBQ25CZ0IsS0FNVEMsRUFBaUIsS0FDbkIsTUFBTUMsRUFBT3BCLElBRVBxQixFQUFXRCxFQUFLZCxrQkFBa0IsU0FDbENnQixFQUFXRixFQUFLVixtQkFBbUIsdUJBQXdCLGFBQzNEYSxFQUFhSCxFQUFLVixtQkFBbUIseUJBQTBCLGVBT3JFLE9BTEFZLEVBQVNkLFVBQVVDLElBQUksZ0JBQ3ZCYyxFQUFXZixVQUFVQyxJQUFJLGtCQUV6QlksRUFBU0csT0FBT0YsRUFBVUMsR0FFbkJGLEdBc0JMMUQsRUFBdUIvSixJQUN6QixNQUFNd04sRUFBT3BCLElBSVA3TSxFQUZXLGdCQUNhSCxNQUFLQyxHQUFXQSxFQUFRQyxJQUFNVSxJQUMzQlQsWUFFM0JvSyxFQUFVQyxTQUFTQyxjQUFjLGlCQUNqQ2dFLEVBQWFMLEVBQUtILFVBQVUsV0FDbENRLEVBQVdwQixhQUFhLGtCQUFtQnpNLEdBQzNDLE1BQU04TixFQUFXTixFQUFLSCxVQUFVLGFBRTFCVSxFQUFpQlAsRUFBS0gsVUFBVSxtQkFDaENXLEVBQUtwRSxTQUFTNEMsY0FBYyxNQUNsQ3dCLEVBQUd2QixhQUFhLFFBQVMsZ0JBQ3pCdUIsRUFBR0MsWUFBYzFPLEVBQ2pCLE1BQU0yTyxFQUFLdEUsU0FBUzRDLGNBQWMsTUFDbEMwQixFQUFHekIsYUFBYSxRQUFTLGdCQUN6QnlCLEVBQUdELFlBQWMsV0FFakIsTUFBTUUsRUFBaUJ2RSxTQUFTNEMsY0FBYyxNQUM5QzJCLEVBQWV2QixVQUFVQyxJQUFJLGVBQWdCLFNBRTdDLE1BQU11QixFQUFxQlosRUFBS25CLGtCQUFrQixRQUM1Q2dDLEVBQWNiLEVBQUtkLGtCQUFrQixZQUNyQzRCLEVBQVVkLEVBQUtWLG1CQUFtQixzQkFBdUIsWUFDL0R1QixFQUFZVCxPQUFPVSxFQUFTLFlBRTVCRixFQUFtQlIsT0FBT1MsR0FDMUJGLEVBQWVQLE9BQU9RLEVBQW9CTixHQUMxQ0MsRUFBZUgsT0FBT0ksRUFBSUUsR0FDMUJMLEVBQVdELE9BQU9HLEVBQWdCSSxHQUNsQ3hFLEVBQVFpRSxPQUFPQyxJQUdiVSxFQUFrQixLQUNwQixNQUFNQyxFQUFjcEMsSUFBaUJNLGtCQUFrQixZQUVqRCtCLEVBQWVyQyxJQUFpQlUsbUJBQW1CLDJCQUE0QixpQkFDckYyQixFQUFhN0IsVUFBVUMsSUFBSSxnQkFFM0IsTUFBTTZCLEVBQVk5RSxTQUFTNEMsY0FBYyxTQUN6Q2tDLEVBQVU5QixVQUFVQyxJQUFJLGNBRXhCLE1BQU04QixFQUFZL0UsU0FBUzRDLGNBQWMsU0FDekNtQyxFQUFVbEMsYUFBYSxPQUFRLFFBQy9Ca0MsRUFBVXhOLFVBQVcsRUFFckIsTUFBTXlOLEVBQWV4QyxJQUFpQlUsbUJBQW1CLDJCQUE0QixpQkFjckYsT0FaQTRCLEVBQVVkLE9BQU9lLEVBQVdDLEdBQzVCSixFQUFZWixPQUFPYSxFQUFjQyxHQUdqQ0MsRUFBVUUsaUJBQWlCLFVBQVUsS0FDakMsTUFBTTdPLEVBQVkyTyxFQUFVRyxRQUFRLFlBQVlqRSxRQUFRN0ssVUFDbERLLEVBQVNzTyxFQUFVRyxRQUFRLGtCQUFrQmpFLFFBQVF4SyxPQUNyRHdMLEVBQWE4QyxFQUFVaEgsTUFFN0IsT0FBTyxvQkFBMkIzSCxFQUFXSyxFQUFRd0wsTUFHbEQyQyxHQUlMTyxFQUF5QixDQUFDelAsRUFBSTBQLEtBQ2hDLE1BQU14QixFQUFPcEIsSUFFUDZDLEVBQWN6QixFQUFLbkIsa0JBQWtCLGdCQUMzQzRDLEVBQVl4QyxhQUFhLGtCQUFtQm5OLEdBQzVDLE1BQU1DLEVBQWNpTyxFQUFLZCxrQkFBa0IsZ0JBQzNDbk4sRUFBWTBPLFlBQWNlLEVBQzFCLE1BQU12QixFQUFXRixJQUlqQixPQUZBMEIsRUFBWXJCLE9BQU9yTyxFQUFha08sR0FFekJ3QixHQUdML0YsRUFBcUJoSyxJQUN2QixNQUFNZ1EsRUFBd0J0RixTQUFTQyxjQUFjLGlCQUMvQ3NGLEVBQWdCdkYsU0FBU0MsY0FBYyxzQkFHdkIsR0FBR3ZELE1BQU14RSxLQUFLb04sRUFBc0JFLFVBQzVDdEYsU0FBUXNCLElBQ2RBLEVBQUt3QixVQUFVeUMsU0FBUyxpQkFBaUJqRSxFQUFLWCxZQUd0RCxJQUFLLE1BQU1wTCxLQUFXSCxFQUFVLENBQzVCLE1BQU1vUSxFQUFPUCxFQUF1QjFQLEVBQVFDLEdBQUlELEVBQVFFLGFBQ3hEMlAsRUFBc0I1RSxhQUFhZ0YsRUFBTUgsR0FJN0NELEVBQXNCMUUsaUJBQWlCLGlCQUFpQlYsU0FBUW1GLElBQzVEQSxFQUFZSixpQkFBaUIsU0FBVVUsSUFDbkMsTUFBTXBDLEVBQVl2RCxTQUFTQyxjQUFjLGVBQ2YsUUFBdEIwRixFQUFFQyxPQUFPQyxVQUFzQnRDLEdBQ25DLGtCQUF5QjhCLEVBQVlwRSxRQUFRN0ssa0JBS25EcUssRUFBYTdKLElBQ2YsTUFBTWdOLEVBQU9wQixJQUVQekwsRUFBTzZNLEVBQUtuQixrQkFBa0IsUUFDcEMxTCxFQUFLOEwsYUFBYSxlQUFnQmpNLEVBQVFILFFBRTFDLE1BQU1xUCxFQUFXbEMsRUFBS2Qsa0JBQWtCLGFBRWxDaUQsRUFBZW5DLEVBQUtkLGtCQUFrQixhQUM1Q2lELEVBQWExQixZQUFjek4sRUFBUTRLLEtBRW5DLE1BQU1xQyxFQUFXRixJQUNqQm1DLEVBQVM5QixPQUFPK0IsRUFBY2xDLEdBRTlCLE1BQU1lLEVBQWNELElBWXBCLE9BVnFCQyxFQUFZM0UsY0FBYyxrQkFDbEMrQyxVQUFVQyxJQUFJLFlBQVlyTSxFQUFRNkssWUFFN0JtRCxFQUFZM0UsY0FBYyxTQUNsQ2xDLE1BQVFuSCxFQUFROEksUUFFdEI5SSxFQUFROEssWUFBWTNLLEVBQUtpTSxVQUFVQyxJQUFJLGFBRTNDbE0sRUFBS2lOLE9BQU84QixFQUFVbEIsR0FFZjdOLEdBR0xtSyxFQUFtQmtCLElBSXJCLE1BQU00RCxFQUFtQmhHLFNBQVNDLGNBQWMsV0FDNUMrRixHQUFrQkEsRUFBaUJoRCxVQUFVbkMsT0FBTyxVQUN4RHVCLEVBQUlZLFVBQVVDLElBQUksVUFDTWIsRUFBSW9ELFNBQVNoRSxLQUFLLElDN054Q3lFLEVBQWdCLElBRUQsTUFEQ2pHLFNBQVNDLGNBQWMsZUFNdkNpRyxFQUFrQixLQUVwQixNQUFNM0MsRUFBWXZELFNBQVNDLGNBQWMsZUFFbkNvRixFQURZOUIsRUFBVTVDLGNBQ0VBLGNBQ3hCd0YsRUFBYzNELElBQWlCTSxrQkFBa0IsZ0JBRWpEbk4sRUFBYzROLEVBQVV4RixNQUFNcUksT0FDL0J6USxJQUVMd1EsRUFBWTlCLFlBQWMxTyxFQUMxQjROLEVBQVU1QyxjQUFjRSxTQUN4QndFLEVBQVkzRSxhQUFheUYsRUFBYWQsRUFBWWdCLFdBQVcsTUFHM0RDLEVBQWEsS0FDZixHQUFJTCxJQUFpQixPRHNDRyxNQUN4QixNQUFNckMsRUFBT3BCLElBQ1ArRCxFQUFvQnZHLFNBQVNDLGNBQWMsaUJBRTNDdUcsRUFBc0I1QyxFQUFLbkIsa0JBQWtCLGdCQUU3Q2dFLEVBQW1CN0MsRUFBS0osYUFDeEJrRCxFQUFtQjlDLEVBQUtQLGlCQUFpQixtQkFDL0NvRCxFQUFpQnpDLE9BQU8wQyxHQUV4QixNQUFNN0MsRUFBV0YsSUFDakI2QyxFQUFtQnhDLE9BQU95QyxFQUFrQjVDLEdBQzVDMEMsRUFBa0I3RixhQUFhOEYsRUFBb0JELEVBQWtCSSxrQkFFckVDLFlBQVcsS0FDUEYsRUFBaUJHLFVBQ2xCLElDckRIQyxHQUVBLE1BQU12RCxFQUFZdkQsU0FBU0MsY0FBYyxlQUNuQzhHLEVBQVl4RCxFQUFVNUMsY0FDdEIwRSxFQUFjMEIsRUFBVXBHLGNBRTlCNEMsRUFBVTBCLGlCQUFpQixRQUFRLFdBQy9CLEdBQThCLElBQTFCMUIsRUFBVXhGLE1BQU1xSSxPQUVoQixZQURBZixFQUFZeEUsU0FHaEJxRixJQUVBLE1BQU12USxFQUFjMFAsRUFBWTJCLGtCQUFrQjNDLFlBQ2xELGVBQXNCMU8sR0FFdEIsTUFBTXNSLEVBQWNqSCxTQUFTQyxjQUFjLGlCQUVyQzdKLEVBQVk2USxFQUFZekIsU0FBU3lCLEVBQVlDLGtCQUFvQixHQUFHQyxhQUFhLG1CQUNsRmxCLEtBQWlCOUYsRUFBb0IvSixNQUc5QzJRLEVBQVU5QixpQkFBaUIsVUFBVSxTQUFVVSxHQUMzQ0EsRUFBRXlCLGlCQUNGbEIsSUFDQSxNQUFNdlEsRUFBYzBQLEVBQVkyQixrQkFBa0IzQyxZQUNsRCxlQUFzQjFPLEdBQ3RCLE1BQU1zUixFQUFjakgsU0FBU0MsY0FBYyxpQkFDckM3SixFQUFZNlEsRUFBWXpCLFNBQVN5QixFQUFZQyxrQkFBb0IsR0FBR0MsYUFBYSxtQkFDbEZsQixLQUFpQjlGLEVBQW9CL0osT0NxQjVDaVIsRUFBVSxLQUNaLE1BQU1DLEVBQWF0SCxTQUFTQyxjQUFjLGVBQ3BDOEcsRUFBWU8sRUFBVzNHLGNBQ3ZCMkIsRUFBZ0J5RSxFQUFVcEcsY0FBY0EsY0FFOUMyRyxFQUFXckMsaUJBQWlCLFFBQVEsV0FDaEMsTUFBTTdPLEVBQVlrTSxFQUFjNEMsUUFBUSxxQkFBcUJqRSxRQUFRN0ssVUFDL0RXLEVBQU91USxFQUFXdkosTUFDeEJ3SixJQUNJeFEsR0FBTXlRLEVBQVd6USxFQUFNWCxFQUFXa00sTUFHMUN5RSxFQUFVOUIsaUJBQWlCLFVBQVUsU0FBVVUsR0FDM0NBLEVBQUV5QixpQkFDRixNQUFNaFIsRUFBWWtNLEVBQWM0QyxRQUFRLHFCQUFxQmpFLFFBQVE3SyxVQUMvRFcsRUFBT3VRLEVBQVd2SixNQUN4QndKLElBQ0l4USxHQUFNeVEsRUFBV3pRLEVBQU1YLEVBQVdrTSxPQUl4Q2tGLEVBQWEsQ0FBQ3pRLEVBQU1YLEVBQVdrTSxLQUNqQyxHQUFJQSxFQUFjckIsUUFBUXhLLE9BQ3RCLE9BQU8saUJBQXdCTCxFQUFXa00sRUFBY3JCLFFBQVF4SyxPQUFRTSxHQUU1RSxNQUFNSCxFQUFVLFlBQW1CRyxFQUFNWCxHQUN6Q2tNLEVBQWNPLGFBQWEsZUFBZ0JqTSxFQUFRSCxTQUdqRDhRLEVBQW9CLEtBQ3RCLE1BQU1ELEVBQWF0SCxTQUFTQyxjQUFjLGVBQ3BDOEcsRUFBWU8sRUFBVzNHLGNBQ3ZCbUYsRUFBV2lCLEVBQVVwRyxjQUNyQjJCLEVBQWdCd0QsRUFBU25GLGNBRXpCNEMsRUFBWStELEVBQVd2SixNQUFNcUksT0FDN0JxQixFQUFlakYsSUFBaUJNLGtCQUFrQixhQUN4RDJFLEVBQWF6RCxPQUFPVCxHQUdILElBQWJBLEdBQW9CakIsRUFBY3JCLFFBQVF4SyxPQUl4QixJQUFiOE0sR0FBbUJqQixFQUFjckIsUUFBUXhLLFNBQ2xEc1EsRUFBVWxHLFNBQ1ZpRixFQUFTNEIsUUFBUUQsR0FFakJFLEVBQW9CRixFQUFjbkYsSUFQOUJBLEVBQWN6QixVQVVoQjhHLEVBQXNCLENBQUNGLEVBQWNuRixLQUN2QyxNQUNNc0YsRUFBMkIsR0FEWi9SLEtBQUtnUyxNQUFNdkYsRUFBY3dGLGFBQWUsSUFFN0RMLEVBQWFNLE1BQU1DLE9BQVMsR0FBR0osTUFDL0J0RixFQUFjeUYsTUFBTUMsT0FBUyxHQUFHSixPQzlIcENLLE9BQU9DLE9BQVMsS0FDWixNQUFNNVMsRUFBVyxnQkFDWDhNLEVBQU1wQyxTQUFTQyxjQUFjLHFCQUs3QmtJLEVBQVcsSUFBSUMsa0JBQWlCQyxJQUNsQ0EsRUFBUW5JLFNBQVFvSSxJQUNaLEdBQUlBLEVBQU1DLFdBQVc5USxPQUFRLENBQ3pCLE1BQU0rUSxFQUFpQnhJLFNBQVNZLGlCQUFpQixTQUNqRHZJLFFBQVFvUSxJQUFJRCxHQUNaQSxFQUFldEksU0FBUXdJLElBQ25CLEdBQUlBLEVBQVV6SSxjQUFjLGFBQWMsQ0FDdEMsTUFBTXdILEVBQWVpQixFQUFVekksY0FBYyxhQUM3QzBILEVBQW9CZSxFQUFXakIsT0FDNUIsQ0FDSCxNQUFNQSxFQUFlaUIsRUFBVXpJLGNBQWMsY0FDN0MwSCxFQUFvQmUsRUFBV2pCLGNBTTdDa0IsRUFBYzNJLFNBQVNDLGNBQWMsaUJBRzNDa0ksRUFBU1MsUUFBUUQsRUFGTSxDQUFFRSxXQUFXLElBTXBDdkosRUFBa0JoSyxHQUNsQixrQkFBeUJBLEVBQVU4TSxJQUliLE1BRXRCLE1BQU0wRyxFQUFrQjlJLFNBQVMrSSxlQUFlLG9CQUM1Q2QsT0FBT2UsWUFBYyxNQUFRRixFQUFnQjlGLFVBQVV5QyxTQUFTLFdBQ2hFcUQsRUFBZ0I5RixVQUFVaUcsT0FBTyxVQUdyQyxNQUFNQyxFQUFVbEosU0FBUytJLGVBQWUsV0FFbENJLEVBQWdCLEtBQ2xCRCxFQUFRbEcsVUFBVWlHLE9BQU8sa0JBQ3JCaEIsT0FBT2UsWUFBYyxNQUFNRixFQUFnQjlGLFVBQVVpRyxPQUFPLFdBR2xEakosU0FBU1ksaUJBQWlCLGNBQ2xDVixTQUFRa0osSUFDZEEsRUFBT25FLGlCQUFpQixRQUFTa0UsTUFHckMsTUFBTUUsRUFBVUgsRUFBUWpKLGNBQWMscUJBQ2hDcUosRUFBV0osRUFBUWpKLGNBQWMsc0JBQ2pDc0osRUFBY0wsRUFBUWpKLGNBQWMsMEJBRzFDb0osRUFBUXBFLGlCQUFpQixTQUFTLEtBQzlCLE1BQU0zUCxFQUFXLGdCQUNqQixrQkFBeUJBLEVBQVUrVCxNQUd2Q0MsRUFBU3JFLGlCQUFpQixTQUFTLEtBQy9CLE1BQU0zUCxFQUFXLGdCQUNqQixtQkFBMEJBLEVBQVVnVSxNQUd4Q0MsRUFBWXRFLGlCQUFpQixTQUFTLEtBQ2xDLE1BQU0zUCxFQUFXLGdCQUNqQixzQkFBNkJBLEVBQVVpVSxPQXBDckIsR0ZtQkZ2SixTQUFTQyxjQUFjLGlCQUMvQmdGLGlCQUFpQixTQUFVVSxJQUNuQyxHQUFJQSxFQUFFQyxPQUFPVixRQUFRLG1CQUFvQixDQUVyQyxJQURpQnNFLFFBQVEsaUdBQ1YsT0FDZixNQUFNcFQsRUFBWXVQLEVBQUVDLE9BQU9WLFFBQVEscUJBQXFCakUsUUFBUTdLLFVBQ3hDNEosU0FBU1ksaUJBQWlCLHFCQUFxQnhLLE9BQ3ZEOEosU0FBUXVKLEdBQVdBLEVBQVE1SSxXQUMzQyxnQkFBNEJ6SyxPRWdCZDRKLFNBQVNDLGNBQWMsc0JBQy9CZ0YsaUJBQWlCLFFBQVNxQixHQUNwQnRHLFNBQVNDLGNBQWMsaUJBRS9CZ0YsaUJBQWlCLFNBQVVVLElBQy9CQSxFQUFFQyxPQUFPNUMsVUFBVXlDLFNBQVMsaUJGaEJwQixDQUFDRSxJQUNqQixHQUFJTSxJQUFpQixPQUdyQixNQUFNYyxFQUFZdkUsSUFBaUJnQixhQUM3QjhELEVBQWE5RSxJQUFpQmEsaUJBQWlCLG1CQUMvQzFOLEVBQWNnUSxFQUFFQyxPQUFPakYsY0FBYytJLHVCQUUzQ3BDLEVBQVd2SixNQUFRcEksRUFBWTBPLFlBQy9CMU8sRUFBWWtMLFNBQ1prRyxFQUFVL0MsT0FBT3NELEdBRWpCLE1BQU1qQyxFQUFjTSxFQUFFQyxPQUFPVixRQUFRLGlCQUNyQ0csRUFBWTNFLGFBQWFxRyxFQUFXMUIsRUFBWWdCLFdBQVcsSUFFM0QsTUFBTTlDLEVBQVl2RCxTQUFTQyxjQUFjLGVBQ3pDc0QsRUFBVXNELFFBRVYsTUFBTXpRLEVBQVlpUCxFQUFZcEUsUUFBUTdLLFVBRXRDbU4sRUFBVTBCLGlCQUFpQixRQUFRLFdBQ1IsSUFBbkIxQixFQUFVeEYsT0FBYW1JLElBQzNCLE1BQU12USxFQUFjMFAsRUFBWTJCLGtCQUFrQjNDLFlBQ2xEc0YsRUFBb0J2VCxFQUFXVCxHQUMvQixvQkFBMkJTLEVBQVdULE1BRzFDb1IsRUFBVTlCLGlCQUFpQixVQUFVLFNBQVVVLEdBQzNDQSxFQUFFeUIsaUJBQ0ZsQixJQUNBLE1BQU12USxFQUFjMFAsRUFBWTJCLGtCQUFrQjNDLFlBQ2xEc0YsRUFBb0J2VCxFQUFXVCxHQUMvQixvQkFBMkJTLEVBQVdULE1BRzFDLE1BQU1nVSxFQUFzQixDQUFDdlQsRUFBV1QsS0FDcEMsTUFDTWlVLEVBRFU1SixTQUFTQyxjQUFjLFlBQ0RBLGNBQWMscUJBQXFCN0osT0FDckV3VCxJQUNBQSxFQUFzQnZELFdBQVcsR0FBR0EsV0FBVyxHQUFHaEMsWUFBYzFPLEtFdEJoRWtVLENBQVlsRSxNQU1KM0YsU0FBU0MsY0FBYyxZQUMvQmdGLGlCQUFpQixTQUFVVSxJRDNCcEIsSUFBQ3ZQLEVBQVdLLEVDNEJuQmtQLEVBQUVDLE9BQU81QyxVQUFVeUMsU0FBUyxhRC9GckIsQ0FBQ3FFLElBQ2hCQSxFQUFZOUcsVUFBVWlHLE9BQU8sYUFDN0IsSUFBSXZILEdBQWEsRUFFYm9JLEVBQVk5RyxVQUFVeUMsU0FBUyxlQUMvQi9ELEdBQWEsR0FFakIsTUFBTXRMLEVBQVkwVCxFQUFZNUUsUUFBUSxZQUFZakUsUUFBUTdLLFVBQ3BESyxFQUFTcVQsRUFBWTdJLFFBQVF4SyxPQUU1QixxQkFBNEJMLEVBQVdLLEVBQVFpTCxJQ3VGOUNxSSxDQURvQnBFLEVBQUVDLE9BQU9WLFFBQVEsVUFHaENTLEVBQUVDLE9BQU81QyxVQUFVeUMsU0FBUyxhRHRGeEIsQ0FBQ2xGLElBQ2xCLEdBQUlQLFNBQVMrSSxlQUFlLGNBQWUsT0FDM0MsTUFBTWlCLEVBQWtCeEgsSUFBaUJDLGtCQUFrQixRQUNyRHdILEVBQVd6SCxJQUFpQk0sa0JBQWtCLGFBQzlDaUUsRUFBWXZFLElBQWlCZ0IsYUFDN0I4RCxFQUFhOUUsSUFBaUJhLGlCQUFpQixpQkFFckQwRCxFQUFVL0MsT0FBT3NELEdBQ2pCMkMsRUFBU2pHLE9BQU8rQyxHQUVoQixNQUFNbEQsRUFBV3JCLElBQWlCTSxrQkFBa0IsU0FDOUNnQixFQUFXdEIsSUFBaUJVLG1CQUFtQix1QkFBd0IsYUFDdkVhLEVBQWF2QixJQUFpQlUsbUJBQW1CLHlCQUEwQixlQUVqRlcsRUFBU0csT0FBT0YsRUFBVUMsR0FDMUJrRyxFQUFTakcsT0FBT0gsR0FDaEIsTUFBTW5FLEVBQVVpRixJQUNoQnFGLEVBQWdCaEcsT0FBT2lHLEVBQVV2SyxHQUVqQyxNQUFNZ0osRUFBWW5JLEVBQVcyRSxRQUFRLFVBQy9CZ0YsRUFBZ0J4QixFQUFVeEIsa0JBQW9CLEVBRXBEd0IsRUFBVWhJLGFBQWFzSixFQUFpQnRCLEVBQVVsRCxTQUFTMEUsSUFHM0R0RCxZQUFXLEtBQ1BVLEVBQVdULFVBQ1osSUM0REtzRCxDQUFheEUsRUFBRUMsUUFDZnlCLEtBRUsxQixFQUFFQyxPQUFPNUMsVUFBVXlDLFNBQVMsaUJENEJ0QixDQUFDMkUsSUFFcEIsR0FEMEJBLEVBQVl6SixjQUFjQSxjQUFjcUMsVUFDNUN5QyxTQUFTLGFBQWMsT0FDN0MsTUFBTXJQLEVBQVlnVSxFQUFZbEYsUUFBUSxZQUFZakUsUUFBUTdLLFVBQ3BESyxFQUFTMlQsRUFBWWxGLFFBQVEsa0JBQWtCakUsUUFBUXhLLE9BRXZENFQsRUFBb0JELEVBQVlwSCxVQUVsQ3FILEVBQWtCNUUsU0FBUyxpQkFDM0I0RSxFQUFrQnhKLE9BQU8sZ0JBQ3pCd0osRUFBa0JwSCxJQUFJLG1CQUNmLHFCQUE0QjdNLEVBQVdLLEVBQVEsV0FFdEQ0VCxFQUFrQjVFLFNBQVMsb0JBQzNCNEUsRUFBa0J4SixPQUFPLG1CQUN6QndKLEVBQWtCcEgsSUFBSSxpQkFDZixxQkFBNEI3TSxFQUFXSyxFQUFRLFNBRXRENFQsRUFBa0I1RSxTQUFTLG1CQUMzQjRFLEVBQWtCeEosT0FBTyxpQkFDekJ3SixFQUFrQnBILElBQUksZ0JBQ2YscUJBQTRCN00sRUFBV0ssRUFBUSxTQ2hEbEQ2VCxDQUFlM0UsRUFBRUMsUUFFYkQsRUFBRUMsT0FBTzVDLFVBQVV5QyxTQUFTLGFEN0QzQixDQUFDMU8sSUFDZCxHQUFJQSxFQUFLaU0sVUFBVXlDLFNBQVMsYUFBYyxPQUMxQyxNQUFNZ0MsRUFBZTFRLEVBQUtrSixjQUFjLGNBQ2xDc0ssRUFBVzlDLEVBQWFwRCxZQUM5Qm9ELEVBQWE1RyxTQUViLE1BQU1rRyxFQUFZdkUsSUFBaUJnQixhQUM3QjhELEVBQWE5RSxJQUFpQmEsaUJBQWlCLGlCQUVyRGlFLEVBQVd2SixNQUFRd00sRUFDbkJ4RCxFQUFVL0MsT0FBT3NELEdBRWpCLE1BQU0yQyxFQUFXbFQsRUFBS2tKLGNBQWMsY0FDOUI0RCxFQUFXOU0sRUFBS2tKLGNBQWMsVUFFcENnSyxFQUFTdkosYUFBYXFHLEVBQVdsRCxHQUVqQzlNLEVBQUsyUSxRQUFRdUMsR0FDYjNDLEVBQVdULFFBQ1hRLEtDNENRbUQsQ0FEYTdFLEVBQUVDLE9BQU9WLFFBQVEsVUFHMUJTLEVBQUVDLE9BQU81QyxVQUFVeUMsU0FBUyxpQkQzQ3hCclAsRUM0Q1V1UCxFQUFFQyxPQUFPVixRQUFRLHFCQUFxQmpFLFFBQVE3SyxVRDVDN0NLLEVDNkNKa1AsRUFBRUMsT0FBT1YsUUFBUSxrQkFBa0JqRSxRQUFReEssT0Q1Q3JEdUosU0FBU0MsY0FBYyxrQkFBa0J4SixPQUNqRG9LLFNBQ0wsYUFBeUJ6SyxFQUFXSyxRIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3N0b3JhZ2UuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2VzbS9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL3RvRGF0ZS9pbmRleC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL3N0YXJ0T2ZEYXkvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2VzbS9pc1NhbWVEYXkvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2VzbS9fbGliL3RvSW50ZWdlci9pbmRleC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL3BhcnNlSVNPL2luZGV4LmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9lc20vc3RhcnRPZldlZWsvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2VzbS9pc1NhbWVXZWVrL2luZGV4LmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9oYW5kbGVycy5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL2lzVG9kYXkvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2VzbS9pc1RoaXNXZWVrL2luZGV4LmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9jcmVhdGVET01FbGVtZW50cy5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvcHJvamVjdHMuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3Rhc2tzLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB1cGRhdGVTdG9yYWdlID0gKCkgPT4ge1xuICAgIFxuICAgIGNvbnN0IGdldFByb2plY3RzID0gKCkgPT4ge1xuICAgICAgICAvLyBjcmVhdGVzIGFuIGFycmF5IG9mIG9iamVjdHMgXG4gICAgICAgIGNvbnN0IHByb2plY3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHJvamVjdHMnKSB8fCAnW10nKTtcbiAgICAgICAgcmV0dXJuIHByb2plY3RzO1xuICAgIH1cblxuICAgIGNvbnN0IGdldFRhc2tzID0gKHByb2plY3RJZCkgPT4ge1xuICAgICAgICBjb25zdCBwcm9qZWN0cyA9IGdldFByb2plY3RzKCk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRQcm9qZWN0ID0gcHJvamVjdHMuZmluZChwcm9qZWN0ID0+IHByb2plY3QuaWQgPT0gcHJvamVjdElkKTtcbiAgICAgICAgY29uc3QgdGFza3MgPSBjdXJyZW50UHJvamVjdC50YXNrcztcbiAgICAgICAgcmV0dXJuIHRhc2tzO1xuICAgIH1cblxuICAgIGNvbnN0IHNhdmVQcm9qZWN0ID0gKHByb2plY3RUb1NhdmUpID0+IHtcbiAgICAgICAgY29uc3QgcHJvamVjdHMgPSBnZXRQcm9qZWN0cygpO1xuXG4gICAgICAgIC8vIGZpbmQgbWV0aG9kIHJldHVybnMgdGhlIGZpcnN0IG9iamVjdCB0aGF0IG1hdGNoZXMgdGhlIGlkXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nID0gcHJvamVjdHMuZmluZChwcm9qZWN0ID0+IHByb2plY3QuaWQgPT0gcHJvamVjdFRvU2F2ZS5pZCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nLnByb2plY3ROYW1lID0gcHJvamVjdFRvU2F2ZS5wcm9qZWN0TmFtZTtcbiAgICAgICAgICAgIGV4aXN0aW5nLnRhc2tzID0gcHJvamVjdFRvU2F2ZS50YXNrcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHByb2plY3RUb1NhdmUuaWQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwKTtcbiAgICAgICAgICAgIC8vIEFkZCBwcm9qZWN0TmFtZVxuICAgICAgICAgICAgLy8gQWRkIFRhc2tzIGFycmF5IGNvbnRhaW5pbmcgYW5vdGhlciBhcnJheSB3aGljaCBpbmNsdWRlcyB0YXNrLCBwcmlvcml0eSwgZHVlRGF0ZSwgYW5kIHRydWUvZmFsc2UgZm9yIGNvbXBsZXRlZCBvciBub3RcbiAgICAgICAgICAgIHByb2plY3RzLnB1c2gocHJvamVjdFRvU2F2ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdHMnLCBKU09OLnN0cmluZ2lmeShwcm9qZWN0cykpO1xuICAgIH1cblxuICAgIGNvbnN0IHVwZGF0ZVRhc2sgPSAocHJvamVjdElkLCB1cGRhdGVkVGFzaykgPT4ge1xuICAgICAgICAvLyB0YXNrcyBmb3IgY3VycmVudCBwcm9qZWN0XG4gICAgICAgIGNvbnN0IHByb2plY3RzID0gZ2V0UHJvamVjdHMoKTtcbiAgICAgICAgY29uc3QgcHJvamVjdFRvVXBkYXRlID0gcHJvamVjdHMuZmluZChwcm9qZWN0ID0+IHByb2plY3QuaWQgPT0gcHJvamVjdElkKTtcbiAgICAgICAgY29uc3QgdGFza3NBcnJheSA9IHByb2plY3RUb1VwZGF0ZS50YXNrcztcbiAgICAgICAgXG4gICAgICAgIC8vIGZpbmQgdGFzayBpbmRleCBhbmQgcmVwbGFjZSB0aGUgdGFzayBhdCB0aGF0IGluZGV4IHRvIHVwZGF0ZVxuICAgICAgICBjb25zdCBpbmRleE9mVXBkYXRlZFRhc2sgPSB0YXNrc0FycmF5LmZpbmRJbmRleCgodGFza09iaikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHRhc2tPYmoudGFza0lkID09IHVwZGF0ZWRUYXNrLnRhc2tJZDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGFza3NBcnJheVtpbmRleE9mVXBkYXRlZFRhc2tdID0gdXBkYXRlZFRhc2s7XG4gICAgICAgIC8vIFNhdmUgdXBkYXRlZCB0YXNrcyBhcnJheSB0byB0aGUgcHJvamVjdCBvYmplY3RcbiAgICAgICAgcHJvamVjdFRvVXBkYXRlLnRhc2tzID0gdGFza3NBcnJheTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RzJywgSlNPTi5zdHJpbmdpZnkocHJvamVjdHMpKTtcbiAgICB9XG5cbiAgICBjb25zdCBmaW5kVGFza1RvVXBkYXRlID0gKHByb2plY3RJZCwgZXhpc3RpbmdUYXNrSWQpID0+IHtcbiAgICAgICAgY29uc3QgcHJvamVjdHMgPSBnZXRQcm9qZWN0cygpOyAgICAgXG4gICAgICAgIGNvbnN0IHByb2plY3RUb1VwZGF0ZSA9IHByb2plY3RzLmZpbmQocHJvamVjdCA9PiBwcm9qZWN0LmlkID09IHByb2plY3RJZCk7XG4gICAgICAgIGNvbnN0IHRhc2tzQXJyYXkgPSBwcm9qZWN0VG9VcGRhdGUudGFza3NcbiAgICAgICAgY29uc3QgZXhpc3RpbmdUYXNrID0gdGFza3NBcnJheS5maW5kKHRhc2sgPT4gdGFzay50YXNrSWQgPT0gZXhpc3RpbmdUYXNrSWQpO1xuICAgICAgICByZXR1cm4gZXhpc3RpbmdUYXNrO1xuICAgIH1cblxuICAgIGNvbnN0IGRlbGV0ZVByb2plY3QgPSAoaWQpID0+IHtcbiAgICAgICAgY29uc3QgcHJvamVjdHMgPSBnZXRQcm9qZWN0cygpO1xuICAgICAgICBjb25zdCB1cGRhdGVkUHJvamVjdExpc3QgPSBwcm9qZWN0cy5maWx0ZXIocHJvamVjdCA9PiBwcm9qZWN0LmlkICE9IGlkKTtcblxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdHMnLCBKU09OLnN0cmluZ2lmeSh1cGRhdGVkUHJvamVjdExpc3QpKTtcbiAgICB9XG5cbiAgICBjb25zdCBkZWxldGVUYXNrID0gKGlkLCB0YXNrSWQpID0+IHtcbiAgICAgICAgY29uc3QgcHJvamVjdHMgPSBnZXRQcm9qZWN0cygpO1xuICAgICAgICBjb25zdCBwcm9qZWN0V2l0aFRhc2sgPSBwcm9qZWN0cy5maW5kKHByb2plY3QgPT4gcHJvamVjdC5pZCA9PSBpZCk7XG4gICAgICAgIGNvbnN0IGFsbFRhc2tzID0gcHJvamVjdFdpdGhUYXNrLnRhc2tzO1xuICAgICAgICAvLyBFYWNoIHRhc2sgaXMgYW4gb2JqZWN0XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRUYXNrT2JqID0gYWxsVGFza3MuZmlsdGVyKHRhc2tPYmogPT4gdGFza09iai50YXNrSWQgIT0gdGFza0lkKTtcbiAgICAgICAgcHJvamVjdFdpdGhUYXNrLnRhc2tzID0gdXBkYXRlZFRhc2tPYmo7XG5cbiAgICAgICAgc2F2ZVByb2plY3QocHJvamVjdFdpdGhUYXNrKTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBnZXRQcm9qZWN0cywgZ2V0VGFza3MsIHNhdmVQcm9qZWN0LCBkZWxldGVQcm9qZWN0LCBkZWxldGVUYXNrLCBmaW5kVGFza1RvVXBkYXRlLCB1cGRhdGVUYXNrIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgdXBkYXRlU3RvcmFnZSgpOyIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJlcXVpcmVkQXJncyhyZXF1aXJlZCwgYXJncykge1xuICBpZiAoYXJncy5sZW5ndGggPCByZXF1aXJlZCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IocmVxdWlyZWQgKyAnIGFyZ3VtZW50JyArIChyZXF1aXJlZCA+IDEgPyAncycgOiAnJykgKyAnIHJlcXVpcmVkLCBidXQgb25seSAnICsgYXJncy5sZW5ndGggKyAnIHByZXNlbnQnKTtcbiAgfVxufSIsImltcG9ydCByZXF1aXJlZEFyZ3MgZnJvbSBcIi4uL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzXCI7XG4vKipcbiAqIEBuYW1lIHRvRGF0ZVxuICogQGNhdGVnb3J5IENvbW1vbiBIZWxwZXJzXG4gKiBAc3VtbWFyeSBDb252ZXJ0IHRoZSBnaXZlbiBhcmd1bWVudCB0byBhbiBpbnN0YW5jZSBvZiBEYXRlLlxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQ29udmVydCB0aGUgZ2l2ZW4gYXJndW1lbnQgdG8gYW4gaW5zdGFuY2Ugb2YgRGF0ZS5cbiAqXG4gKiBJZiB0aGUgYXJndW1lbnQgaXMgYW4gaW5zdGFuY2Ugb2YgRGF0ZSwgdGhlIGZ1bmN0aW9uIHJldHVybnMgaXRzIGNsb25lLlxuICpcbiAqIElmIHRoZSBhcmd1bWVudCBpcyBhIG51bWJlciwgaXQgaXMgdHJlYXRlZCBhcyBhIHRpbWVzdGFtcC5cbiAqXG4gKiBJZiB0aGUgYXJndW1lbnQgaXMgbm9uZSBvZiB0aGUgYWJvdmUsIHRoZSBmdW5jdGlvbiByZXR1cm5zIEludmFsaWQgRGF0ZS5cbiAqXG4gKiAqKk5vdGUqKjogKmFsbCogRGF0ZSBhcmd1bWVudHMgcGFzc2VkIHRvIGFueSAqZGF0ZS1mbnMqIGZ1bmN0aW9uIGlzIHByb2Nlc3NlZCBieSBgdG9EYXRlYC5cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBhcmd1bWVudCAtIHRoZSB2YWx1ZSB0byBjb252ZXJ0XG4gKiBAcmV0dXJucyB7RGF0ZX0gdGhlIHBhcnNlZCBkYXRlIGluIHRoZSBsb2NhbCB0aW1lIHpvbmVcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gMSBhcmd1bWVudCByZXF1aXJlZFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBDbG9uZSB0aGUgZGF0ZTpcbiAqIGNvbnN0IHJlc3VsdCA9IHRvRGF0ZShuZXcgRGF0ZSgyMDE0LCAxLCAxMSwgMTEsIDMwLCAzMCkpXG4gKiAvLz0+IFR1ZSBGZWIgMTEgMjAxNCAxMTozMDozMFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBDb252ZXJ0IHRoZSB0aW1lc3RhbXAgdG8gZGF0ZTpcbiAqIGNvbnN0IHJlc3VsdCA9IHRvRGF0ZSgxMzkyMDk4NDMwMDAwKVxuICogLy89PiBUdWUgRmViIDExIDIwMTQgMTE6MzA6MzBcbiAqL1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB0b0RhdGUoYXJndW1lbnQpIHtcbiAgcmVxdWlyZWRBcmdzKDEsIGFyZ3VtZW50cyk7XG4gIHZhciBhcmdTdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJndW1lbnQpOyAvLyBDbG9uZSB0aGUgZGF0ZVxuXG4gIGlmIChhcmd1bWVudCBpbnN0YW5jZW9mIERhdGUgfHwgdHlwZW9mIGFyZ3VtZW50ID09PSAnb2JqZWN0JyAmJiBhcmdTdHIgPT09ICdbb2JqZWN0IERhdGVdJykge1xuICAgIC8vIFByZXZlbnQgdGhlIGRhdGUgdG8gbG9zZSB0aGUgbWlsbGlzZWNvbmRzIHdoZW4gcGFzc2VkIHRvIG5ldyBEYXRlKCkgaW4gSUUxMFxuICAgIHJldHVybiBuZXcgRGF0ZShhcmd1bWVudC5nZXRUaW1lKCkpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBhcmd1bWVudCA9PT0gJ251bWJlcicgfHwgYXJnU3RyID09PSAnW29iamVjdCBOdW1iZXJdJykge1xuICAgIHJldHVybiBuZXcgRGF0ZShhcmd1bWVudCk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKCh0eXBlb2YgYXJndW1lbnQgPT09ICdzdHJpbmcnIHx8IGFyZ1N0ciA9PT0gJ1tvYmplY3QgU3RyaW5nXScpICYmIHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgIGNvbnNvbGUud2FybihcIlN0YXJ0aW5nIHdpdGggdjIuMC4wLWJldGEuMSBkYXRlLWZucyBkb2Vzbid0IGFjY2VwdCBzdHJpbmdzIGFzIGRhdGUgYXJndW1lbnRzLiBQbGVhc2UgdXNlIGBwYXJzZUlTT2AgdG8gcGFyc2Ugc3RyaW5ncy4gU2VlOiBodHRwczovL2dpdC5pby9manVsZVwiKTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcblxuICAgICAgY29uc29sZS53YXJuKG5ldyBFcnJvcigpLnN0YWNrKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IERhdGUoTmFOKTtcbiAgfVxufSIsImltcG9ydCB0b0RhdGUgZnJvbSBcIi4uL3RvRGF0ZS9pbmRleC5qc1wiO1xuaW1wb3J0IHJlcXVpcmVkQXJncyBmcm9tIFwiLi4vX2xpYi9yZXF1aXJlZEFyZ3MvaW5kZXguanNcIjtcbi8qKlxuICogQG5hbWUgc3RhcnRPZkRheVxuICogQGNhdGVnb3J5IERheSBIZWxwZXJzXG4gKiBAc3VtbWFyeSBSZXR1cm4gdGhlIHN0YXJ0IG9mIGEgZGF5IGZvciB0aGUgZ2l2ZW4gZGF0ZS5cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFJldHVybiB0aGUgc3RhcnQgb2YgYSBkYXkgZm9yIHRoZSBnaXZlbiBkYXRlLlxuICogVGhlIHJlc3VsdCB3aWxsIGJlIGluIHRoZSBsb2NhbCB0aW1lem9uZS5cbiAqXG4gKiAjIyMgdjIuMC4wIGJyZWFraW5nIGNoYW5nZXM6XG4gKlxuICogLSBbQ2hhbmdlcyB0aGF0IGFyZSBjb21tb24gZm9yIHRoZSB3aG9sZSBsaWJyYXJ5XShodHRwczovL2dpdGh1Yi5jb20vZGF0ZS1mbnMvZGF0ZS1mbnMvYmxvYi9tYXN0ZXIvZG9jcy91cGdyYWRlR3VpZGUubWQjQ29tbW9uLUNoYW5nZXMpLlxuICpcbiAqIEBwYXJhbSB7RGF0ZXxOdW1iZXJ9IGRhdGUgLSB0aGUgb3JpZ2luYWwgZGF0ZVxuICogQHJldHVybnMge0RhdGV9IHRoZSBzdGFydCBvZiBhIGRheVxuICogQHRocm93cyB7VHlwZUVycm9yfSAxIGFyZ3VtZW50IHJlcXVpcmVkXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIFRoZSBzdGFydCBvZiBhIGRheSBmb3IgMiBTZXB0ZW1iZXIgMjAxNCAxMTo1NTowMDpcbiAqIGNvbnN0IHJlc3VsdCA9IHN0YXJ0T2ZEYXkobmV3IERhdGUoMjAxNCwgOCwgMiwgMTEsIDU1LCAwKSlcbiAqIC8vPT4gVHVlIFNlcCAwMiAyMDE0IDAwOjAwOjAwXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gc3RhcnRPZkRheShkaXJ0eURhdGUpIHtcbiAgcmVxdWlyZWRBcmdzKDEsIGFyZ3VtZW50cyk7XG4gIHZhciBkYXRlID0gdG9EYXRlKGRpcnR5RGF0ZSk7XG4gIGRhdGUuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG4gIHJldHVybiBkYXRlO1xufSIsImltcG9ydCBzdGFydE9mRGF5IGZyb20gXCIuLi9zdGFydE9mRGF5L2luZGV4LmpzXCI7XG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSBpc1NhbWVEYXlcbiAqIEBjYXRlZ29yeSBEYXkgSGVscGVyc1xuICogQHN1bW1hcnkgQXJlIHRoZSBnaXZlbiBkYXRlcyBpbiB0aGUgc2FtZSBkYXk/XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBBcmUgdGhlIGdpdmVuIGRhdGVzIGluIHRoZSBzYW1lIGRheT9cbiAqXG4gKiAjIyMgdjIuMC4wIGJyZWFraW5nIGNoYW5nZXM6XG4gKlxuICogLSBbQ2hhbmdlcyB0aGF0IGFyZSBjb21tb24gZm9yIHRoZSB3aG9sZSBsaWJyYXJ5XShodHRwczovL2dpdGh1Yi5jb20vZGF0ZS1mbnMvZGF0ZS1mbnMvYmxvYi9tYXN0ZXIvZG9jcy91cGdyYWRlR3VpZGUubWQjQ29tbW9uLUNoYW5nZXMpLlxuICpcbiAqIEBwYXJhbSB7RGF0ZXxOdW1iZXJ9IGRhdGVMZWZ0IC0gdGhlIGZpcnN0IGRhdGUgdG8gY2hlY2tcbiAqIEBwYXJhbSB7RGF0ZXxOdW1iZXJ9IGRhdGVSaWdodCAtIHRoZSBzZWNvbmQgZGF0ZSB0byBjaGVja1xuICogQHJldHVybnMge0Jvb2xlYW59IHRoZSBkYXRlcyBhcmUgaW4gdGhlIHNhbWUgZGF5XG4gKiBAdGhyb3dzIHtUeXBlRXJyb3J9IDIgYXJndW1lbnRzIHJlcXVpcmVkXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIEFyZSA0IFNlcHRlbWJlciAwNjowMDowMCBhbmQgNCBTZXB0ZW1iZXIgMTg6MDA6MDAgaW4gdGhlIHNhbWUgZGF5P1xuICogdmFyIHJlc3VsdCA9IGlzU2FtZURheShuZXcgRGF0ZSgyMDE0LCA4LCA0LCA2LCAwKSwgbmV3IERhdGUoMjAxNCwgOCwgNCwgMTgsIDApKVxuICogLy89PiB0cnVlXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNTYW1lRGF5KGRpcnR5RGF0ZUxlZnQsIGRpcnR5RGF0ZVJpZ2h0KSB7XG4gIHJlcXVpcmVkQXJncygyLCBhcmd1bWVudHMpO1xuICB2YXIgZGF0ZUxlZnRTdGFydE9mRGF5ID0gc3RhcnRPZkRheShkaXJ0eURhdGVMZWZ0KTtcbiAgdmFyIGRhdGVSaWdodFN0YXJ0T2ZEYXkgPSBzdGFydE9mRGF5KGRpcnR5RGF0ZVJpZ2h0KTtcbiAgcmV0dXJuIGRhdGVMZWZ0U3RhcnRPZkRheS5nZXRUaW1lKCkgPT09IGRhdGVSaWdodFN0YXJ0T2ZEYXkuZ2V0VGltZSgpO1xufSIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHRvSW50ZWdlcihkaXJ0eU51bWJlcikge1xuICBpZiAoZGlydHlOdW1iZXIgPT09IG51bGwgfHwgZGlydHlOdW1iZXIgPT09IHRydWUgfHwgZGlydHlOdW1iZXIgPT09IGZhbHNlKSB7XG4gICAgcmV0dXJuIE5hTjtcbiAgfVxuXG4gIHZhciBudW1iZXIgPSBOdW1iZXIoZGlydHlOdW1iZXIpO1xuXG4gIGlmIChpc05hTihudW1iZXIpKSB7XG4gICAgcmV0dXJuIG51bWJlcjtcbiAgfVxuXG4gIHJldHVybiBudW1iZXIgPCAwID8gTWF0aC5jZWlsKG51bWJlcikgOiBNYXRoLmZsb29yKG51bWJlcik7XG59IiwiaW1wb3J0IHRvSW50ZWdlciBmcm9tIFwiLi4vX2xpYi90b0ludGVnZXIvaW5kZXguanNcIjtcbmltcG9ydCByZXF1aXJlZEFyZ3MgZnJvbSBcIi4uL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzXCI7XG52YXIgTUlMTElTRUNPTkRTX0lOX0hPVVIgPSAzNjAwMDAwO1xudmFyIE1JTExJU0VDT05EU19JTl9NSU5VVEUgPSA2MDAwMDtcbnZhciBERUZBVUxUX0FERElUSU9OQUxfRElHSVRTID0gMjtcbnZhciBwYXR0ZXJucyA9IHtcbiAgZGF0ZVRpbWVEZWxpbWl0ZXI6IC9bVCBdLyxcbiAgdGltZVpvbmVEZWxpbWl0ZXI6IC9bWiBdL2ksXG4gIHRpbWV6b25lOiAvKFtaKy1dLiopJC9cbn07XG52YXIgZGF0ZVJlZ2V4ID0gL14tPyg/OihcXGR7M30pfChcXGR7Mn0pKD86LT8oXFxkezJ9KSk/fFcoXFxkezJ9KSg/Oi0/KFxcZHsxfSkpP3wpJC87XG52YXIgdGltZVJlZ2V4ID0gL14oXFxkezJ9KD86Wy4sXVxcZCopPykoPzo6PyhcXGR7Mn0oPzpbLixdXFxkKik/KSk/KD86Oj8oXFxkezJ9KD86Wy4sXVxcZCopPykpPyQvO1xudmFyIHRpbWV6b25lUmVnZXggPSAvXihbKy1dKShcXGR7Mn0pKD86Oj8oXFxkezJ9KSk/JC87XG4vKipcbiAqIEBuYW1lIHBhcnNlSVNPXG4gKiBAY2F0ZWdvcnkgQ29tbW9uIEhlbHBlcnNcbiAqIEBzdW1tYXJ5IFBhcnNlIElTTyBzdHJpbmdcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFBhcnNlIHRoZSBnaXZlbiBzdHJpbmcgaW4gSVNPIDg2MDEgZm9ybWF0IGFuZCByZXR1cm4gYW4gaW5zdGFuY2Ugb2YgRGF0ZS5cbiAqXG4gKiBGdW5jdGlvbiBhY2NlcHRzIGNvbXBsZXRlIElTTyA4NjAxIGZvcm1hdHMgYXMgd2VsbCBhcyBwYXJ0aWFsIGltcGxlbWVudGF0aW9ucy5cbiAqIElTTyA4NjAxOiBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0lTT184NjAxXG4gKlxuICogSWYgdGhlIGFyZ3VtZW50IGlzbid0IGEgc3RyaW5nLCB0aGUgZnVuY3Rpb24gY2Fubm90IHBhcnNlIHRoZSBzdHJpbmcgb3JcbiAqIHRoZSB2YWx1ZXMgYXJlIGludmFsaWQsIGl0IHJldHVybnMgSW52YWxpZCBEYXRlLlxuICpcbiAqICMjIyB2Mi4wLjAgYnJlYWtpbmcgY2hhbmdlczpcbiAqXG4gKiAtIFtDaGFuZ2VzIHRoYXQgYXJlIGNvbW1vbiBmb3IgdGhlIHdob2xlIGxpYnJhcnldKGh0dHBzOi8vZ2l0aHViLmNvbS9kYXRlLWZucy9kYXRlLWZucy9ibG9iL21hc3Rlci9kb2NzL3VwZ3JhZGVHdWlkZS5tZCNDb21tb24tQ2hhbmdlcykuXG4gKlxuICogLSBUaGUgcHJldmlvdXMgYHBhcnNlYCBpbXBsZW1lbnRhdGlvbiB3YXMgcmVuYW1lZCB0byBgcGFyc2VJU09gLlxuICpcbiAqICAgYGBgamF2YXNjcmlwdFxuICogICAvLyBCZWZvcmUgdjIuMC4wXG4gKiAgIHBhcnNlKCcyMDE2LTAxLTAxJylcbiAqXG4gKiAgIC8vIHYyLjAuMCBvbndhcmRcbiAqICAgcGFyc2VJU08oJzIwMTYtMDEtMDEnKVxuICogICBgYGBcbiAqXG4gKiAtIGBwYXJzZUlTT2Agbm93IHZhbGlkYXRlcyBzZXBhcmF0ZSBkYXRlIGFuZCB0aW1lIHZhbHVlcyBpbiBJU08tODYwMSBzdHJpbmdzXG4gKiAgIGFuZCByZXR1cm5zIGBJbnZhbGlkIERhdGVgIGlmIHRoZSBkYXRlIGlzIGludmFsaWQuXG4gKlxuICogICBgYGBqYXZhc2NyaXB0XG4gKiAgIHBhcnNlSVNPKCcyMDE4LTEzLTMyJylcbiAqICAgLy89PiBJbnZhbGlkIERhdGVcbiAqICAgYGBgXG4gKlxuICogLSBgcGFyc2VJU09gIG5vdyBkb2Vzbid0IGZhbGwgYmFjayB0byBgbmV3IERhdGVgIGNvbnN0cnVjdG9yXG4gKiAgIGlmIGl0IGZhaWxzIHRvIHBhcnNlIGEgc3RyaW5nIGFyZ3VtZW50LiBJbnN0ZWFkLCBpdCByZXR1cm5zIGBJbnZhbGlkIERhdGVgLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBhcmd1bWVudCAtIHRoZSB2YWx1ZSB0byBjb252ZXJ0XG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIC0gYW4gb2JqZWN0IHdpdGggb3B0aW9ucy5cbiAqIEBwYXJhbSB7MHwxfDJ9IFtvcHRpb25zLmFkZGl0aW9uYWxEaWdpdHM9Ml0gLSB0aGUgYWRkaXRpb25hbCBudW1iZXIgb2YgZGlnaXRzIGluIHRoZSBleHRlbmRlZCB5ZWFyIGZvcm1hdFxuICogQHJldHVybnMge0RhdGV9IHRoZSBwYXJzZWQgZGF0ZSBpbiB0aGUgbG9jYWwgdGltZSB6b25lXG4gKiBAdGhyb3dzIHtUeXBlRXJyb3J9IDEgYXJndW1lbnQgcmVxdWlyZWRcbiAqIEB0aHJvd3Mge1JhbmdlRXJyb3J9IGBvcHRpb25zLmFkZGl0aW9uYWxEaWdpdHNgIG11c3QgYmUgMCwgMSBvciAyXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIENvbnZlcnQgc3RyaW5nICcyMDE0LTAyLTExVDExOjMwOjMwJyB0byBkYXRlOlxuICogdmFyIHJlc3VsdCA9IHBhcnNlSVNPKCcyMDE0LTAyLTExVDExOjMwOjMwJylcbiAqIC8vPT4gVHVlIEZlYiAxMSAyMDE0IDExOjMwOjMwXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIENvbnZlcnQgc3RyaW5nICcrMDIwMTQxMDEnIHRvIGRhdGUsXG4gKiAvLyBpZiB0aGUgYWRkaXRpb25hbCBudW1iZXIgb2YgZGlnaXRzIGluIHRoZSBleHRlbmRlZCB5ZWFyIGZvcm1hdCBpcyAxOlxuICogdmFyIHJlc3VsdCA9IHBhcnNlSVNPKCcrMDIwMTQxMDEnLCB7IGFkZGl0aW9uYWxEaWdpdHM6IDEgfSlcbiAqIC8vPT4gRnJpIEFwciAxMSAyMDE0IDAwOjAwOjAwXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcGFyc2VJU08oYXJndW1lbnQsIGRpcnR5T3B0aW9ucykge1xuICByZXF1aXJlZEFyZ3MoMSwgYXJndW1lbnRzKTtcbiAgdmFyIG9wdGlvbnMgPSBkaXJ0eU9wdGlvbnMgfHwge307XG4gIHZhciBhZGRpdGlvbmFsRGlnaXRzID0gb3B0aW9ucy5hZGRpdGlvbmFsRGlnaXRzID09IG51bGwgPyBERUZBVUxUX0FERElUSU9OQUxfRElHSVRTIDogdG9JbnRlZ2VyKG9wdGlvbnMuYWRkaXRpb25hbERpZ2l0cyk7XG5cbiAgaWYgKGFkZGl0aW9uYWxEaWdpdHMgIT09IDIgJiYgYWRkaXRpb25hbERpZ2l0cyAhPT0gMSAmJiBhZGRpdGlvbmFsRGlnaXRzICE9PSAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ2FkZGl0aW9uYWxEaWdpdHMgbXVzdCBiZSAwLCAxIG9yIDInKTtcbiAgfVxuXG4gIGlmICghKHR5cGVvZiBhcmd1bWVudCA9PT0gJ3N0cmluZycgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFyZ3VtZW50KSA9PT0gJ1tvYmplY3QgU3RyaW5nXScpKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKE5hTik7XG4gIH1cblxuICB2YXIgZGF0ZVN0cmluZ3MgPSBzcGxpdERhdGVTdHJpbmcoYXJndW1lbnQpO1xuICB2YXIgZGF0ZTtcblxuICBpZiAoZGF0ZVN0cmluZ3MuZGF0ZSkge1xuICAgIHZhciBwYXJzZVllYXJSZXN1bHQgPSBwYXJzZVllYXIoZGF0ZVN0cmluZ3MuZGF0ZSwgYWRkaXRpb25hbERpZ2l0cyk7XG4gICAgZGF0ZSA9IHBhcnNlRGF0ZShwYXJzZVllYXJSZXN1bHQucmVzdERhdGVTdHJpbmcsIHBhcnNlWWVhclJlc3VsdC55ZWFyKTtcbiAgfVxuXG4gIGlmIChpc05hTihkYXRlKSB8fCAhZGF0ZSkge1xuICAgIHJldHVybiBuZXcgRGF0ZShOYU4pO1xuICB9XG5cbiAgdmFyIHRpbWVzdGFtcCA9IGRhdGUuZ2V0VGltZSgpO1xuICB2YXIgdGltZSA9IDA7XG4gIHZhciBvZmZzZXQ7XG5cbiAgaWYgKGRhdGVTdHJpbmdzLnRpbWUpIHtcbiAgICB0aW1lID0gcGFyc2VUaW1lKGRhdGVTdHJpbmdzLnRpbWUpO1xuXG4gICAgaWYgKGlzTmFOKHRpbWUpIHx8IHRpbWUgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBuZXcgRGF0ZShOYU4pO1xuICAgIH1cbiAgfVxuXG4gIGlmIChkYXRlU3RyaW5ncy50aW1lem9uZSkge1xuICAgIG9mZnNldCA9IHBhcnNlVGltZXpvbmUoZGF0ZVN0cmluZ3MudGltZXpvbmUpO1xuXG4gICAgaWYgKGlzTmFOKG9mZnNldCkpIHtcbiAgICAgIHJldHVybiBuZXcgRGF0ZShOYU4pO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB2YXIgZGlydHlEYXRlID0gbmV3IERhdGUodGltZXN0YW1wICsgdGltZSk7IC8vIGpzIHBhcnNlZCBzdHJpbmcgYXNzdW1pbmcgaXQncyBpbiBVVEMgdGltZXpvbmVcbiAgICAvLyBidXQgd2UgbmVlZCBpdCB0byBiZSBwYXJzZWQgaW4gb3VyIHRpbWV6b25lXG4gICAgLy8gc28gd2UgdXNlIHV0YyB2YWx1ZXMgdG8gYnVpbGQgZGF0ZSBpbiBvdXIgdGltZXpvbmUuXG4gICAgLy8gWWVhciB2YWx1ZXMgZnJvbSAwIHRvIDk5IG1hcCB0byB0aGUgeWVhcnMgMTkwMCB0byAxOTk5XG4gICAgLy8gc28gc2V0IHllYXIgZXhwbGljaXRseSB3aXRoIHNldEZ1bGxZZWFyLlxuXG4gICAgdmFyIHJlc3VsdCA9IG5ldyBEYXRlKDApO1xuICAgIHJlc3VsdC5zZXRGdWxsWWVhcihkaXJ0eURhdGUuZ2V0VVRDRnVsbFllYXIoKSwgZGlydHlEYXRlLmdldFVUQ01vbnRoKCksIGRpcnR5RGF0ZS5nZXRVVENEYXRlKCkpO1xuICAgIHJlc3VsdC5zZXRIb3VycyhkaXJ0eURhdGUuZ2V0VVRDSG91cnMoKSwgZGlydHlEYXRlLmdldFVUQ01pbnV0ZXMoKSwgZGlydHlEYXRlLmdldFVUQ1NlY29uZHMoKSwgZGlydHlEYXRlLmdldFVUQ01pbGxpc2Vjb25kcygpKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcmV0dXJuIG5ldyBEYXRlKHRpbWVzdGFtcCArIHRpbWUgKyBvZmZzZXQpO1xufVxuXG5mdW5jdGlvbiBzcGxpdERhdGVTdHJpbmcoZGF0ZVN0cmluZykge1xuICB2YXIgZGF0ZVN0cmluZ3MgPSB7fTtcbiAgdmFyIGFycmF5ID0gZGF0ZVN0cmluZy5zcGxpdChwYXR0ZXJucy5kYXRlVGltZURlbGltaXRlcik7XG4gIHZhciB0aW1lU3RyaW5nOyAvLyBUaGUgcmVnZXggbWF0Y2ggc2hvdWxkIG9ubHkgcmV0dXJuIGF0IG1heGltdW0gdHdvIGFycmF5IGVsZW1lbnRzLlxuICAvLyBbZGF0ZV0sIFt0aW1lXSwgb3IgW2RhdGUsIHRpbWVdLlxuXG4gIGlmIChhcnJheS5sZW5ndGggPiAyKSB7XG4gICAgcmV0dXJuIGRhdGVTdHJpbmdzO1xuICB9XG5cbiAgaWYgKC86Ly50ZXN0KGFycmF5WzBdKSkge1xuICAgIGRhdGVTdHJpbmdzLmRhdGUgPSBudWxsO1xuICAgIHRpbWVTdHJpbmcgPSBhcnJheVswXTtcbiAgfSBlbHNlIHtcbiAgICBkYXRlU3RyaW5ncy5kYXRlID0gYXJyYXlbMF07XG4gICAgdGltZVN0cmluZyA9IGFycmF5WzFdO1xuXG4gICAgaWYgKHBhdHRlcm5zLnRpbWVab25lRGVsaW1pdGVyLnRlc3QoZGF0ZVN0cmluZ3MuZGF0ZSkpIHtcbiAgICAgIGRhdGVTdHJpbmdzLmRhdGUgPSBkYXRlU3RyaW5nLnNwbGl0KHBhdHRlcm5zLnRpbWVab25lRGVsaW1pdGVyKVswXTtcbiAgICAgIHRpbWVTdHJpbmcgPSBkYXRlU3RyaW5nLnN1YnN0cihkYXRlU3RyaW5ncy5kYXRlLmxlbmd0aCwgZGF0ZVN0cmluZy5sZW5ndGgpO1xuICAgIH1cbiAgfVxuXG4gIGlmICh0aW1lU3RyaW5nKSB7XG4gICAgdmFyIHRva2VuID0gcGF0dGVybnMudGltZXpvbmUuZXhlYyh0aW1lU3RyaW5nKTtcblxuICAgIGlmICh0b2tlbikge1xuICAgICAgZGF0ZVN0cmluZ3MudGltZSA9IHRpbWVTdHJpbmcucmVwbGFjZSh0b2tlblsxXSwgJycpO1xuICAgICAgZGF0ZVN0cmluZ3MudGltZXpvbmUgPSB0b2tlblsxXTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGF0ZVN0cmluZ3MudGltZSA9IHRpbWVTdHJpbmc7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGRhdGVTdHJpbmdzO1xufVxuXG5mdW5jdGlvbiBwYXJzZVllYXIoZGF0ZVN0cmluZywgYWRkaXRpb25hbERpZ2l0cykge1xuICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKCdeKD86KFxcXFxkezR9fFsrLV1cXFxcZHsnICsgKDQgKyBhZGRpdGlvbmFsRGlnaXRzKSArICd9KXwoXFxcXGR7Mn18WystXVxcXFxkeycgKyAoMiArIGFkZGl0aW9uYWxEaWdpdHMpICsgJ30pJCknKTtcbiAgdmFyIGNhcHR1cmVzID0gZGF0ZVN0cmluZy5tYXRjaChyZWdleCk7IC8vIEludmFsaWQgSVNPLWZvcm1hdHRlZCB5ZWFyXG5cbiAgaWYgKCFjYXB0dXJlcykgcmV0dXJuIHtcbiAgICB5ZWFyOiBudWxsXG4gIH07XG4gIHZhciB5ZWFyID0gY2FwdHVyZXNbMV0gJiYgcGFyc2VJbnQoY2FwdHVyZXNbMV0pO1xuICB2YXIgY2VudHVyeSA9IGNhcHR1cmVzWzJdICYmIHBhcnNlSW50KGNhcHR1cmVzWzJdKTtcbiAgcmV0dXJuIHtcbiAgICB5ZWFyOiBjZW50dXJ5ID09IG51bGwgPyB5ZWFyIDogY2VudHVyeSAqIDEwMCxcbiAgICByZXN0RGF0ZVN0cmluZzogZGF0ZVN0cmluZy5zbGljZSgoY2FwdHVyZXNbMV0gfHwgY2FwdHVyZXNbMl0pLmxlbmd0aClcbiAgfTtcbn1cblxuZnVuY3Rpb24gcGFyc2VEYXRlKGRhdGVTdHJpbmcsIHllYXIpIHtcbiAgLy8gSW52YWxpZCBJU08tZm9ybWF0dGVkIHllYXJcbiAgaWYgKHllYXIgPT09IG51bGwpIHJldHVybiBudWxsO1xuICB2YXIgY2FwdHVyZXMgPSBkYXRlU3RyaW5nLm1hdGNoKGRhdGVSZWdleCk7IC8vIEludmFsaWQgSVNPLWZvcm1hdHRlZCBzdHJpbmdcblxuICBpZiAoIWNhcHR1cmVzKSByZXR1cm4gbnVsbDtcbiAgdmFyIGlzV2Vla0RhdGUgPSAhIWNhcHR1cmVzWzRdO1xuICB2YXIgZGF5T2ZZZWFyID0gcGFyc2VEYXRlVW5pdChjYXB0dXJlc1sxXSk7XG4gIHZhciBtb250aCA9IHBhcnNlRGF0ZVVuaXQoY2FwdHVyZXNbMl0pIC0gMTtcbiAgdmFyIGRheSA9IHBhcnNlRGF0ZVVuaXQoY2FwdHVyZXNbM10pO1xuICB2YXIgd2VlayA9IHBhcnNlRGF0ZVVuaXQoY2FwdHVyZXNbNF0pO1xuICB2YXIgZGF5T2ZXZWVrID0gcGFyc2VEYXRlVW5pdChjYXB0dXJlc1s1XSkgLSAxO1xuXG4gIGlmIChpc1dlZWtEYXRlKSB7XG4gICAgaWYgKCF2YWxpZGF0ZVdlZWtEYXRlKHllYXIsIHdlZWssIGRheU9mV2VlaykpIHtcbiAgICAgIHJldHVybiBuZXcgRGF0ZShOYU4pO1xuICAgIH1cblxuICAgIHJldHVybiBkYXlPZklTT1dlZWtZZWFyKHllYXIsIHdlZWssIGRheU9mV2Vlayk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgwKTtcblxuICAgIGlmICghdmFsaWRhdGVEYXRlKHllYXIsIG1vbnRoLCBkYXkpIHx8ICF2YWxpZGF0ZURheU9mWWVhckRhdGUoeWVhciwgZGF5T2ZZZWFyKSkge1xuICAgICAgcmV0dXJuIG5ldyBEYXRlKE5hTik7XG4gICAgfVxuXG4gICAgZGF0ZS5zZXRVVENGdWxsWWVhcih5ZWFyLCBtb250aCwgTWF0aC5tYXgoZGF5T2ZZZWFyLCBkYXkpKTtcbiAgICByZXR1cm4gZGF0ZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwYXJzZURhdGVVbml0KHZhbHVlKSB7XG4gIHJldHVybiB2YWx1ZSA/IHBhcnNlSW50KHZhbHVlKSA6IDE7XG59XG5cbmZ1bmN0aW9uIHBhcnNlVGltZSh0aW1lU3RyaW5nKSB7XG4gIHZhciBjYXB0dXJlcyA9IHRpbWVTdHJpbmcubWF0Y2godGltZVJlZ2V4KTtcbiAgaWYgKCFjYXB0dXJlcykgcmV0dXJuIG51bGw7IC8vIEludmFsaWQgSVNPLWZvcm1hdHRlZCB0aW1lXG5cbiAgdmFyIGhvdXJzID0gcGFyc2VUaW1lVW5pdChjYXB0dXJlc1sxXSk7XG4gIHZhciBtaW51dGVzID0gcGFyc2VUaW1lVW5pdChjYXB0dXJlc1syXSk7XG4gIHZhciBzZWNvbmRzID0gcGFyc2VUaW1lVW5pdChjYXB0dXJlc1szXSk7XG5cbiAgaWYgKCF2YWxpZGF0ZVRpbWUoaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpKSB7XG4gICAgcmV0dXJuIE5hTjtcbiAgfVxuXG4gIHJldHVybiBob3VycyAqIE1JTExJU0VDT05EU19JTl9IT1VSICsgbWludXRlcyAqIE1JTExJU0VDT05EU19JTl9NSU5VVEUgKyBzZWNvbmRzICogMTAwMDtcbn1cblxuZnVuY3Rpb24gcGFyc2VUaW1lVW5pdCh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgJiYgcGFyc2VGbG9hdCh2YWx1ZS5yZXBsYWNlKCcsJywgJy4nKSkgfHwgMDtcbn1cblxuZnVuY3Rpb24gcGFyc2VUaW1lem9uZSh0aW1lem9uZVN0cmluZykge1xuICBpZiAodGltZXpvbmVTdHJpbmcgPT09ICdaJykgcmV0dXJuIDA7XG4gIHZhciBjYXB0dXJlcyA9IHRpbWV6b25lU3RyaW5nLm1hdGNoKHRpbWV6b25lUmVnZXgpO1xuICBpZiAoIWNhcHR1cmVzKSByZXR1cm4gMDtcbiAgdmFyIHNpZ24gPSBjYXB0dXJlc1sxXSA9PT0gJysnID8gLTEgOiAxO1xuICB2YXIgaG91cnMgPSBwYXJzZUludChjYXB0dXJlc1syXSk7XG4gIHZhciBtaW51dGVzID0gY2FwdHVyZXNbM10gJiYgcGFyc2VJbnQoY2FwdHVyZXNbM10pIHx8IDA7XG5cbiAgaWYgKCF2YWxpZGF0ZVRpbWV6b25lKGhvdXJzLCBtaW51dGVzKSkge1xuICAgIHJldHVybiBOYU47XG4gIH1cblxuICByZXR1cm4gc2lnbiAqIChob3VycyAqIE1JTExJU0VDT05EU19JTl9IT1VSICsgbWludXRlcyAqIE1JTExJU0VDT05EU19JTl9NSU5VVEUpO1xufVxuXG5mdW5jdGlvbiBkYXlPZklTT1dlZWtZZWFyKGlzb1dlZWtZZWFyLCB3ZWVrLCBkYXkpIHtcbiAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgwKTtcbiAgZGF0ZS5zZXRVVENGdWxsWWVhcihpc29XZWVrWWVhciwgMCwgNCk7XG4gIHZhciBmb3VydGhPZkphbnVhcnlEYXkgPSBkYXRlLmdldFVUQ0RheSgpIHx8IDc7XG4gIHZhciBkaWZmID0gKHdlZWsgLSAxKSAqIDcgKyBkYXkgKyAxIC0gZm91cnRoT2ZKYW51YXJ5RGF5O1xuICBkYXRlLnNldFVUQ0RhdGUoZGF0ZS5nZXRVVENEYXRlKCkgKyBkaWZmKTtcbiAgcmV0dXJuIGRhdGU7XG59IC8vIFZhbGlkYXRpb24gZnVuY3Rpb25zXG4vLyBGZWJydWFyeSBpcyBudWxsIHRvIGhhbmRsZSB0aGUgbGVhcCB5ZWFyICh1c2luZyB8fClcblxuXG52YXIgZGF5c0luTW9udGhzID0gWzMxLCBudWxsLCAzMSwgMzAsIDMxLCAzMCwgMzEsIDMxLCAzMCwgMzEsIDMwLCAzMV07XG5cbmZ1bmN0aW9uIGlzTGVhcFllYXJJbmRleCh5ZWFyKSB7XG4gIHJldHVybiB5ZWFyICUgNDAwID09PSAwIHx8IHllYXIgJSA0ID09PSAwICYmIHllYXIgJSAxMDA7XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlRGF0ZSh5ZWFyLCBtb250aCwgZGF0ZSkge1xuICByZXR1cm4gbW9udGggPj0gMCAmJiBtb250aCA8PSAxMSAmJiBkYXRlID49IDEgJiYgZGF0ZSA8PSAoZGF5c0luTW9udGhzW21vbnRoXSB8fCAoaXNMZWFwWWVhckluZGV4KHllYXIpID8gMjkgOiAyOCkpO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZURheU9mWWVhckRhdGUoeWVhciwgZGF5T2ZZZWFyKSB7XG4gIHJldHVybiBkYXlPZlllYXIgPj0gMSAmJiBkYXlPZlllYXIgPD0gKGlzTGVhcFllYXJJbmRleCh5ZWFyKSA/IDM2NiA6IDM2NSk7XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlV2Vla0RhdGUoX3llYXIsIHdlZWssIGRheSkge1xuICByZXR1cm4gd2VlayA+PSAxICYmIHdlZWsgPD0gNTMgJiYgZGF5ID49IDAgJiYgZGF5IDw9IDY7XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlVGltZShob3VycywgbWludXRlcywgc2Vjb25kcykge1xuICBpZiAoaG91cnMgPT09IDI0KSB7XG4gICAgcmV0dXJuIG1pbnV0ZXMgPT09IDAgJiYgc2Vjb25kcyA9PT0gMDtcbiAgfVxuXG4gIHJldHVybiBzZWNvbmRzID49IDAgJiYgc2Vjb25kcyA8IDYwICYmIG1pbnV0ZXMgPj0gMCAmJiBtaW51dGVzIDwgNjAgJiYgaG91cnMgPj0gMCAmJiBob3VycyA8IDI1O1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZVRpbWV6b25lKF9ob3VycywgbWludXRlcykge1xuICByZXR1cm4gbWludXRlcyA+PSAwICYmIG1pbnV0ZXMgPD0gNTk7XG59IiwiaW1wb3J0IHRvRGF0ZSBmcm9tIFwiLi4vdG9EYXRlL2luZGV4LmpzXCI7XG5pbXBvcnQgdG9JbnRlZ2VyIGZyb20gXCIuLi9fbGliL3RvSW50ZWdlci9pbmRleC5qc1wiO1xuaW1wb3J0IHJlcXVpcmVkQXJncyBmcm9tIFwiLi4vX2xpYi9yZXF1aXJlZEFyZ3MvaW5kZXguanNcIjtcbi8qKlxuICogQG5hbWUgc3RhcnRPZldlZWtcbiAqIEBjYXRlZ29yeSBXZWVrIEhlbHBlcnNcbiAqIEBzdW1tYXJ5IFJldHVybiB0aGUgc3RhcnQgb2YgYSB3ZWVrIGZvciB0aGUgZ2l2ZW4gZGF0ZS5cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFJldHVybiB0aGUgc3RhcnQgb2YgYSB3ZWVrIGZvciB0aGUgZ2l2ZW4gZGF0ZS5cbiAqIFRoZSByZXN1bHQgd2lsbCBiZSBpbiB0aGUgbG9jYWwgdGltZXpvbmUuXG4gKlxuICogIyMjIHYyLjAuMCBicmVha2luZyBjaGFuZ2VzOlxuICpcbiAqIC0gW0NoYW5nZXMgdGhhdCBhcmUgY29tbW9uIGZvciB0aGUgd2hvbGUgbGlicmFyeV0oaHR0cHM6Ly9naXRodWIuY29tL2RhdGUtZm5zL2RhdGUtZm5zL2Jsb2IvbWFzdGVyL2RvY3MvdXBncmFkZUd1aWRlLm1kI0NvbW1vbi1DaGFuZ2VzKS5cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlIC0gdGhlIG9yaWdpbmFsIGRhdGVcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gLSBhbiBvYmplY3Qgd2l0aCBvcHRpb25zLlxuICogQHBhcmFtIHtMb2NhbGV9IFtvcHRpb25zLmxvY2FsZT1kZWZhdWx0TG9jYWxlXSAtIHRoZSBsb2NhbGUgb2JqZWN0LiBTZWUgW0xvY2FsZV17QGxpbmsgaHR0cHM6Ly9kYXRlLWZucy5vcmcvZG9jcy9Mb2NhbGV9XG4gKiBAcGFyYW0gezB8MXwyfDN8NHw1fDZ9IFtvcHRpb25zLndlZWtTdGFydHNPbj0wXSAtIHRoZSBpbmRleCBvZiB0aGUgZmlyc3QgZGF5IG9mIHRoZSB3ZWVrICgwIC0gU3VuZGF5KVxuICogQHJldHVybnMge0RhdGV9IHRoZSBzdGFydCBvZiBhIHdlZWtcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gMSBhcmd1bWVudCByZXF1aXJlZFxuICogQHRocm93cyB7UmFuZ2VFcnJvcn0gYG9wdGlvbnMud2Vla1N0YXJ0c09uYCBtdXN0IGJlIGJldHdlZW4gMCBhbmQgNlxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBUaGUgc3RhcnQgb2YgYSB3ZWVrIGZvciAyIFNlcHRlbWJlciAyMDE0IDExOjU1OjAwOlxuICogY29uc3QgcmVzdWx0ID0gc3RhcnRPZldlZWsobmV3IERhdGUoMjAxNCwgOCwgMiwgMTEsIDU1LCAwKSlcbiAqIC8vPT4gU3VuIEF1ZyAzMSAyMDE0IDAwOjAwOjAwXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIElmIHRoZSB3ZWVrIHN0YXJ0cyBvbiBNb25kYXksIHRoZSBzdGFydCBvZiB0aGUgd2VlayBmb3IgMiBTZXB0ZW1iZXIgMjAxNCAxMTo1NTowMDpcbiAqIGNvbnN0IHJlc3VsdCA9IHN0YXJ0T2ZXZWVrKG5ldyBEYXRlKDIwMTQsIDgsIDIsIDExLCA1NSwgMCksIHsgd2Vla1N0YXJ0c09uOiAxIH0pXG4gKiAvLz0+IE1vbiBTZXAgMDEgMjAxNCAwMDowMDowMFxuICovXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHN0YXJ0T2ZXZWVrKGRpcnR5RGF0ZSwgZGlydHlPcHRpb25zKSB7XG4gIHJlcXVpcmVkQXJncygxLCBhcmd1bWVudHMpO1xuICB2YXIgb3B0aW9ucyA9IGRpcnR5T3B0aW9ucyB8fCB7fTtcbiAgdmFyIGxvY2FsZSA9IG9wdGlvbnMubG9jYWxlO1xuICB2YXIgbG9jYWxlV2Vla1N0YXJ0c09uID0gbG9jYWxlICYmIGxvY2FsZS5vcHRpb25zICYmIGxvY2FsZS5vcHRpb25zLndlZWtTdGFydHNPbjtcbiAgdmFyIGRlZmF1bHRXZWVrU3RhcnRzT24gPSBsb2NhbGVXZWVrU3RhcnRzT24gPT0gbnVsbCA/IDAgOiB0b0ludGVnZXIobG9jYWxlV2Vla1N0YXJ0c09uKTtcbiAgdmFyIHdlZWtTdGFydHNPbiA9IG9wdGlvbnMud2Vla1N0YXJ0c09uID09IG51bGwgPyBkZWZhdWx0V2Vla1N0YXJ0c09uIDogdG9JbnRlZ2VyKG9wdGlvbnMud2Vla1N0YXJ0c09uKTsgLy8gVGVzdCBpZiB3ZWVrU3RhcnRzT24gaXMgYmV0d2VlbiAwIGFuZCA2IF9hbmRfIGlzIG5vdCBOYU5cblxuICBpZiAoISh3ZWVrU3RhcnRzT24gPj0gMCAmJiB3ZWVrU3RhcnRzT24gPD0gNikpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignd2Vla1N0YXJ0c09uIG11c3QgYmUgYmV0d2VlbiAwIGFuZCA2IGluY2x1c2l2ZWx5Jyk7XG4gIH1cblxuICB2YXIgZGF0ZSA9IHRvRGF0ZShkaXJ0eURhdGUpO1xuICB2YXIgZGF5ID0gZGF0ZS5nZXREYXkoKTtcbiAgdmFyIGRpZmYgPSAoZGF5IDwgd2Vla1N0YXJ0c09uID8gNyA6IDApICsgZGF5IC0gd2Vla1N0YXJ0c09uO1xuICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgLSBkaWZmKTtcbiAgZGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgcmV0dXJuIGRhdGU7XG59IiwiaW1wb3J0IHN0YXJ0T2ZXZWVrIGZyb20gXCIuLi9zdGFydE9mV2Vlay9pbmRleC5qc1wiO1xuaW1wb3J0IHJlcXVpcmVkQXJncyBmcm9tIFwiLi4vX2xpYi9yZXF1aXJlZEFyZ3MvaW5kZXguanNcIjtcblxuLyoqXG4gKiBAbmFtZSBpc1NhbWVXZWVrXG4gKiBAY2F0ZWdvcnkgV2VlayBIZWxwZXJzXG4gKiBAc3VtbWFyeSBBcmUgdGhlIGdpdmVuIGRhdGVzIGluIHRoZSBzYW1lIHdlZWs/XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBBcmUgdGhlIGdpdmVuIGRhdGVzIGluIHRoZSBzYW1lIHdlZWs/XG4gKlxuICogIyMjIHYyLjAuMCBicmVha2luZyBjaGFuZ2VzOlxuICpcbiAqIC0gW0NoYW5nZXMgdGhhdCBhcmUgY29tbW9uIGZvciB0aGUgd2hvbGUgbGlicmFyeV0oaHR0cHM6Ly9naXRodWIuY29tL2RhdGUtZm5zL2RhdGUtZm5zL2Jsb2IvbWFzdGVyL2RvY3MvdXBncmFkZUd1aWRlLm1kI0NvbW1vbi1DaGFuZ2VzKS5cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlTGVmdCAtIHRoZSBmaXJzdCBkYXRlIHRvIGNoZWNrXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlUmlnaHQgLSB0aGUgc2Vjb25kIGRhdGUgdG8gY2hlY2tcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gLSBhbiBvYmplY3Qgd2l0aCBvcHRpb25zLlxuICogQHBhcmFtIHtMb2NhbGV9IFtvcHRpb25zLmxvY2FsZT1kZWZhdWx0TG9jYWxlXSAtIHRoZSBsb2NhbGUgb2JqZWN0LiBTZWUgW0xvY2FsZV17QGxpbmsgaHR0cHM6Ly9kYXRlLWZucy5vcmcvZG9jcy9Mb2NhbGV9XG4gKiBAcGFyYW0gezB8MXwyfDN8NHw1fDZ9IFtvcHRpb25zLndlZWtTdGFydHNPbj0wXSAtIHRoZSBpbmRleCBvZiB0aGUgZmlyc3QgZGF5IG9mIHRoZSB3ZWVrICgwIC0gU3VuZGF5KVxuICogQHJldHVybnMge0Jvb2xlYW59IHRoZSBkYXRlcyBhcmUgaW4gdGhlIHNhbWUgd2Vla1xuICogQHRocm93cyB7VHlwZUVycm9yfSAyIGFyZ3VtZW50cyByZXF1aXJlZFxuICogQHRocm93cyB7UmFuZ2VFcnJvcn0gYG9wdGlvbnMud2Vla1N0YXJ0c09uYCBtdXN0IGJlIGJldHdlZW4gMCBhbmQgNlxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBBcmUgMzEgQXVndXN0IDIwMTQgYW5kIDQgU2VwdGVtYmVyIDIwMTQgaW4gdGhlIHNhbWUgd2Vlaz9cbiAqIHZhciByZXN1bHQgPSBpc1NhbWVXZWVrKG5ldyBEYXRlKDIwMTQsIDcsIDMxKSwgbmV3IERhdGUoMjAxNCwgOCwgNCkpXG4gKiAvLz0+IHRydWVcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gSWYgd2VlayBzdGFydHMgd2l0aCBNb25kYXksXG4gKiAvLyBhcmUgMzEgQXVndXN0IDIwMTQgYW5kIDQgU2VwdGVtYmVyIDIwMTQgaW4gdGhlIHNhbWUgd2Vlaz9cbiAqIHZhciByZXN1bHQgPSBpc1NhbWVXZWVrKG5ldyBEYXRlKDIwMTQsIDcsIDMxKSwgbmV3IERhdGUoMjAxNCwgOCwgNCksIHtcbiAqICAgd2Vla1N0YXJ0c09uOiAxXG4gKiB9KVxuICogLy89PiBmYWxzZVxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc1NhbWVXZWVrKGRpcnR5RGF0ZUxlZnQsIGRpcnR5RGF0ZVJpZ2h0LCBkaXJ0eU9wdGlvbnMpIHtcbiAgcmVxdWlyZWRBcmdzKDIsIGFyZ3VtZW50cyk7XG4gIHZhciBkYXRlTGVmdFN0YXJ0T2ZXZWVrID0gc3RhcnRPZldlZWsoZGlydHlEYXRlTGVmdCwgZGlydHlPcHRpb25zKTtcbiAgdmFyIGRhdGVSaWdodFN0YXJ0T2ZXZWVrID0gc3RhcnRPZldlZWsoZGlydHlEYXRlUmlnaHQsIGRpcnR5T3B0aW9ucyk7XG4gIHJldHVybiBkYXRlTGVmdFN0YXJ0T2ZXZWVrLmdldFRpbWUoKSA9PT0gZGF0ZVJpZ2h0U3RhcnRPZldlZWsuZ2V0VGltZSgpO1xufSIsImltcG9ydCB7IHVwZGF0ZVByb2plY3RMaXN0LCB1cGRhdGVBY3RpdmVUYWIsIGFkZFByb2plY3RUb05vdGVwYWQsIGxvYWRUYXNrIH0gZnJvbSBcIi4vY3JlYXRlRE9NRWxlbWVudHNcIjtcbmltcG9ydCB1cGRhdGVTdG9yYWdlIGZyb20gXCIuL3N0b3JhZ2VcIjtcbmltcG9ydCB7IGlzVGhpc1dlZWssIGlzVG9kYXksIHBhcnNlSVNPIH0gZnJvbSBcImRhdGUtZm5zXCI7XG5cbmNvbnN0IGhhbmRsZXJzID0gKCkgPT4ge1xuICAgIFxuICAgIGNvbnN0IF9yZWZyZXNoUHJvamVjdExpc3QgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2plY3RzID0gdXBkYXRlU3RvcmFnZS5nZXRQcm9qZWN0cygpOyAvLyBVcGRhdGUgcHJvamVjdHMgaW4gc3RvcmFnZSAgICAgICAgXG4gICAgICAgIHVwZGF0ZVByb2plY3RMaXN0KHByb2plY3RzKTsgLy8gVXBkYXRlIHByb2plY3RzIG9uIERPTVxuICAgIH1cblxuICAgIGNvbnN0IG9uSG9tZVRhYlNlbGVjdCA9IChwcm9qZWN0cywgdGFiKSA9PiB7XG4gICAgICAgIGxvYWRBbGxQcm9qZWN0cyhwcm9qZWN0cyk7ICBcbiAgICAgICAgdXBkYXRlQWN0aXZlVGFiKHRhYik7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IG9uVG9kYXlUYWJTZWxlY3QgPSAocHJvamVjdHMsIHRhYikgPT4ge1xuICAgICAgICBsb2FkQWxsUHJvamVjdHMocHJvamVjdHMpO1xuICAgICAgICAvLyBGaWx0ZXIgcHJvamVjdHMgdGhhdCBoYXZlIHRhc2tzIGR1ZSB0b2RheVxuICAgICAgICBwcm9qZWN0cy5mb3JFYWNoKHByb2plY3QgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGFza3MgPSBwcm9qZWN0LnRhc2tzO1xuXG4gICAgICAgICAgICBjb25zdCB0b2RheXNUYXNrcyA9IHRhc2tzLmZpbHRlcih0YXNrID0+IGR1ZVRvZGF5KHRhc2spKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSGlkZSBwcm9qZWN0IGNvbnRhaW5lciBpZiBubyB0YXNrcyBkdWUgdG9kYXlcbiAgICAgICAgICAgIGlmICh0b2RheXNUYXNrcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBub3RlcGFkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5vdGVwYWQnKVxuICAgICAgICAgICAgICAgIGNvbnN0IHByb2plY3RDb250YWluZXIgPSBub3RlcGFkLnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXByb2plY3QtaWQ9XCIke3Byb2plY3QuaWR9XCJdYCk7XG4gICAgICAgICAgICAgICAgcHJvamVjdENvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUmVtb3ZlIHRhc2tzIHRoYXQgYXJlIG5vdCBkdWUgdG9kYXkgZnJvbSBET01cbiAgICAgICAgICAgIGNvbnN0IG5vdER1ZVRvZGF5ID0gdGFza3MuZmlsdGVyKHRhc2sgPT4gIWR1ZVRvZGF5KHRhc2spKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbm90RHVlVG9kYXkuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXNrQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtdGFzay1pZD1cIiR7dGFzay50YXNrSWR9XCJdYCk7XG4gICAgICAgICAgICAgICAgaWYgKHRhc2tDb250YWluZXIpIHRhc2tDb250YWluZXIucmVtb3ZlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHVwZGF0ZUFjdGl2ZVRhYih0YWIpO1xuICAgIH1cblxuICAgIGNvbnN0IGR1ZVRvZGF5ID0gKHRhc2spID0+IHtcbiAgICAgICAgaWYgKGlzVG9kYXkocGFyc2VJU08odGFzay5kdWVEYXRlKSkpIHJldHVybiB0YXNrO1xuICAgIH1cblxuICAgIGNvbnN0IG9uVGhpc1dlZWtUYWJTZWxlY3QgPSAocHJvamVjdHMsIHRhYikgPT4ge1xuICAgICAgICBsb2FkQWxsUHJvamVjdHMocHJvamVjdHMpO1xuXG4gICAgICAgIHByb2plY3RzLmZvckVhY2gocHJvamVjdCA9PiB7XG4gICAgICAgICAgICBjb25zdCB0YXNrcyA9IHByb2plY3QudGFza3M7XG4gICAgICAgICAgICBjb25zdCB0aGlzV2Vla3NUYXNrcyA9IHRhc2tzLmZpbHRlcih0YXNrID0+IGR1ZVRoaXNXZWVrKHRhc2spKTtcblxuICAgICAgICAgICAgLy8gSGlkZSBwcm9qZWN0IGNvbnRhaW5lciBpZiBubyB0YXNrcyBkdWUgdGhpcyB3ZWVrXG4gICAgICAgICAgICBpZiAodGhpc1dlZWtzVGFza3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgbm90ZXBhZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ub3RlcGFkJylcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9qZWN0Q29udGFpbmVyID0gbm90ZXBhZC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1wcm9qZWN0LWlkPVwiJHtwcm9qZWN0LmlkfVwiXWApO1xuICAgICAgICAgICAgICAgIHByb2plY3RDb250YWluZXIucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZSB0YXNrcyB0aGF0IGFyZSBub3QgZHVlIHRoaXMgd2VlayBmcm9tIERPTVxuICAgICAgICAgICAgY29uc3Qgbm90RHVlVGhpc1dlZWsgPSB0YXNrcy5maWx0ZXIodGFzayA9PiAhZHVlVGhpc1dlZWsodGFzaykpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBub3REdWVUaGlzV2Vlay5mb3JFYWNoKHRhc2sgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhc2tDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS10YXNrLWlkPVwiJHt0YXNrLnRhc2tJZH1cIl1gKTtcbiAgICAgICAgICAgICAgICBpZiAodGFza0NvbnRhaW5lcikgdGFza0NvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTsgICBcbiAgICAgICAgdXBkYXRlQWN0aXZlVGFiKHRhYik7XG4gICAgfVxuXG4gICAgY29uc3QgZHVlVGhpc1dlZWsgPSAodGFzaykgPT4ge1xuICAgICAgICBpZiAoaXNUaGlzV2VlayhwYXJzZUlTTyh0YXNrLmR1ZURhdGUpKSkgcmV0dXJuIHRhc2s7XG4gICAgfVxuXG4gICAgY29uc3QgbG9hZEFsbFByb2plY3RzID0gKHByb2plY3RzKSA9PiB7XG4gICAgICAgIGNsZWFyUHJvamVjdHNGcm9tRE9NKCk7XG4gICAgICAgIGNvbnN0IG5vdGVwYWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubm90ZXBhZCcpO1xuICAgICAgICBcbiAgICAgICAgcHJvamVjdHMuZm9yRWFjaChwcm9qZWN0ID0+IHtcbiAgICAgICAgICAgIGFkZFByb2plY3RUb05vdGVwYWQocHJvamVjdC5pZCk7XG5cbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RUYXNrcyA9IHByb2plY3QudGFza3M7XG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0Q29udGFpbmVyID0gbm90ZXBhZC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1wcm9qZWN0LWlkPVwiJHtwcm9qZWN0LmlkfVwiXWApO1xuICAgICAgICAgICAgY29uc3QgdGFza3NMaXN0ID0gcHJvamVjdENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCd1bCcpO1xuICAgICAgICAgICAgY29uc3QgYWRkVGFza0J0biA9IHByb2plY3RDb250YWluZXIucXVlcnlTZWxlY3RvcignLmFkZC10YXNrJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHByb2plY3RUYXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhc2tUb0FkZCA9IGxvYWRUYXNrKHRhc2spO1xuICAgICAgICAgICAgICAgIHRhc2tzTGlzdC5pbnNlcnRCZWZvcmUodGFza1RvQWRkLCBhZGRUYXNrQnRuLnBhcmVudEVsZW1lbnQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0gIFxuXG4gICAgY29uc3QgY2xlYXJQcm9qZWN0c0Zyb21ET00gPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHdyaXRpbmdBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3dyaXRpbmctYXJlYScpO1xuICAgICAgICBjb25zdCBwcm9qZWN0cyA9IHdyaXRpbmdBcmVhLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9qZWN0Jyk7XG4gICAgICAgIHByb2plY3RzLmZvckVhY2gocHJvamVjdCA9PiBwcm9qZWN0LnJlbW92ZSgpKTtcbiAgICB9XG5cbiAgICBjb25zdCBvblByb2plY3RTZWxlY3QgPSAocHJvamVjdElkKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2plY3RzID0gdXBkYXRlU3RvcmFnZS5nZXRQcm9qZWN0cygpO1xuICAgICAgICBsb2FkQWxsUHJvamVjdHMocHJvamVjdHMpO1xuICAgICAgICBjb25zdCBwcm9qZWN0T2JqZWN0ID0gcHJvamVjdHMuZmluZChwcm9qZWN0ID0+IHByb2plY3QuaWQgPT0gcHJvamVjdElkKTtcbiAgICAgICAgY29uc3Qgc2lkZWJhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzaWRlYmFyJyk7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkUHJvamVjdCA9IHNpZGViYXIucXVlcnlTZWxlY3RvcihgW2RhdGEtcHJvamVjdC1pZD0nJHtwcm9qZWN0T2JqZWN0LmlkfSddYCk7XG4gICAgICAgIGNvbnN0IHByb2plY3RzT25Ob3RlcGFkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnByb2plY3QnKTtcblxuICAgICAgICBwcm9qZWN0c09uTm90ZXBhZC5mb3JFYWNoKHByb2plY3QgPT4ge1xuICAgICAgICAgICAgaWYgKHByb2plY3QuZGF0YXNldC5wcm9qZWN0SWQgIT0gcHJvamVjdElkKSB7XG4gICAgICAgICAgICAgICAgcHJvamVjdC5yZW1vdmUoKTtcbiAgICAgICAgICAgIH0gXG4gICAgICAgIH0pO1xuICAgICAgICB1cGRhdGVBY3RpdmVUYWIoc2VsZWN0ZWRQcm9qZWN0KTtcbiAgICB9XG5cbiAgICBjb25zdCBvblByb2plY3RBZGQgPSAocHJvamVjdE5hbWUpID0+IHtcbiAgICAgICAgLy8gcGFzcyB1c2VyIGlucHV0IGludG8gZnVuY3Rpb25cbiAgICAgICAgY29uc3QgbmV3UHJvamVjdCA9ICB7XG4gICAgICAgICAgICBwcm9qZWN0TmFtZTogcHJvamVjdE5hbWUsXG4gICAgICAgICAgICB0YXNrczogW11cbiAgICAgICAgfVxuICAgICAgICB1cGRhdGVTdG9yYWdlLnNhdmVQcm9qZWN0KG5ld1Byb2plY3QpO1xuICAgICAgICAvLyBhZGQgaW5wdXQgdG8gcGFnZVxuICAgICAgICBfcmVmcmVzaFByb2plY3RMaXN0KCk7XG4gICAgICAgIGNvbnN0IG5ld1Byb2plY3RET01FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtcHJvamVjdC1pZD0nJHtuZXdQcm9qZWN0LmlkfSddYCk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IG9uVGFza0FkZCA9ICh0YXNrLCBpZCkgPT4ge1xuICAgICAgICBjb25zdCBuZXdUYXNrID0ge1xuICAgICAgICAgICAgaXRlbTogdGFzaywgXG4gICAgICAgICAgICB0YXNrSWQ6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwMDApLFxuICAgICAgICAgICAgcHJpb3JpdHk6ICdsb3cnLFxuICAgICAgICAgICAgZHVlRGF0ZTogbnVsbCxcbiAgICAgICAgICAgIGlzQ29tcGxldGU6IGZhbHNlXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcHJvamVjdHMgPSB1cGRhdGVTdG9yYWdlLmdldFByb2plY3RzKCk7XG4gICAgICAgIGNvbnN0IHByb2plY3RUb1VwZGF0ZSA9IHByb2plY3RzLmZpbmQocHJvamVjdCA9PiBwcm9qZWN0LmlkID09IGlkKTtcbiAgICAgICAgcHJvamVjdFRvVXBkYXRlLnRhc2tzLnB1c2gobmV3VGFzayk7XG4gICAgICAgIHVwZGF0ZVN0b3JhZ2Uuc2F2ZVByb2plY3QocHJvamVjdFRvVXBkYXRlKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBuZXdUYXNrO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBvblByb2plY3ROYW1lRWRpdCA9IChwcm9qZWN0SWQsIHByb2plY3ROYW1lLCB0YXNrcyA9IHVwZGF0ZVN0b3JhZ2UuZ2V0VGFza3MocHJvamVjdElkKSkgPT4ge1xuICAgICAgICB1cGRhdGVTdG9yYWdlLnNhdmVQcm9qZWN0KHtcbiAgICAgICAgICAgIGlkOiBwcm9qZWN0SWQsXG4gICAgICAgICAgICBwcm9qZWN0TmFtZTogcHJvamVjdE5hbWUsXG4gICAgICAgICAgICB0YXNrczogdGFza3NcbiAgICAgICAgfSk7XG5cbiAgICAgICAgX3JlZnJlc2hQcm9qZWN0TGlzdCgpO1xuICAgIH1cblxuICAgIGNvbnN0IG9uVGFza05hbWVFZGl0ID0gKHByb2plY3RJZCwgdGFza0lkLCBuZXdUYXNrTmFtZSkgPT4ge1xuICAgICAgICBjb25zdCBleGlzdGluZ1Rhc2sgPSB1cGRhdGVTdG9yYWdlLmZpbmRUYXNrVG9VcGRhdGUocHJvamVjdElkLCB0YXNrSWQpO1xuICAgICAgICB1cGRhdGVTdG9yYWdlLnVwZGF0ZVRhc2socHJvamVjdElkLCB7XG4gICAgICAgICAgICAgICAgaXRlbTogbmV3VGFza05hbWUsXG4gICAgICAgICAgICAgICAgdGFza0lkOiBleGlzdGluZ1Rhc2sudGFza0lkLFxuICAgICAgICAgICAgICAgIHByaW9yaXR5OiBleGlzdGluZ1Rhc2sucHJpb3JpdHksXG4gICAgICAgICAgICAgICAgZHVlRGF0ZTogZXhpc3RpbmdUYXNrLmR1ZURhdGUsXG4gICAgICAgICAgICAgICAgaXNDb21wbGV0ZTogZXhpc3RpbmdUYXNrLmlzQ29tcGxldGVcbiAgICAgICAgICAgIH0pOyAgXG4gICAgfVxuXG4gICAgY29uc3Qgb25UYXNrUHJpb3JpdHlFZGl0ID0gKHByb2plY3RJZCwgdGFza0lkLCBuZXdQcmlvcml0eSkgPT4ge1xuICAgICAgICBjb25zdCBleGlzdGluZ1Rhc2sgPSB1cGRhdGVTdG9yYWdlLmZpbmRUYXNrVG9VcGRhdGUocHJvamVjdElkLCB0YXNrSWQpO1xuICAgICAgICB1cGRhdGVTdG9yYWdlLnVwZGF0ZVRhc2socHJvamVjdElkLCB7XG4gICAgICAgICAgICAgICAgaXRlbTogZXhpc3RpbmdUYXNrLml0ZW0sXG4gICAgICAgICAgICAgICAgdGFza0lkOiBleGlzdGluZ1Rhc2sudGFza0lkLFxuICAgICAgICAgICAgICAgIHByaW9yaXR5OiBuZXdQcmlvcml0eSxcbiAgICAgICAgICAgICAgICBkdWVEYXRlOiBleGlzdGluZ1Rhc2suZHVlRGF0ZSxcbiAgICAgICAgICAgICAgICBpc0NvbXBsZXRlOiBleGlzdGluZ1Rhc2suaXNDb21wbGV0ZVxuICAgICAgICAgICAgfSk7ICBcbiAgICB9XG5cbiAgICBjb25zdCBvblRhc2tEdWVEYXRlRWRpdCA9IChwcm9qZWN0SWQsIHRhc2tJZCwgbmV3RHVlRGF0ZSkgPT4ge1xuICAgICAgICBjb25zdCBleGlzdGluZ1Rhc2sgPSB1cGRhdGVTdG9yYWdlLmZpbmRUYXNrVG9VcGRhdGUocHJvamVjdElkLCB0YXNrSWQpO1xuICAgICAgICB1cGRhdGVTdG9yYWdlLnVwZGF0ZVRhc2socHJvamVjdElkLCB7XG4gICAgICAgICAgICAgICAgaXRlbTogZXhpc3RpbmdUYXNrLml0ZW0sXG4gICAgICAgICAgICAgICAgdGFza0lkOiBleGlzdGluZ1Rhc2sudGFza0lkLFxuICAgICAgICAgICAgICAgIHByaW9yaXR5OiBleGlzdGluZ1Rhc2sucHJpb3JpdHksXG4gICAgICAgICAgICAgICAgZHVlRGF0ZTogbmV3RHVlRGF0ZSxcbiAgICAgICAgICAgICAgICBpc0NvbXBsZXRlOiBleGlzdGluZ1Rhc2suaXNDb21wbGV0ZVxuICAgICAgICAgICAgfSk7ICBcbiAgICB9XG5cbiAgICBjb25zdCBvblRhc2tDb21wbGV0ZUVkaXQgPSAocHJvamVjdElkLCB0YXNrSWQsIGlzQ29tcGxldGUpID0+IHtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdUYXNrID0gdXBkYXRlU3RvcmFnZS5maW5kVGFza1RvVXBkYXRlKHByb2plY3RJZCwgdGFza0lkKTtcbiAgICAgICAgdXBkYXRlU3RvcmFnZS51cGRhdGVUYXNrKHByb2plY3RJZCwge1xuICAgICAgICAgICAgICAgIGl0ZW06IGV4aXN0aW5nVGFzay5pdGVtLFxuICAgICAgICAgICAgICAgIHRhc2tJZDogZXhpc3RpbmdUYXNrLnRhc2tJZCxcbiAgICAgICAgICAgICAgICBwcmlvcml0eTogZXhpc3RpbmdUYXNrLnByaW9yaXR5LFxuICAgICAgICAgICAgICAgIGR1ZURhdGU6IGV4aXN0aW5nVGFzay5kdWVEYXRlLFxuICAgICAgICAgICAgICAgIGlzQ29tcGxldGU6IGlzQ29tcGxldGVcbiAgICAgICAgICAgIH0pOyAgXG4gICAgfVxuXG4gICAgcmV0dXJuIHsgb25Qcm9qZWN0U2VsZWN0LCBvblByb2plY3RBZGQsIG9uUHJvamVjdE5hbWVFZGl0LCBvblRhc2tBZGQsIG9uVGFza05hbWVFZGl0LCBvblRhc2tQcmlvcml0eUVkaXQsIG9uVGFza0R1ZURhdGVFZGl0LCBvblRhc2tDb21wbGV0ZUVkaXQsIG9uSG9tZVRhYlNlbGVjdCwgb25Ub2RheVRhYlNlbGVjdCwgb25UaGlzV2Vla1RhYlNlbGVjdCB9XG4gICAgXG59XG5cbmV4cG9ydCBkZWZhdWx0IGhhbmRsZXJzKCk7IiwiaW1wb3J0IGlzU2FtZURheSBmcm9tIFwiLi4vaXNTYW1lRGF5L2luZGV4LmpzXCI7XG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSBpc1RvZGF5XG4gKiBAY2F0ZWdvcnkgRGF5IEhlbHBlcnNcbiAqIEBzdW1tYXJ5IElzIHRoZSBnaXZlbiBkYXRlIHRvZGF5P1xuICogQHB1cmUgZmFsc2VcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIElzIHRoZSBnaXZlbiBkYXRlIHRvZGF5P1xuICpcbiAqID4g4pqg77iPIFBsZWFzZSBub3RlIHRoYXQgdGhpcyBmdW5jdGlvbiBpcyBub3QgcHJlc2VudCBpbiB0aGUgRlAgc3VibW9kdWxlIGFzXG4gKiA+IGl0IHVzZXMgYERhdGUubm93KClgIGludGVybmFsbHkgaGVuY2UgaW1wdXJlIGFuZCBjYW4ndCBiZSBzYWZlbHkgY3VycmllZC5cbiAqXG4gKiAjIyMgdjIuMC4wIGJyZWFraW5nIGNoYW5nZXM6XG4gKlxuICogLSBbQ2hhbmdlcyB0aGF0IGFyZSBjb21tb24gZm9yIHRoZSB3aG9sZSBsaWJyYXJ5XShodHRwczovL2dpdGh1Yi5jb20vZGF0ZS1mbnMvZGF0ZS1mbnMvYmxvYi9tYXN0ZXIvZG9jcy91cGdyYWRlR3VpZGUubWQjQ29tbW9uLUNoYW5nZXMpLlxuICpcbiAqIEBwYXJhbSB7RGF0ZXxOdW1iZXJ9IGRhdGUgLSB0aGUgZGF0ZSB0byBjaGVja1xuICogQHJldHVybnMge0Jvb2xlYW59IHRoZSBkYXRlIGlzIHRvZGF5XG4gKiBAdGhyb3dzIHtUeXBlRXJyb3J9IDEgYXJndW1lbnQgcmVxdWlyZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gSWYgdG9kYXkgaXMgNiBPY3RvYmVyIDIwMTQsIGlzIDYgT2N0b2JlciAxNDowMDowMCB0b2RheT9cbiAqIHZhciByZXN1bHQgPSBpc1RvZGF5KG5ldyBEYXRlKDIwMTQsIDksIDYsIDE0LCAwKSlcbiAqIC8vPT4gdHJ1ZVxuICovXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGlzVG9kYXkoZGlydHlEYXRlKSB7XG4gIHJlcXVpcmVkQXJncygxLCBhcmd1bWVudHMpO1xuICByZXR1cm4gaXNTYW1lRGF5KGRpcnR5RGF0ZSwgRGF0ZS5ub3coKSk7XG59IiwiaW1wb3J0IGlzU2FtZVdlZWsgZnJvbSBcIi4uL2lzU2FtZVdlZWsvaW5kZXguanNcIjtcbmltcG9ydCByZXF1aXJlZEFyZ3MgZnJvbSBcIi4uL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzXCI7XG5cbi8qKlxuICogQG5hbWUgaXNUaGlzV2Vla1xuICogQGNhdGVnb3J5IFdlZWsgSGVscGVyc1xuICogQHN1bW1hcnkgSXMgdGhlIGdpdmVuIGRhdGUgaW4gdGhlIHNhbWUgd2VlayBhcyB0aGUgY3VycmVudCBkYXRlP1xuICogQHB1cmUgZmFsc2VcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIElzIHRoZSBnaXZlbiBkYXRlIGluIHRoZSBzYW1lIHdlZWsgYXMgdGhlIGN1cnJlbnQgZGF0ZT9cbiAqXG4gKiA+IOKaoO+4jyBQbGVhc2Ugbm90ZSB0aGF0IHRoaXMgZnVuY3Rpb24gaXMgbm90IHByZXNlbnQgaW4gdGhlIEZQIHN1Ym1vZHVsZSBhc1xuICogPiBpdCB1c2VzIGBEYXRlLm5vdygpYCBpbnRlcm5hbGx5IGhlbmNlIGltcHVyZSBhbmQgY2FuJ3QgYmUgc2FmZWx5IGN1cnJpZWQuXG4gKlxuICogIyMjIHYyLjAuMCBicmVha2luZyBjaGFuZ2VzOlxuICpcbiAqIC0gW0NoYW5nZXMgdGhhdCBhcmUgY29tbW9uIGZvciB0aGUgd2hvbGUgbGlicmFyeV0oaHR0cHM6Ly9naXRodWIuY29tL2RhdGUtZm5zL2RhdGUtZm5zL2Jsb2IvbWFzdGVyL2RvY3MvdXBncmFkZUd1aWRlLm1kI0NvbW1vbi1DaGFuZ2VzKS5cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlIC0gdGhlIGRhdGUgdG8gY2hlY2tcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gLSB0aGUgb2JqZWN0IHdpdGggb3B0aW9uc1xuICogQHBhcmFtIHtMb2NhbGV9IFtvcHRpb25zLmxvY2FsZT1kZWZhdWx0TG9jYWxlXSAtIHRoZSBsb2NhbGUgb2JqZWN0LiBTZWUgW0xvY2FsZV17QGxpbmsgaHR0cHM6Ly9kYXRlLWZucy5vcmcvZG9jcy9Mb2NhbGV9XG4gKiBAcGFyYW0gezB8MXwyfDN8NHw1fDZ9IFtvcHRpb25zLndlZWtTdGFydHNPbj0wXSAtIHRoZSBpbmRleCBvZiB0aGUgZmlyc3QgZGF5IG9mIHRoZSB3ZWVrICgwIC0gU3VuZGF5KVxuICogQHJldHVybnMge0Jvb2xlYW59IHRoZSBkYXRlIGlzIGluIHRoaXMgd2Vla1xuICogQHRocm93cyB7VHlwZUVycm9yfSAxIGFyZ3VtZW50IHJlcXVpcmVkXG4gKiBAdGhyb3dzIHtSYW5nZUVycm9yfSBgb3B0aW9ucy53ZWVrU3RhcnRzT25gIG11c3QgYmUgYmV0d2VlbiAwIGFuZCA2XG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIElmIHRvZGF5IGlzIDI1IFNlcHRlbWJlciAyMDE0LCBpcyAyMSBTZXB0ZW1iZXIgMjAxNCBpbiB0aGlzIHdlZWs/XG4gKiB2YXIgcmVzdWx0ID0gaXNUaGlzV2VlayhuZXcgRGF0ZSgyMDE0LCA4LCAyMSkpXG4gKiAvLz0+IHRydWVcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gSWYgdG9kYXkgaXMgMjUgU2VwdGVtYmVyIDIwMTQgYW5kIHdlZWsgc3RhcnRzIHdpdGggTW9uZGF5XG4gKiAvLyBpcyAyMSBTZXB0ZW1iZXIgMjAxNCBpbiB0aGlzIHdlZWs/XG4gKiB2YXIgcmVzdWx0ID0gaXNUaGlzV2VlayhuZXcgRGF0ZSgyMDE0LCA4LCAyMSksIHsgd2Vla1N0YXJ0c09uOiAxIH0pXG4gKiAvLz0+IGZhbHNlXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGlzVGhpc1dlZWsoZGlydHlEYXRlLCBvcHRpb25zKSB7XG4gIHJlcXVpcmVkQXJncygxLCBhcmd1bWVudHMpO1xuICByZXR1cm4gaXNTYW1lV2VlayhkaXJ0eURhdGUsIERhdGUubm93KCksIG9wdGlvbnMpO1xufSIsImltcG9ydCBoYW5kbGVycyBmcm9tIFwiLi9oYW5kbGVyc1wiXG5pbXBvcnQgdXBkYXRlU3RvcmFnZSBmcm9tIFwiLi9zdG9yYWdlXCI7XG5cbi8vIERPTSBFbGVtZW50cyBGYWN0b3J5IEZ1bmN0aW9uXG5jb25zdCBjcmVhdGVFbGVtZW50cyA9ICgpID0+IHtcbiAgICBcbiAgICBjb25zdCBjcmVhdGVMaXN0RWxlbWVudCA9IChodG1sQ2xhc3MpID0+IHtcbiAgICAgICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgICAgICBsaS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgaHRtbENsYXNzKTtcbiAgICAgICAgcmV0dXJuIGxpO1xuICAgIH1cblxuICAgIGNvbnN0IGNyZWF0ZVNwYW5FbGVtZW50ID0gKGh0bWxDbGFzcykgPT4ge1xuICAgICAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBzcGFuLmNsYXNzTGlzdC5hZGQoaHRtbENsYXNzKTtcbiAgICAgICAgcmV0dXJuIHNwYW47XG4gICAgfVxuXG4gICAgY29uc3QgY3JlYXRlSW1hZ2VFbGVtZW50ID0gKHNyYywgaHRtbENsYXNzKSA9PiB7XG4gICAgICAgIGNvbnN0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgICAgICBpbWcuY2xhc3NMaXN0LmFkZChodG1sQ2xhc3MpO1xuICAgICAgICBpbWcuc2V0QXR0cmlidXRlKCdzcmMnLCBzcmMpO1xuICAgICAgICBpbWcuc2V0QXR0cmlidXRlKCdkcmFnZ2FibGUnLCAnZmFsc2UnKTtcbiAgICAgICAgcmV0dXJuIGltZztcbiAgICB9XG4gICAgXG4gICAgY29uc3QgY3JlYXRlRm9ybSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgaW5wdXRGb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpO1xuICAgICAgICByZXR1cm4gaW5wdXRGb3JtO1xuICAgIH1cblxuICAgIGNvbnN0IGNyZWF0ZUlucHV0RmllbGQgPSAocGxhY2Vob2xkZXJUZXh0KSA9PiB7XG4gICAgICAgIGNvbnN0IHVzZXJJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICAgIHVzZXJJbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dCcpO1xuICAgICAgICB1c2VySW5wdXQuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsIHBsYWNlaG9sZGVyVGV4dCk7XG4gICAgICAgIHVzZXJJbnB1dC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3VzZXItaW5wdXQnKTtcbiAgICAgICAgdXNlcklucHV0LnJlcXVpcmVkID0gdHJ1ZTtcblxuICAgICAgICByZXR1cm4gdXNlcklucHV0O1xuICAgIH1cblxuICAgIGNvbnN0IGNyZWF0ZURpdiA9IChodG1sQ2xhc3MpID0+IHtcbiAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgaHRtbENsYXNzKTtcbiAgICAgICAgcmV0dXJuIGRpdjtcbiAgICB9XG5cbiAgICByZXR1cm4ge2NyZWF0ZUxpc3RFbGVtZW50LCBjcmVhdGVTcGFuRWxlbWVudCwgY3JlYXRlSW1hZ2VFbGVtZW50LCBjcmVhdGVJbnB1dEZpZWxkLCBjcmVhdGVGb3JtLCBjcmVhdGVEaXZ9XG59XG5cbmNvbnN0IGNyZWF0ZUljb25TcGFuID0gKCkgPT4ge1xuICAgIGNvbnN0IHZpZXcgPSBjcmVhdGVFbGVtZW50cygpO1xuXG4gICAgY29uc3QgaWNvblNwYW4gPSB2aWV3LmNyZWF0ZVNwYW5FbGVtZW50KCdpY29ucycpO1xuICAgIGNvbnN0IGVkaXRJY29uID0gdmlldy5jcmVhdGVJbWFnZUVsZW1lbnQoJ2ltYWdlcy9lZGl0LWljb24uc3ZnJywgJ2VkaXQtaWNvbicpO1xuICAgIGNvbnN0IGRlbGV0ZUljb24gPSB2aWV3LmNyZWF0ZUltYWdlRWxlbWVudCgnaW1hZ2VzL2RlbGV0ZS1pY29uLnN2ZycsICdkZWxldGUtaWNvbicpO1xuICAgIFxuICAgIGVkaXRJY29uLmNsYXNzTGlzdC5hZGQoJ2VkaXQtcHJvamVjdCcpO1xuICAgIGRlbGV0ZUljb24uY2xhc3NMaXN0LmFkZCgnZGVsZXRlLXByb2plY3QnKTtcbiAgICBcbiAgICBpY29uU3Bhbi5hcHBlbmQoZWRpdEljb24sIGRlbGV0ZUljb24pO1xuICAgIFxuICAgIHJldHVybiBpY29uU3Bhbjtcbn1cblxuY29uc3QgYWRkUHJvamVjdFRvU2lkZWJhciA9ICgpID0+IHtcbiAgICBjb25zdCB2aWV3ID0gY3JlYXRlRWxlbWVudHMoKTtcbiAgICBjb25zdCBwcm9qZWN0c0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LWxpc3QnKTtcblxuICAgIGNvbnN0IHByb2plY3RMaXN0RWxlbWVudCA9ICB2aWV3LmNyZWF0ZUxpc3RFbGVtZW50KCdwcm9qZWN0LWl0ZW0nKTtcbiAgICBcbiAgICBjb25zdCBwcm9qZWN0SW5wdXRGb3JtID0gdmlldy5jcmVhdGVGb3JtKCk7XG4gICAgY29uc3QgcHJvamVjdE5hbWVJbnB1dCA9IHZpZXcuY3JlYXRlSW5wdXRGaWVsZCgnUHJvamVjdCBuYW1lLi4uJyk7XG4gICAgcHJvamVjdElucHV0Rm9ybS5hcHBlbmQocHJvamVjdE5hbWVJbnB1dCk7XG5cbiAgICBjb25zdCBpY29uU3BhbiA9IGNyZWF0ZUljb25TcGFuKCk7XG4gICAgcHJvamVjdExpc3RFbGVtZW50LmFwcGVuZChwcm9qZWN0SW5wdXRGb3JtLCBpY29uU3Bhbik7XG4gICAgcHJvamVjdHNDb250YWluZXIuaW5zZXJ0QmVmb3JlKHByb2plY3RMaXN0RWxlbWVudCwgcHJvamVjdHNDb250YWluZXIubGFzdEVsZW1lbnRDaGlsZCk7XG5cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgcHJvamVjdE5hbWVJbnB1dC5mb2N1cygpO1xuICAgIH0sIDApO1xufVxuXG5jb25zdCBhZGRQcm9qZWN0VG9Ob3RlcGFkID0gKHByb2plY3RJZCkgPT4ge1xuICAgIGNvbnN0IHZpZXcgPSBjcmVhdGVFbGVtZW50cygpO1xuXG4gICAgY29uc3QgcHJvamVjdHMgPSB1cGRhdGVTdG9yYWdlLmdldFByb2plY3RzKCk7XG4gICAgY29uc3QgcHJvamVjdFRvQWRkID0gcHJvamVjdHMuZmluZChwcm9qZWN0ID0+IHByb2plY3QuaWQgPT0gcHJvamVjdElkKTtcbiAgICBjb25zdCBwcm9qZWN0TmFtZSA9IHByb2plY3RUb0FkZC5wcm9qZWN0TmFtZTtcblxuICAgIGNvbnN0IG5vdGVwYWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjd3JpdGluZy1hcmVhJyk7XG4gICAgY29uc3QgcHJvamVjdERpdiA9IHZpZXcuY3JlYXRlRGl2KCdwcm9qZWN0Jyk7XG4gICAgcHJvamVjdERpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvamVjdC1pZCcsIHByb2plY3RJZCk7XG4gICAgY29uc3Qgc2tpcExpbmUgPSB2aWV3LmNyZWF0ZURpdignc2tpcC1saW5lJyk7XG4gICAgXG4gICAgY29uc3QgcHJvamVjdEhlYWRpbmcgPSB2aWV3LmNyZWF0ZURpdigncHJvamVjdC1oZWFkaW5nJyk7XG4gICAgY29uc3QgaDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xuICAgIGgyLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnbm90ZXBhZC10ZXh0Jyk7XG4gICAgaDIudGV4dENvbnRlbnQgPSBwcm9qZWN0TmFtZTtcbiAgICBjb25zdCBoMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XG4gICAgaDMuc2V0QXR0cmlidXRlKCdjbGFzcycsICdub3RlcGFkLXRleHQnKTtcbiAgICBoMy50ZXh0Q29udGVudCA9ICdEdWUgRGF0ZSc7XG4gICAgICAgIFxuICAgIGNvbnN0IHRhc2tzQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcbiAgICB0YXNrc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdub3RlcGFkLXRleHQnLCAndG9kb3MnKTtcblxuICAgIGNvbnN0IGFkZFRhc2tMaXN0RWxlbWVudCA9IHZpZXcuY3JlYXRlTGlzdEVsZW1lbnQoJ3Rhc2snKTtcbiAgICBjb25zdCBhZGRUYXNrU3BhbiA9IHZpZXcuY3JlYXRlU3BhbkVsZW1lbnQoJ2FkZC10YXNrJyk7XG4gICAgY29uc3QgYWRkSWNvbiA9IHZpZXcuY3JlYXRlSW1hZ2VFbGVtZW50KCdpbWFnZXMvYWRkLWljb24uc3ZnJywgJ2FkZC1pY29uJyk7XG4gICAgYWRkVGFza1NwYW4uYXBwZW5kKGFkZEljb24sICdBZGQgVGFzaycpO1xuXG4gICAgYWRkVGFza0xpc3RFbGVtZW50LmFwcGVuZChhZGRUYXNrU3Bhbik7XG4gICAgdGFza3NDb250YWluZXIuYXBwZW5kKGFkZFRhc2tMaXN0RWxlbWVudCwgc2tpcExpbmUpO1xuICAgIHByb2plY3RIZWFkaW5nLmFwcGVuZChoMiwgaDMpO1xuICAgIHByb2plY3REaXYuYXBwZW5kKHByb2plY3RIZWFkaW5nLCB0YXNrc0NvbnRhaW5lcik7XG4gICAgbm90ZXBhZC5hcHBlbmQocHJvamVjdERpdik7XG59XG5cbmNvbnN0IGFkZER1ZURhdGVUb0RPTSA9ICgpID0+IHtcbiAgICBjb25zdCBkdWVEYXRlU3BhbiA9IGNyZWF0ZUVsZW1lbnRzKCkuY3JlYXRlU3BhbkVsZW1lbnQoJ2R1ZS1kYXRlJyk7XG5cbiAgICBjb25zdCBwcmlvcml0eUljb24gPSBjcmVhdGVFbGVtZW50cygpLmNyZWF0ZUltYWdlRWxlbWVudCgnaW1hZ2VzL3ByaW9yaXR5LWljb24uc3ZnJywgJ3ByaW9yaXR5LWljb24nKVxuICAgIHByaW9yaXR5SWNvbi5jbGFzc0xpc3QuYWRkKCdwcmlvcml0eS1sb3cnKTtcbiAgICBcbiAgICBjb25zdCBkYXRlTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xuICAgIGRhdGVMYWJlbC5jbGFzc0xpc3QuYWRkKCdkYXRlLWxhYmVsJyk7XG4gICAgXG4gICAgY29uc3QgZGF0ZUlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICBkYXRlSW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2RhdGUnKTtcbiAgICBkYXRlSW5wdXQucmVxdWlyZWQgPSB0cnVlO1xuXG4gICAgY29uc3QgY2FsZW5kYXJJY29uID0gY3JlYXRlRWxlbWVudHMoKS5jcmVhdGVJbWFnZUVsZW1lbnQoJ2ltYWdlcy9jYWxlbmRhci1pY29uLnN2ZycsICdjYWxlbmRhci1pY29uJyk7XG5cbiAgICBkYXRlTGFiZWwuYXBwZW5kKGRhdGVJbnB1dCwgY2FsZW5kYXJJY29uKTtcbiAgICBkdWVEYXRlU3Bhbi5hcHBlbmQocHJpb3JpdHlJY29uLCBkYXRlTGFiZWwpO1xuICAgIFxuICAgIC8vIHVwZGF0ZSBsb2NhbFN0b3JhZ2Ugb24gZHVlIGRhdGUgY2hhbmdlXG4gICAgZGF0ZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgY29uc3QgcHJvamVjdElkID0gZGF0ZUlucHV0LmNsb3Nlc3QoJy5wcm9qZWN0JykuZGF0YXNldC5wcm9qZWN0SWQ7XG4gICAgICAgIGNvbnN0IHRhc2tJZCA9IGRhdGVJbnB1dC5jbG9zZXN0KCdbZGF0YS10YXNrLWlkXScpLmRhdGFzZXQudGFza0lkO1xuICAgICAgICBjb25zdCBuZXdEdWVEYXRlID0gZGF0ZUlucHV0LnZhbHVlO1xuXG4gICAgICAgIHJldHVybiBoYW5kbGVycy5vblRhc2tEdWVEYXRlRWRpdChwcm9qZWN0SWQsIHRhc2tJZCwgbmV3RHVlRGF0ZSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZHVlRGF0ZVNwYW47XG59XG5cbi8vIGNyZWF0ZXMgSFRNTCBmb3IgcHJvamVjdCBpdGVtcyBpbiBzaWRlYmFyIGZyb20gbG9jYWxTdG9yYWdlIGl0ZW1cbmNvbnN0IF9jcmVhdGVQcm9qZWN0SXRlbUhUTUwgPSAoaWQsIG5hbWUpID0+IHtcbiAgICBjb25zdCB2aWV3ID0gY3JlYXRlRWxlbWVudHMoKTtcblxuICAgIGNvbnN0IHByb2plY3RJdGVtID0gdmlldy5jcmVhdGVMaXN0RWxlbWVudCgncHJvamVjdC1pdGVtJyk7XG4gICAgcHJvamVjdEl0ZW0uc2V0QXR0cmlidXRlKCdkYXRhLXByb2plY3QtaWQnLCBpZCk7XG4gICAgY29uc3QgcHJvamVjdE5hbWUgPSB2aWV3LmNyZWF0ZVNwYW5FbGVtZW50KCdwcm9qZWN0LW5hbWUnKTtcbiAgICBwcm9qZWN0TmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgY29uc3QgaWNvblNwYW4gPSBjcmVhdGVJY29uU3BhbigpO1xuXG4gICAgcHJvamVjdEl0ZW0uYXBwZW5kKHByb2plY3ROYW1lLCBpY29uU3Bhbik7XG5cbiAgICByZXR1cm4gcHJvamVjdEl0ZW07XG59XG4vLyBVcGRhdGVzIHByb2plY3QgbGlzdCBpbiB0aGUgc2lkZWJhciBcbmNvbnN0IHVwZGF0ZVByb2plY3RMaXN0ID0gKHByb2plY3RzKSA9PiB7XG4gICAgY29uc3QgcHJvamVjdHNMaXN0Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtbGlzdCcpO1xuICAgIGNvbnN0IGFkZFByb2plY3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1hZGQtcHJvamVjdF0nKTtcbiAgICBcbiAgICAvLyBDbGVhciBhbGwgZWxlbWVudHMgb2YgY2xhc3MgJy5wcm9qZWN0LWl0ZW0nXG4gICAgY29uc3QgcHJvamVjdHNBcnJheSA9IFtdLnNsaWNlLmNhbGwocHJvamVjdHNMaXN0Q29udGFpbmVyLmNoaWxkcmVuKTtcbiAgICBwcm9qZWN0c0FycmF5LmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucygncHJvamVjdC1pdGVtJykpIGl0ZW0ucmVtb3ZlKCk7XG4gICAgfSk7XG5cbiAgICBmb3IgKGNvbnN0IHByb2plY3Qgb2YgcHJvamVjdHMpIHtcbiAgICAgICAgY29uc3QgaHRtbCA9IF9jcmVhdGVQcm9qZWN0SXRlbUhUTUwocHJvamVjdC5pZCwgcHJvamVjdC5wcm9qZWN0TmFtZSk7XG4gICAgICAgIHByb2plY3RzTGlzdENvbnRhaW5lci5pbnNlcnRCZWZvcmUoaHRtbCwgYWRkUHJvamVjdEJ0bik7XG4gICAgfVxuXG4gICAgLy8gQWRkIGxpc3RlbmVycyBmb3IgZWRpdCwgZGVsZXRlID8/Pz9cbiAgICBwcm9qZWN0c0xpc3RDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnByb2plY3QtaXRlbScpLmZvckVhY2gocHJvamVjdEl0ZW0gPT4ge1xuICAgICAgICBwcm9qZWN0SXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB1c2VySW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdXNlci1pbnB1dCcpO1xuICAgICAgICAgICAgaWYgKGUudGFyZ2V0Lm5vZGVOYW1lID09PSAnSU1HJyB8fCB1c2VySW5wdXQpIHJldHVybjtcbiAgICAgICAgICAgIGhhbmRsZXJzLm9uUHJvamVjdFNlbGVjdChwcm9qZWN0SXRlbS5kYXRhc2V0LnByb2plY3RJZCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuXG5jb25zdCBsb2FkVGFzayA9ICAodGFza09iaikgPT4ge1xuICAgIGNvbnN0IHZpZXcgPSBjcmVhdGVFbGVtZW50cygpO1xuXG4gICAgY29uc3QgdGFzayA9IHZpZXcuY3JlYXRlTGlzdEVsZW1lbnQoJ3Rhc2snKTtcbiAgICB0YXNrLnNldEF0dHJpYnV0ZSgnZGF0YS10YXNrLWlkJywgdGFza09iai50YXNrSWQpO1xuXG4gICAgY29uc3QgdGFza0l0ZW0gPSB2aWV3LmNyZWF0ZVNwYW5FbGVtZW50KCd0YXNrLWl0ZW0nKTtcbiAgICBcbiAgICBjb25zdCB0YXNrTmFtZVNwYW4gPSB2aWV3LmNyZWF0ZVNwYW5FbGVtZW50KCd0YXNrLXRleHQnKTtcbiAgICB0YXNrTmFtZVNwYW4udGV4dENvbnRlbnQgPSB0YXNrT2JqLml0ZW07XG4gICAgXG4gICAgY29uc3QgaWNvblNwYW4gPSBjcmVhdGVJY29uU3BhbigpO1xuICAgIHRhc2tJdGVtLmFwcGVuZCh0YXNrTmFtZVNwYW4sIGljb25TcGFuKTtcbiAgIFxuICAgIGNvbnN0IGR1ZURhdGVTcGFuID0gYWRkRHVlRGF0ZVRvRE9NKCk7XG5cbiAgICBjb25zdCBwcmlvcml0eUljb24gPSBkdWVEYXRlU3Bhbi5xdWVyeVNlbGVjdG9yKCcucHJpb3JpdHktaWNvbicpO1xuICAgIHByaW9yaXR5SWNvbi5jbGFzc0xpc3QuYWRkKGBwcmlvcml0eS0ke3Rhc2tPYmoucHJpb3JpdHl9YCk7XG4gICAgXG4gICAgY29uc3QgZGF0ZUlucHV0ID0gZHVlRGF0ZVNwYW4ucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcbiAgICBkYXRlSW5wdXQudmFsdWUgPSB0YXNrT2JqLmR1ZURhdGU7XG4gIFxuICAgIGlmICh0YXNrT2JqLmlzQ29tcGxldGUpIHRhc2suY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7XG5cbiAgICB0YXNrLmFwcGVuZCh0YXNrSXRlbSwgZHVlRGF0ZVNwYW4pO1xuXG4gICAgcmV0dXJuIHRhc2s7XG59XG5cbmNvbnN0IHVwZGF0ZUFjdGl2ZVRhYiA9ICh0YWIpID0+IHtcbiAgICAvLyBmb3IgYWxsIG90aGVyIHByb2plY3RzLCBjaGFuZ2UgZGlzcGxheSB0byBub25lLCB0byBicmluZyBiYWNrIHNldCBkaXNwbGF5IHRvIGNvbnRlbnRzICBcbiAgICAgICAgLy8gaXRlbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXG4gICAgLy8gcmVtb3ZlIGFjdGl2ZSBjbGFzcyBmcm9tIGFueSBvdGhlciBzaWRlYmFyIGVsZW1lbnRcbiAgICBjb25zdCBjdXJyZW50QWN0aXZlVGFiID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFjdGl2ZScpO1xuICAgIGlmIChjdXJyZW50QWN0aXZlVGFiKSBjdXJyZW50QWN0aXZlVGFiLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgIHRhYi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICBjb25zdCBwcm9qZWN0TmFtZVNwYW4gPSB0YWIuY2hpbGRyZW4uaXRlbSgwKTsgLy8gVXBkYXRlIG5vdGVwYWQgaGVyZT9cbiAgICAvL2NvbnNvbGUubG9nKHByb2plY3ROYW1lU3Bhbik7XG59XG5cbmV4cG9ydCB7IGFkZFByb2plY3RUb1NpZGViYXIsIGFkZFByb2plY3RUb05vdGVwYWQsIGFkZER1ZURhdGVUb0RPTSwgY3JlYXRlRWxlbWVudHMsIHVwZGF0ZVByb2plY3RMaXN0LCB1cGRhdGVBY3RpdmVUYWIsIGxvYWRUYXNrIH07IiwiaW1wb3J0IHsgYWRkUHJvamVjdFRvU2lkZWJhciwgYWRkUHJvamVjdFRvTm90ZXBhZCwgY3JlYXRlRWxlbWVudHMgfSBmcm9tIFwiLi9jcmVhdGVET01FbGVtZW50c1wiO1xuaW1wb3J0IGhhbmRsZXJzIGZyb20gXCIuL2hhbmRsZXJzXCI7XG5pbXBvcnQgdXBkYXRlU3RvcmFnZSBmcm9tIFwiLi9zdG9yYWdlXCJcblxuY29uc3QgYXdhaXRpbmdJbnB1dCA9ICgpID0+IHtcbiAgICBjb25zdCB1c2VySW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdXNlci1pbnB1dCcpO1xuICAgIGlmICh1c2VySW5wdXQgIT0gbnVsbCkgcmV0dXJuIHRydWU7XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbmNvbnN0IGhhbmRsZVVzZXJJbnB1dCA9ICgpID0+IHsgXG4gICAgLy8gVGhpcyBpcyBET00gU3R1ZmZcbiAgICBjb25zdCB1c2VySW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdXNlci1pbnB1dCcpXG4gICAgY29uc3QgaW5wdXRGb3JtID0gdXNlcklucHV0LnBhcmVudEVsZW1lbnQ7XG4gICAgY29uc3QgcHJvamVjdEl0ZW0gPSBpbnB1dEZvcm0ucGFyZW50RWxlbWVudDtcbiAgICBjb25zdCBwcm9qZWN0U3BhbiA9IGNyZWF0ZUVsZW1lbnRzKCkuY3JlYXRlU3BhbkVsZW1lbnQoJ3Byb2plY3QtbmFtZScpO1xuICAgIFxuICAgIGNvbnN0IHByb2plY3ROYW1lID0gdXNlcklucHV0LnZhbHVlLnRyaW0oKTtcbiAgICBpZiAoIXByb2plY3ROYW1lKSByZXR1cm47XG5cbiAgICBwcm9qZWN0U3Bhbi50ZXh0Q29udGVudCA9IHByb2plY3ROYW1lO1xuICAgIHVzZXJJbnB1dC5wYXJlbnRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHByb2plY3RJdGVtLmluc2VydEJlZm9yZShwcm9qZWN0U3BhbiwgcHJvamVjdEl0ZW0uY2hpbGROb2Rlc1swXSk7IFxufVxuXG5jb25zdCBhZGRQcm9qZWN0ID0gKCkgPT4ge1xuICAgIGlmIChhd2FpdGluZ0lucHV0KCkpIHJldHVybjtcbiAgICBhZGRQcm9qZWN0VG9TaWRlYmFyKCk7XG4gICAgXG4gICAgY29uc3QgdXNlcklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3VzZXItaW5wdXQnKTtcbiAgICBjb25zdCBpbnB1dEZvcm0gPSB1c2VySW5wdXQucGFyZW50RWxlbWVudDtcbiAgICBjb25zdCBwcm9qZWN0SXRlbSA9IGlucHV0Rm9ybS5wYXJlbnRFbGVtZW50O1xuXG4gICAgdXNlcklucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh1c2VySW5wdXQudmFsdWUudHJpbSgpID09ICcnKSB7XG4gICAgICAgICAgICBwcm9qZWN0SXRlbS5yZW1vdmUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBoYW5kbGVVc2VySW5wdXQoKTtcblxuICAgICAgICBjb25zdCBwcm9qZWN0TmFtZSA9IHByb2plY3RJdGVtLmZpcnN0RWxlbWVudENoaWxkLnRleHRDb250ZW50O1xuICAgICAgICBoYW5kbGVycy5vblByb2plY3RBZGQocHJvamVjdE5hbWUpOyBcblxuICAgICAgICBjb25zdCBwcm9qZWN0TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LWxpc3QnKTtcbiAgICAgICAgLy8gU2VsZWN0IGxhc3QgcHJvamVjdCBhZGRlZCBhbmQgZ2V0IGlkIGF0dHJpYnV0ZVxuICAgICAgICBjb25zdCBwcm9qZWN0SWQgPSBwcm9qZWN0TGlzdC5jaGlsZHJlbltwcm9qZWN0TGlzdC5jaGlsZEVsZW1lbnRDb3VudCAtIDJdLmdldEF0dHJpYnV0ZSgnZGF0YS1wcm9qZWN0LWlkJyk7XG4gICAgICAgIGlmICghYXdhaXRpbmdJbnB1dCgpKSBhZGRQcm9qZWN0VG9Ob3RlcGFkKHByb2plY3RJZCk7XG4gICAgfSk7XG5cbiAgICBpbnB1dEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBoYW5kbGVVc2VySW5wdXQoKTtcbiAgICAgICAgY29uc3QgcHJvamVjdE5hbWUgPSBwcm9qZWN0SXRlbS5maXJzdEVsZW1lbnRDaGlsZC50ZXh0Q29udGVudDtcbiAgICAgICAgaGFuZGxlcnMub25Qcm9qZWN0QWRkKHByb2plY3ROYW1lKTsgXG4gICAgICAgIGNvbnN0IHByb2plY3RMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtbGlzdCcpO1xuICAgICAgICBjb25zdCBwcm9qZWN0SWQgPSBwcm9qZWN0TGlzdC5jaGlsZHJlbltwcm9qZWN0TGlzdC5jaGlsZEVsZW1lbnRDb3VudCAtIDJdLmdldEF0dHJpYnV0ZSgnZGF0YS1wcm9qZWN0LWlkJyk7XG4gICAgICAgIGlmICghYXdhaXRpbmdJbnB1dCgpKSBhZGRQcm9qZWN0VG9Ob3RlcGFkKHByb2plY3RJZCk7XG4gICAgfSk7XG59XG5cbmNvbnN0IGRlbGV0ZVByb2plY3QgPSAoKSA9PiB7XG4gICAgY29uc3QgcHJvamVjdExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1saXN0Jyk7XG4gICAgcHJvamVjdExpc3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBpZiAoZS50YXJnZXQuY2xvc2VzdCgnLmRlbGV0ZS1wcm9qZWN0JykpIHtcbiAgICAgICAgICAgIGNvbnN0IGRvRGVsZXRlID0gY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIHByb2plY3QgYW5kIGFsbCBpdHMgdGFza3M/IFRoaXMgYWN0aW9uIGNhbm5vdCBiZSB1bmRvbmUuJyk7XG4gICAgICAgICAgICBpZiAoIWRvRGVsZXRlKSByZXR1cm47XG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0SWQgPSBlLnRhcmdldC5jbG9zZXN0KCdbZGF0YS1wcm9qZWN0LWlkXScpLmRhdGFzZXQucHJvamVjdElkO1xuICAgICAgICAgICAgY29uc3QgcHJvamVjdEVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgW2RhdGEtcHJvamVjdC1pZD1cIiR7cHJvamVjdElkfVwiXWApO1xuICAgICAgICAgICAgcHJvamVjdEVsZW1lbnRzLmZvckVhY2goZWxlbWVudCA9PiBlbGVtZW50LnJlbW92ZSgpKTtcbiAgICAgICAgICAgIHVwZGF0ZVN0b3JhZ2UuZGVsZXRlUHJvamVjdChwcm9qZWN0SWQpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG4gXG5jb25zdCBlZGl0UHJvamVjdCA9IChlKSA9PiB7XG4gICAgaWYgKGF3YWl0aW5nSW5wdXQoKSkgcmV0dXJuO1xuICAgIFxuICAgIC8vIFRoaXMgaXMgRE9NIFN0dWZmXG4gICAgY29uc3QgaW5wdXRGb3JtID0gY3JlYXRlRWxlbWVudHMoKS5jcmVhdGVGb3JtKCk7XG4gICAgY29uc3QgaW5wdXRGaWVsZCA9IGNyZWF0ZUVsZW1lbnRzKCkuY3JlYXRlSW5wdXRGaWVsZCgnUHJvamVjdCBuYW1lLi4uJyk7XG4gICAgY29uc3QgcHJvamVjdE5hbWUgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG5cbiAgICBpbnB1dEZpZWxkLnZhbHVlID0gcHJvamVjdE5hbWUudGV4dENvbnRlbnQ7XG4gICAgcHJvamVjdE5hbWUucmVtb3ZlKCk7XG4gICAgaW5wdXRGb3JtLmFwcGVuZChpbnB1dEZpZWxkKTtcbiAgICBcbiAgICBjb25zdCBwcm9qZWN0SXRlbSA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5wcm9qZWN0LWl0ZW0nKTtcbiAgICBwcm9qZWN0SXRlbS5pbnNlcnRCZWZvcmUoaW5wdXRGb3JtLCBwcm9qZWN0SXRlbS5jaGlsZE5vZGVzWzBdKTtcbiAgICBcbiAgICBjb25zdCB1c2VySW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdXNlci1pbnB1dCcpO1xuICAgIHVzZXJJbnB1dC5mb2N1cygpO1xuICAgIFxuICAgIGNvbnN0IHByb2plY3RJZCA9IHByb2plY3RJdGVtLmRhdGFzZXQucHJvamVjdElkO1xuXG4gICAgdXNlcklucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh1c2VySW5wdXQudmFsdWUgIT0gJycpIGhhbmRsZVVzZXJJbnB1dCgpO1xuICAgICAgICBjb25zdCBwcm9qZWN0TmFtZSA9IHByb2plY3RJdGVtLmZpcnN0RWxlbWVudENoaWxkLnRleHRDb250ZW50O1xuICAgICAgICB1cGRhdGVOYW1lT25Ob3RlcGFkKHByb2plY3RJZCwgcHJvamVjdE5hbWUpO1xuICAgICAgICBoYW5kbGVycy5vblByb2plY3ROYW1lRWRpdChwcm9qZWN0SWQsIHByb2plY3ROYW1lKTtcbiAgICB9KTtcblxuICAgIGlucHV0Rm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGhhbmRsZVVzZXJJbnB1dCgpO1xuICAgICAgICBjb25zdCBwcm9qZWN0TmFtZSA9IHByb2plY3RJdGVtLmZpcnN0RWxlbWVudENoaWxkLnRleHRDb250ZW50O1xuICAgICAgICB1cGRhdGVOYW1lT25Ob3RlcGFkKHByb2plY3RJZCwgcHJvamVjdE5hbWUpO1xuICAgICAgICBoYW5kbGVycy5vblByb2plY3ROYW1lRWRpdChwcm9qZWN0SWQsIHByb2plY3ROYW1lKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHVwZGF0ZU5hbWVPbk5vdGVwYWQgPSAocHJvamVjdElkLCBwcm9qZWN0TmFtZSkgPT4ge1xuICAgICAgICBjb25zdCBub3RlcGFkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5vdGVwYWQnKTtcbiAgICAgICAgY29uc3QgcHJvamVjdFRhc2tzQ29udGFpbmVyID0gbm90ZXBhZC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1wcm9qZWN0LWlkPVwiJHtwcm9qZWN0SWR9XCJdYCk7XG4gICAgICAgIGlmIChwcm9qZWN0VGFza3NDb250YWluZXIpIHtcbiAgICAgICAgICAgIHByb2plY3RUYXNrc0NvbnRhaW5lci5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMF0udGV4dENvbnRlbnQgPSBwcm9qZWN0TmFtZTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgXG4gICAgYWRkUHJvamVjdCxcbiAgICBkZWxldGVQcm9qZWN0LFxuICAgIGVkaXRQcm9qZWN0XG59IiwiaW1wb3J0IHtjcmVhdGVFbGVtZW50cywgYWRkRHVlRGF0ZVRvRE9NfSBmcm9tIFwiLi9jcmVhdGVET01FbGVtZW50c1wiO1xuaW1wb3J0IHtmb3JtYXR9IGZyb20gXCJkYXRlLWZuc1wiO1xuaW1wb3J0IGhhbmRsZXJzIGZyb20gXCIuL2hhbmRsZXJzXCI7XG5pbXBvcnQgdXBkYXRlU3RvcmFnZSBmcm9tIFwiLi9zdG9yYWdlXCI7XG5cbmNvbnN0IHRvZ2dsZVRhc2sgPSAodGFza0VsZW1lbnQpID0+IHtcbiAgICB0YXNrRWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdjb21wbGV0ZWQnKTtcbiAgICBsZXQgaXNDb21wbGV0ZSA9IGZhbHNlO1xuXG4gICAgaWYgKHRhc2tFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnY29tcGxldGVkJykpIHtcbiAgICAgICAgaXNDb21wbGV0ZSA9IHRydWU7XG4gICAgfVxuICAgIGNvbnN0IHByb2plY3RJZCA9IHRhc2tFbGVtZW50LmNsb3Nlc3QoJy5wcm9qZWN0JykuZGF0YXNldC5wcm9qZWN0SWQ7XG4gICAgY29uc3QgdGFza0lkID0gdGFza0VsZW1lbnQuZGF0YXNldC50YXNrSWQ7XG5cbiAgICByZXR1cm4gaGFuZGxlcnMub25UYXNrQ29tcGxldGVFZGl0KHByb2plY3RJZCwgdGFza0lkLCBpc0NvbXBsZXRlKTtcbn1cblxuY29uc3QgYWRkVGFza1RvRE9NID0gKGFkZFRhc2tCdG4pID0+IHtcbiAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXItaW5wdXQnKSkgcmV0dXJuO1xuICAgIGNvbnN0IHRhc2tMaXN0RWxlbWVudCA9IGNyZWF0ZUVsZW1lbnRzKCkuY3JlYXRlTGlzdEVsZW1lbnQoJ3Rhc2snKTtcbiAgICBjb25zdCB0YXNrU3BhbiA9IGNyZWF0ZUVsZW1lbnRzKCkuY3JlYXRlU3BhbkVsZW1lbnQoJ3Rhc2staXRlbScpO1xuICAgIGNvbnN0IGlucHV0Rm9ybSA9IGNyZWF0ZUVsZW1lbnRzKCkuY3JlYXRlRm9ybSgpO1xuICAgIGNvbnN0IGlucHV0RmllbGQgPSBjcmVhdGVFbGVtZW50cygpLmNyZWF0ZUlucHV0RmllbGQoJ0VudGVyIFRhc2suLi4nKTtcbiAgICBcbiAgICBpbnB1dEZvcm0uYXBwZW5kKGlucHV0RmllbGQpO1xuICAgIHRhc2tTcGFuLmFwcGVuZChpbnB1dEZvcm0pO1xuXG4gICAgY29uc3QgaWNvblNwYW4gPSBjcmVhdGVFbGVtZW50cygpLmNyZWF0ZVNwYW5FbGVtZW50KCdpY29ucycpO1xuICAgIGNvbnN0IGVkaXRJY29uID0gY3JlYXRlRWxlbWVudHMoKS5jcmVhdGVJbWFnZUVsZW1lbnQoJ2ltYWdlcy9lZGl0LWljb24uc3ZnJywgJ2VkaXQtaWNvbicpO1xuICAgIGNvbnN0IGRlbGV0ZUljb24gPSBjcmVhdGVFbGVtZW50cygpLmNyZWF0ZUltYWdlRWxlbWVudCgnaW1hZ2VzL2RlbGV0ZS1pY29uLnN2ZycsICdkZWxldGUtaWNvbicpO1xuXG4gICAgaWNvblNwYW4uYXBwZW5kKGVkaXRJY29uLCBkZWxldGVJY29uKTtcbiAgICB0YXNrU3Bhbi5hcHBlbmQoaWNvblNwYW4pO1xuICAgIGNvbnN0IGR1ZURhdGUgPSBhZGREdWVEYXRlVG9ET00oKTtcbiAgICB0YXNrTGlzdEVsZW1lbnQuYXBwZW5kKHRhc2tTcGFuLCBkdWVEYXRlKTtcbiAgICBcbiAgICBjb25zdCBjb250YWluZXIgPSBhZGRUYXNrQnRuLmNsb3Nlc3QoJy50b2RvcycpO1xuICAgIGNvbnN0IG51bWJlck9mVGFza3MgPSBjb250YWluZXIuY2hpbGRFbGVtZW50Q291bnQgLSAyO1xuXG4gICAgY29udGFpbmVyLmluc2VydEJlZm9yZSh0YXNrTGlzdEVsZW1lbnQsIGNvbnRhaW5lci5jaGlsZHJlbltudW1iZXJPZlRhc2tzXSk7XG4gICAgXG4gICAgLy8gV2hhdCBpcyB0aGlzPz8/XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGlucHV0RmllbGQuZm9jdXMoKTtcbiAgICB9LCAwKTtcblxuICAgIHJldHVybiB0YXNrU3Bhbjtcbn1cblxuY29uc3QgZWRpdFRhc2sgPSAodGFzaykgPT4ge1xuICAgIGlmICh0YXNrLmNsYXNzTGlzdC5jb250YWlucygnY29tcGxldGVkJykpIHJldHVybjtcbiAgICBjb25zdCB0YXNrVGV4dFNwYW4gPSB0YXNrLnF1ZXJ5U2VsZWN0b3IoJy50YXNrLXRleHQnKTtcbiAgICBjb25zdCB0YXNrTmFtZSA9IHRhc2tUZXh0U3Bhbi50ZXh0Q29udGVudDtcbiAgICB0YXNrVGV4dFNwYW4ucmVtb3ZlKCk7XG4gICAgXG4gICAgY29uc3QgaW5wdXRGb3JtID0gY3JlYXRlRWxlbWVudHMoKS5jcmVhdGVGb3JtKCk7XG4gICAgY29uc3QgaW5wdXRGaWVsZCA9IGNyZWF0ZUVsZW1lbnRzKCkuY3JlYXRlSW5wdXRGaWVsZCgnRW50ZXIgVGFzay4uLicpO1xuICAgIFxuICAgIGlucHV0RmllbGQudmFsdWUgPSB0YXNrTmFtZTtcbiAgICBpbnB1dEZvcm0uYXBwZW5kKGlucHV0RmllbGQpO1xuXG4gICAgY29uc3QgdGFza1NwYW4gPSB0YXNrLnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWl0ZW0nKTtcbiAgICBjb25zdCBpY29uU3BhbiA9IHRhc2sucXVlcnlTZWxlY3RvcignLmljb25zJyk7XG5cbiAgICB0YXNrU3Bhbi5pbnNlcnRCZWZvcmUoaW5wdXRGb3JtLCBpY29uU3Bhbik7XG5cbiAgICB0YXNrLnByZXBlbmQodGFza1NwYW4pO1xuICAgIGlucHV0RmllbGQuZm9jdXMoKTtcbiAgICBhZGRUYXNrKCk7XG59XG5cbmNvbnN0IGRlbGV0ZVRhc2sgPSAocHJvamVjdElkLCB0YXNrSWQpID0+IHtcbiAgICBjb25zdCB0YXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtdGFzay1pZD1cIiR7dGFza0lkfVwiXWApO1xuICAgIHRhc2sucmVtb3ZlKCk7XG4gICAgdXBkYXRlU3RvcmFnZS5kZWxldGVUYXNrKHByb2plY3RJZCwgdGFza0lkKTtcbn1cblxuY29uc3QgYWRkVGFzayA9ICgpID0+IHtcbiAgICBjb25zdCBpbnB1dEZpZWxkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3VzZXItaW5wdXQnKTtcbiAgICBjb25zdCBpbnB1dEZvcm0gPSBpbnB1dEZpZWxkLnBhcmVudEVsZW1lbnQ7XG4gICAgY29uc3QgdGFza0NvbnRhaW5lciA9IGlucHV0Rm9ybS5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgXG4gICAgaW5wdXRGaWVsZC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zdCBwcm9qZWN0SWQgPSB0YXNrQ29udGFpbmVyLmNsb3Nlc3QoJ1tkYXRhLXByb2plY3QtaWRdJykuZGF0YXNldC5wcm9qZWN0SWQ7XG4gICAgICAgIGNvbnN0IHRhc2sgPSBpbnB1dEZpZWxkLnZhbHVlO1xuICAgICAgICB2YWxpZGF0ZVVzZXJJbnB1dCgpO1xuICAgICAgICBpZiAodGFzaykgY3JlYXRlVGFzayh0YXNrLCBwcm9qZWN0SWQsIHRhc2tDb250YWluZXIpO1xuICAgIH0pO1xuICAgIFxuICAgIGlucHV0Rm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IHByb2plY3RJZCA9IHRhc2tDb250YWluZXIuY2xvc2VzdCgnW2RhdGEtcHJvamVjdC1pZF0nKS5kYXRhc2V0LnByb2plY3RJZDtcbiAgICAgICAgY29uc3QgdGFzayA9IGlucHV0RmllbGQudmFsdWU7XG4gICAgICAgIHZhbGlkYXRlVXNlcklucHV0KCk7XG4gICAgICAgIGlmICh0YXNrKSBjcmVhdGVUYXNrKHRhc2ssIHByb2plY3RJZCwgdGFza0NvbnRhaW5lcik7XG4gICAgfSk7XG59XG5cbmNvbnN0IGNyZWF0ZVRhc2sgPSAodGFzaywgcHJvamVjdElkLCB0YXNrQ29udGFpbmVyKSA9PiB7XG4gICAgaWYgKHRhc2tDb250YWluZXIuZGF0YXNldC50YXNrSWQpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZXJzLm9uVGFza05hbWVFZGl0KHByb2plY3RJZCwgdGFza0NvbnRhaW5lci5kYXRhc2V0LnRhc2tJZCwgdGFzayk7XG4gICAgfVxuICAgIGNvbnN0IHRhc2tPYmogPSBoYW5kbGVycy5vblRhc2tBZGQodGFzaywgcHJvamVjdElkKTtcbiAgICB0YXNrQ29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS10YXNrLWlkJywgdGFza09iai50YXNrSWQpO1xufVxuXG5jb25zdCB2YWxpZGF0ZVVzZXJJbnB1dCA9ICgpID0+IHtcbiAgICBjb25zdCBpbnB1dEZpZWxkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3VzZXItaW5wdXQnKTtcbiAgICBjb25zdCBpbnB1dEZvcm0gPSBpbnB1dEZpZWxkLnBhcmVudEVsZW1lbnQ7XG4gICAgY29uc3QgdGFza0l0ZW0gPSBpbnB1dEZvcm0ucGFyZW50RWxlbWVudDtcbiAgICBjb25zdCB0YXNrQ29udGFpbmVyID0gdGFza0l0ZW0ucGFyZW50RWxlbWVudDtcblxuICAgIGNvbnN0IHVzZXJJbnB1dCA9IGlucHV0RmllbGQudmFsdWUudHJpbSgpO1xuICAgIGNvbnN0IHRhc2tUZXh0U3BhbiA9IGNyZWF0ZUVsZW1lbnRzKCkuY3JlYXRlU3BhbkVsZW1lbnQoJ3Rhc2stdGV4dCcpO1xuICAgIHRhc2tUZXh0U3Bhbi5hcHBlbmQodXNlcklucHV0KTtcblxuICAgIC8vIFJlbW92ZXMgdGFzayBjb250YWluZXIgaWYgdGFzayBpc24ndCB5ZXQgaW4gbG9jYWxTdG9yYWdlIChoYXMgYSB0YXNrSWQgZGF0YSBhdHRyaWJ1dGUpXG4gICAgaWYgKHVzZXJJbnB1dCA9PSAnJyAmJiAhdGFza0NvbnRhaW5lci5kYXRhc2V0LnRhc2tJZCkge1xuICAgICAgICB0YXNrQ29udGFpbmVyLnJlbW92ZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgfSBcbiAgICBlbHNlIGlmICh1c2VySW5wdXQgPT0gJycgJiYgdGFza0NvbnRhaW5lci5kYXRhc2V0LnRhc2tJZCkgcmV0dXJuO1xuICAgIGlucHV0Rm9ybS5yZW1vdmUoKTtcbiAgICB0YXNrSXRlbS5wcmVwZW5kKHRhc2tUZXh0U3Bhbik7XG4gICAgXG4gICAgYWRqdXN0RWxlbWVudEhlaWdodCh0YXNrVGV4dFNwYW4sIHRhc2tDb250YWluZXIpO1xufVxuLy8gQWRqdXN0IGVsZW1lbnQgaGVpZ2h0IHRvIGxpbmUgdXAgd2l0aCBub3RlcGFkIGxpbmVzXG5jb25zdCBhZGp1c3RFbGVtZW50SGVpZ2h0ID0gKHRhc2tUZXh0U3BhbiwgdGFza0NvbnRhaW5lcikgPT4ge1xuICAgIGNvbnN0IGhlaWdodEZhY3RvciA9IE1hdGgucm91bmQodGFza0NvbnRhaW5lci5vZmZzZXRIZWlnaHQgLyA0Mik7XG4gICAgY29uc3QgbmV3SGVpZ2h0ID0gaGVpZ2h0RmFjdG9yICogNDI7XG4gICAgdGFza1RleHRTcGFuLnN0eWxlLmhlaWdodCA9IGAke25ld0hlaWdodH1weGA7XG4gICAgdGFza0NvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBgJHtuZXdIZWlnaHR9cHhgO1xufVxuXG5jb25zdCB1cGRhdGVQcmlvcml0eSA9IChldmVudFRhcmdldCkgPT4ge1xuICAgIGNvbnN0IHRhc2tJdGVtQ2xhc3NMaXN0ID0gZXZlbnRUYXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdDtcbiAgICBpZiAodGFza0l0ZW1DbGFzc0xpc3QuY29udGFpbnMoJ2NvbXBsZXRlZCcpKSByZXR1cm47XG4gICAgY29uc3QgcHJvamVjdElkID0gZXZlbnRUYXJnZXQuY2xvc2VzdCgnLnByb2plY3QnKS5kYXRhc2V0LnByb2plY3RJZDtcbiAgICBjb25zdCB0YXNrSWQgPSBldmVudFRhcmdldC5jbG9zZXN0KCdbZGF0YS10YXNrLWlkXScpLmRhdGFzZXQudGFza0lkO1xuXG4gICAgY29uc3QgcHJpb3JpdHlDbGFzc0xpc3QgPSBldmVudFRhcmdldC5jbGFzc0xpc3Q7XG5cbiAgICBpZiAocHJpb3JpdHlDbGFzc0xpc3QuY29udGFpbnMoJ3ByaW9yaXR5LWxvdycpKSB7XG4gICAgICAgIHByaW9yaXR5Q2xhc3NMaXN0LnJlbW92ZSgncHJpb3JpdHktbG93Jyk7XG4gICAgICAgIHByaW9yaXR5Q2xhc3NMaXN0LmFkZCgncHJpb3JpdHktbWVkaXVtJyk7XG4gICAgICAgIHJldHVybiBoYW5kbGVycy5vblRhc2tQcmlvcml0eUVkaXQocHJvamVjdElkLCB0YXNrSWQsICdtZWRpdW0nKTsgXG4gICAgfVxuICAgIGlmIChwcmlvcml0eUNsYXNzTGlzdC5jb250YWlucygncHJpb3JpdHktbWVkaXVtJykpIHtcbiAgICAgICAgcHJpb3JpdHlDbGFzc0xpc3QucmVtb3ZlKCdwcmlvcml0eS1tZWRpdW0nKTtcbiAgICAgICAgcHJpb3JpdHlDbGFzc0xpc3QuYWRkKCdwcmlvcml0eS1oaWdoJyk7XG4gICAgICAgIHJldHVybiBoYW5kbGVycy5vblRhc2tQcmlvcml0eUVkaXQocHJvamVjdElkLCB0YXNrSWQsICdoaWdoJyk7XG4gICAgfVxuICAgIGlmIChwcmlvcml0eUNsYXNzTGlzdC5jb250YWlucygncHJpb3JpdHktaGlnaCcpKSB7XG4gICAgICAgIHByaW9yaXR5Q2xhc3NMaXN0LnJlbW92ZSgncHJpb3JpdHktaGlnaCcpO1xuICAgICAgICBwcmlvcml0eUNsYXNzTGlzdC5hZGQoJ3ByaW9yaXR5LWxvdycpO1xuICAgICAgICByZXR1cm4gaGFuZGxlcnMub25UYXNrUHJpb3JpdHlFZGl0KHByb2plY3RJZCwgdGFza0lkLCAnbG93Jyk7XG4gICAgfVxufVxuXG5leHBvcnQge1xuICAgIHRvZ2dsZVRhc2ssXG4gICAgYWRkVGFza1RvRE9NLFxuICAgIGFkZFRhc2ssXG4gICAgdXBkYXRlUHJpb3JpdHksXG4gICAgZGVsZXRlVGFzayxcbiAgICBlZGl0VGFzayxcbiAgICBhZGp1c3RFbGVtZW50SGVpZ2h0XG59IiwiaW1wb3J0IHsgYWRkUHJvamVjdCwgZGVsZXRlUHJvamVjdCwgZWRpdFByb2plY3QgfSBmcm9tIFwiLi9wcm9qZWN0c1wiO1xuaW1wb3J0IHVwZGF0ZVN0b3JhZ2UgZnJvbSBcIi4vc3RvcmFnZVwiO1xuaW1wb3J0IHsgdXBkYXRlUHJvamVjdExpc3QgfSBmcm9tIFwiLi9jcmVhdGVET01FbGVtZW50c1wiO1xuaW1wb3J0IHsgdG9nZ2xlVGFzaywgYWRkVGFza1RvRE9NLCBhZGRUYXNrLCB1cGRhdGVQcmlvcml0eSwgZGVsZXRlVGFzaywgZWRpdFRhc2ssIGFkanVzdEVsZW1lbnRIZWlnaHQgfSBmcm9tIFwiLi90YXNrc1wiO1xuaW1wb3J0IGhhbmRsZXJzIGZyb20gXCIuL2hhbmRsZXJzXCI7XG5cbi8vIExvYWQgbG9jYWxTdG9yYWdlIGl0ZW1zIG9uIHBhZ2UgbG9hZFxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcbiAgICBjb25zdCBwcm9qZWN0cyA9IHVwZGF0ZVN0b3JhZ2UuZ2V0UHJvamVjdHMoKTtcbiAgICBjb25zdCB0YWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10YWI9XCJob21lXCJdJyk7XG4gICAgXG4gICAgLy8gZW50cmllcyBpcyBhbiBhcnJheSBvZiBhbGwgdGhlIGRpZmZlcmVudCBtdXRhdGlvbnMgdGhhdCBvY2N1cnJlZFxuXG4gICAgLy8gVE9ETyA6IFRISVMgV09SS1MgQlVUIExPT0sgSU5UTyBSZXNpemVPYnNlcnZlciBCRUNBVVNFIElUIEJSRUFLUyBXSEVOIEFESlVTVElORyBTQ1JFRU4gU0laRVxuICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZW50cmllcyA9PiB7XG4gICAgICAgIGVudHJpZXMuZm9yRWFjaChlbnRyeSAgPT4ge1xuICAgICAgICAgICAgaWYgKGVudHJ5LmFkZGVkTm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFza0NvbnRhaW5lcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzaycpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRhc2tDb250YWluZXJzKTtcbiAgICAgICAgICAgICAgICB0YXNrQ29udGFpbmVycy5mb3JFYWNoKGNvbnRhaW5lciA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIucXVlcnlTZWxlY3RvcignLmFkZC10YXNrJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhc2tUZXh0U3BhbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuYWRkLXRhc2snKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdEVsZW1lbnRIZWlnaHQoY29udGFpbmVyLCB0YXNrVGV4dFNwYW4pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFza1RleHRTcGFuID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy50YXNrLXRleHQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdEVsZW1lbnRIZWlnaHQoY29udGFpbmVyLCB0YXNrVGV4dFNwYW4pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IFxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBjb25zdCB3cml0aW5nQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN3cml0aW5nLWFyZWEnKTtcbiAgICBjb25zdCBtdXRhdGlvbkNvbmZpZyA9IHsgY2hpbGRMaXN0OiB0cnVlIH07XG4gICAgXG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZSh3cml0aW5nQXJlYSwgbXV0YXRpb25Db25maWcpO1xuXG4gICAgLy9ub3RlcGFkLk11dGF0aW9uT2JzZXJ2ZXIoKVxuXG4gICAgdXBkYXRlUHJvamVjdExpc3QocHJvamVjdHMpO1xuICAgIGhhbmRsZXJzLm9uSG9tZVRhYlNlbGVjdChwcm9qZWN0cywgdGFiKTtcbn1cblxuLy8gU2lkZWJhciBNb2R1bGVcbmNvbnN0IHNpZGViYXJDb250cm9sbGVyID0gKCgpID0+IHtcblxuICAgIGNvbnN0IG1vYmlsZVRvZ2dsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYXJzLWljb24tbW9iaWxlJyk7XG4gICAgaWYgKHdpbmRvdy5pbm5lcldpZHRoIDw9IDEwMjQgJiYgbW9iaWxlVG9nZ2xlQnRuLmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykpIHtcbiAgICAgICAgbW9iaWxlVG9nZ2xlQnRuLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpO1xuICAgIH1cblxuICAgIGNvbnN0IHNpZGViYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2lkZWJhcicpO1xuICAgIFxuICAgIGNvbnN0IHRvZ2dsZVNpZGViYXIgPSAoKSA9PiB7XG4gICAgICAgIHNpZGViYXIuY2xhc3NMaXN0LnRvZ2dsZSgndG9nZ2xlLXNpZGViYXInKTtcbiAgICAgICAgaWYgKHdpbmRvdy5pbm5lcldpZHRoIDw9IDEwMjQpIG1vYmlsZVRvZ2dsZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgdG9nZ2xlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJhcnMtaWNvbicpO1xuICAgIHRvZ2dsZUJ0bi5mb3JFYWNoKGJ1dHRvbiA9PiB7XG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVNpZGViYXIpO1xuICAgIH0pOyAgICAgICAgXG5cbiAgICBjb25zdCBob21lVGFiID0gc2lkZWJhci5xdWVyeVNlbGVjdG9yKCdbZGF0YS10YWI9XCJob21lXCJdJyk7XG4gICAgY29uc3QgdG9kYXlUYWIgPSBzaWRlYmFyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRhYj1cInRvZGF5XCJdJyk7XG4gICAgY29uc3QgdGhpc1dlZWtUYWIgPSBzaWRlYmFyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRhYj1cInRoaXMtd2Vla1wiXScpO1xuXG4gICAgXG4gICAgaG9tZVRhYi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY29uc3QgcHJvamVjdHMgPSB1cGRhdGVTdG9yYWdlLmdldFByb2plY3RzKCk7XG4gICAgICAgIGhhbmRsZXJzLm9uSG9tZVRhYlNlbGVjdChwcm9qZWN0cywgaG9tZVRhYik7XG4gICAgfSk7XG5cbiAgICB0b2RheVRhYi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY29uc3QgcHJvamVjdHMgPSB1cGRhdGVTdG9yYWdlLmdldFByb2plY3RzKCk7XG4gICAgICAgIGhhbmRsZXJzLm9uVG9kYXlUYWJTZWxlY3QocHJvamVjdHMsIHRvZGF5VGFiKTtcbiAgICB9KTtcblxuICAgIHRoaXNXZWVrVGFiLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBwcm9qZWN0cyA9IHVwZGF0ZVN0b3JhZ2UuZ2V0UHJvamVjdHMoKTtcbiAgICAgICAgaGFuZGxlcnMub25UaGlzV2Vla1RhYlNlbGVjdChwcm9qZWN0cywgdGhpc1dlZWtUYWIpO1xuICAgIH0pO1xuXG59KSgpO1xuXG5jb25zdCBwcm9qZWN0Q29udHJvbGxlciA9ICgoKSA9PiB7XG4gICAgZGVsZXRlUHJvamVjdCgpO1xuICAgIGNvbnN0IGFkZFByb2plY3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1hZGQtcHJvamVjdF0nKTtcbiAgICBhZGRQcm9qZWN0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYWRkUHJvamVjdCk7XG4gICAgY29uc3QgcHJvamVjdExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1saXN0Jyk7XG5cbiAgICBwcm9qZWN0TGlzdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2VkaXQtcHJvamVjdCcpKSB7XG4gICAgICAgICAgICBlZGl0UHJvamVjdChlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufSkoKTtcblxuY29uc3QgdGFza0NvbnRyb2xsZXIgPSAoKCkgPT4ge1xuICAgIGNvbnN0IG5vdGVwYWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubm90ZXBhZCcpO1xuICAgIG5vdGVwYWQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCd0YXNrLXRleHQnKSkge1xuICAgICAgICAgICAgY29uc3QgdGFza0VsZW1lbnQgPSBlLnRhcmdldC5jbG9zZXN0KCcudGFzaycpO1xuICAgICAgICAgICAgdG9nZ2xlVGFzayh0YXNrRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdhZGQtdGFzaycpKSB7XG4gICAgICAgICAgICBhZGRUYXNrVG9ET00oZS50YXJnZXQpO1xuICAgICAgICAgICAgYWRkVGFzaygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncHJpb3JpdHktaWNvbicpKSB7XG4gICAgICAgICAgICB1cGRhdGVQcmlvcml0eShlLnRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2VkaXQtaWNvbicpKSB7XG4gICAgICAgICAgICBjb25zdCB0YXNrID0gZS50YXJnZXQuY2xvc2VzdCgnLnRhc2snKTtcbiAgICAgICAgICAgIGVkaXRUYXNrKHRhc2spO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdkZWxldGUtaWNvbicpKSB7XG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0SWQgPSBlLnRhcmdldC5jbG9zZXN0KCdbZGF0YS1wcm9qZWN0LWlkXScpLmRhdGFzZXQucHJvamVjdElkO1xuICAgICAgICAgICAgY29uc3QgdGFza0lkID0gZS50YXJnZXQuY2xvc2VzdCgnW2RhdGEtdGFzay1pZF0nKS5kYXRhc2V0LnRhc2tJZDtcbiAgICAgICAgICAgIGRlbGV0ZVRhc2socHJvamVjdElkLCB0YXNrSWQpO1xuICAgICAgICB9XG4gICAgfSk7XG59KSgpOyJdLCJuYW1lcyI6WyJnZXRQcm9qZWN0cyIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJzYXZlUHJvamVjdCIsInByb2plY3RUb1NhdmUiLCJwcm9qZWN0cyIsImV4aXN0aW5nIiwiZmluZCIsInByb2plY3QiLCJpZCIsInByb2plY3ROYW1lIiwidGFza3MiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJwdXNoIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsImdldFRhc2tzIiwicHJvamVjdElkIiwiZGVsZXRlUHJvamVjdCIsInVwZGF0ZWRQcm9qZWN0TGlzdCIsImZpbHRlciIsImRlbGV0ZVRhc2siLCJ0YXNrSWQiLCJwcm9qZWN0V2l0aFRhc2siLCJ1cGRhdGVkVGFza09iaiIsInRhc2tPYmoiLCJmaW5kVGFza1RvVXBkYXRlIiwiZXhpc3RpbmdUYXNrSWQiLCJ0YXNrIiwidXBkYXRlVGFzayIsInVwZGF0ZWRUYXNrIiwicHJvamVjdFRvVXBkYXRlIiwidGFza3NBcnJheSIsImluZGV4T2ZVcGRhdGVkVGFzayIsImZpbmRJbmRleCIsInJlcXVpcmVkQXJncyIsInJlcXVpcmVkIiwiYXJncyIsImxlbmd0aCIsIlR5cGVFcnJvciIsInRvRGF0ZSIsImFyZ3VtZW50IiwiYXJndW1lbnRzIiwiYXJnU3RyIiwiT2JqZWN0IiwicHJvdG90eXBlIiwidG9TdHJpbmciLCJjYWxsIiwiRGF0ZSIsImdldFRpbWUiLCJjb25zb2xlIiwid2FybiIsIkVycm9yIiwic3RhY2siLCJOYU4iLCJzdGFydE9mRGF5IiwiZGlydHlEYXRlIiwiZGF0ZSIsInNldEhvdXJzIiwiaXNTYW1lRGF5IiwiZGlydHlEYXRlTGVmdCIsImRpcnR5RGF0ZVJpZ2h0IiwiZGF0ZUxlZnRTdGFydE9mRGF5IiwiZGF0ZVJpZ2h0U3RhcnRPZkRheSIsInRvSW50ZWdlciIsImRpcnR5TnVtYmVyIiwibnVtYmVyIiwiTnVtYmVyIiwiaXNOYU4iLCJjZWlsIiwiTUlMTElTRUNPTkRTX0lOX0hPVVIiLCJwYXR0ZXJucyIsImRhdGVUaW1lRGVsaW1pdGVyIiwidGltZVpvbmVEZWxpbWl0ZXIiLCJ0aW1lem9uZSIsImRhdGVSZWdleCIsInRpbWVSZWdleCIsInRpbWV6b25lUmVnZXgiLCJwYXJzZUlTTyIsImRpcnR5T3B0aW9ucyIsIm9wdGlvbnMiLCJhZGRpdGlvbmFsRGlnaXRzIiwiUmFuZ2VFcnJvciIsImRhdGVTdHJpbmdzIiwic3BsaXREYXRlU3RyaW5nIiwicGFyc2VZZWFyUmVzdWx0IiwicGFyc2VZZWFyIiwicGFyc2VEYXRlIiwicmVzdERhdGVTdHJpbmciLCJ5ZWFyIiwib2Zmc2V0IiwidGltZXN0YW1wIiwidGltZSIsInBhcnNlVGltZSIsInJlc3VsdCIsInNldEZ1bGxZZWFyIiwiZ2V0VVRDRnVsbFllYXIiLCJnZXRVVENNb250aCIsImdldFVUQ0RhdGUiLCJnZXRVVENIb3VycyIsImdldFVUQ01pbnV0ZXMiLCJnZXRVVENTZWNvbmRzIiwiZ2V0VVRDTWlsbGlzZWNvbmRzIiwicGFyc2VUaW1lem9uZSIsImRhdGVTdHJpbmciLCJ0aW1lU3RyaW5nIiwiYXJyYXkiLCJzcGxpdCIsInRlc3QiLCJzdWJzdHIiLCJ0b2tlbiIsImV4ZWMiLCJyZXBsYWNlIiwicmVnZXgiLCJSZWdFeHAiLCJjYXB0dXJlcyIsIm1hdGNoIiwicGFyc2VJbnQiLCJjZW50dXJ5Iiwic2xpY2UiLCJpc1dlZWtEYXRlIiwiZGF5T2ZZZWFyIiwicGFyc2VEYXRlVW5pdCIsIm1vbnRoIiwiZGF5Iiwid2VlayIsImRheU9mV2VlayIsIl95ZWFyIiwidmFsaWRhdGVXZWVrRGF0ZSIsImlzb1dlZWtZZWFyIiwic2V0VVRDRnVsbFllYXIiLCJkaWZmIiwiZ2V0VVRDRGF5Iiwic2V0VVRDRGF0ZSIsImRheU9mSVNPV2Vla1llYXIiLCJkYXlzSW5Nb250aHMiLCJpc0xlYXBZZWFySW5kZXgiLCJ2YWxpZGF0ZURhdGUiLCJ2YWxpZGF0ZURheU9mWWVhckRhdGUiLCJtYXgiLCJ2YWx1ZSIsImhvdXJzIiwicGFyc2VUaW1lVW5pdCIsIm1pbnV0ZXMiLCJzZWNvbmRzIiwidmFsaWRhdGVUaW1lIiwicGFyc2VGbG9hdCIsInRpbWV6b25lU3RyaW5nIiwic2lnbiIsIl9ob3VycyIsInZhbGlkYXRlVGltZXpvbmUiLCJzdGFydE9mV2VlayIsImxvY2FsZSIsImxvY2FsZVdlZWtTdGFydHNPbiIsIndlZWtTdGFydHNPbiIsImRlZmF1bHRXZWVrU3RhcnRzT24iLCJnZXREYXkiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImlzU2FtZVdlZWsiLCJkYXRlTGVmdFN0YXJ0T2ZXZWVrIiwiZGF0ZVJpZ2h0U3RhcnRPZldlZWsiLCJfcmVmcmVzaFByb2plY3RMaXN0IiwidXBkYXRlUHJvamVjdExpc3QiLCJkdWVUb2RheSIsIm5vdyIsImlzVG9kYXkiLCJkdWVEYXRlIiwiZHVlVGhpc1dlZWsiLCJpc1RoaXNXZWVrIiwibG9hZEFsbFByb2plY3RzIiwiY2xlYXJQcm9qZWN0c0Zyb21ET00iLCJub3RlcGFkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZm9yRWFjaCIsImFkZFByb2plY3RUb05vdGVwYWQiLCJwcm9qZWN0VGFza3MiLCJwcm9qZWN0Q29udGFpbmVyIiwidGFza3NMaXN0IiwiYWRkVGFza0J0biIsInRhc2tUb0FkZCIsImxvYWRUYXNrIiwiaW5zZXJ0QmVmb3JlIiwicGFyZW50RWxlbWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJyZW1vdmUiLCJvblByb2plY3RTZWxlY3QiLCJwcm9qZWN0T2JqZWN0Iiwic2VsZWN0ZWRQcm9qZWN0IiwiZGF0YXNldCIsInVwZGF0ZUFjdGl2ZVRhYiIsIm9uUHJvamVjdEFkZCIsIm5ld1Byb2plY3QiLCJvblByb2plY3ROYW1lRWRpdCIsIm9uVGFza0FkZCIsIm5ld1Rhc2siLCJpdGVtIiwicHJpb3JpdHkiLCJpc0NvbXBsZXRlIiwib25UYXNrTmFtZUVkaXQiLCJuZXdUYXNrTmFtZSIsImV4aXN0aW5nVGFzayIsIm9uVGFza1ByaW9yaXR5RWRpdCIsIm5ld1ByaW9yaXR5Iiwib25UYXNrRHVlRGF0ZUVkaXQiLCJuZXdEdWVEYXRlIiwib25UYXNrQ29tcGxldGVFZGl0Iiwib25Ib21lVGFiU2VsZWN0IiwidGFiIiwib25Ub2RheVRhYlNlbGVjdCIsInRhc2tDb250YWluZXIiLCJvblRoaXNXZWVrVGFiU2VsZWN0IiwiY3JlYXRlRWxlbWVudHMiLCJjcmVhdGVMaXN0RWxlbWVudCIsImh0bWxDbGFzcyIsImxpIiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImNyZWF0ZVNwYW5FbGVtZW50Iiwic3BhbiIsImNsYXNzTGlzdCIsImFkZCIsImNyZWF0ZUltYWdlRWxlbWVudCIsInNyYyIsImltZyIsImNyZWF0ZUlucHV0RmllbGQiLCJwbGFjZWhvbGRlclRleHQiLCJ1c2VySW5wdXQiLCJjcmVhdGVGb3JtIiwiY3JlYXRlRGl2IiwiZGl2IiwiY3JlYXRlSWNvblNwYW4iLCJ2aWV3IiwiaWNvblNwYW4iLCJlZGl0SWNvbiIsImRlbGV0ZUljb24iLCJhcHBlbmQiLCJwcm9qZWN0RGl2Iiwic2tpcExpbmUiLCJwcm9qZWN0SGVhZGluZyIsImgyIiwidGV4dENvbnRlbnQiLCJoMyIsInRhc2tzQ29udGFpbmVyIiwiYWRkVGFza0xpc3RFbGVtZW50IiwiYWRkVGFza1NwYW4iLCJhZGRJY29uIiwiYWRkRHVlRGF0ZVRvRE9NIiwiZHVlRGF0ZVNwYW4iLCJwcmlvcml0eUljb24iLCJkYXRlTGFiZWwiLCJkYXRlSW5wdXQiLCJjYWxlbmRhckljb24iLCJhZGRFdmVudExpc3RlbmVyIiwiY2xvc2VzdCIsIl9jcmVhdGVQcm9qZWN0SXRlbUhUTUwiLCJuYW1lIiwicHJvamVjdEl0ZW0iLCJwcm9qZWN0c0xpc3RDb250YWluZXIiLCJhZGRQcm9qZWN0QnRuIiwiY2hpbGRyZW4iLCJjb250YWlucyIsImh0bWwiLCJlIiwidGFyZ2V0Iiwibm9kZU5hbWUiLCJ0YXNrSXRlbSIsInRhc2tOYW1lU3BhbiIsImN1cnJlbnRBY3RpdmVUYWIiLCJhd2FpdGluZ0lucHV0IiwiaGFuZGxlVXNlcklucHV0IiwicHJvamVjdFNwYW4iLCJ0cmltIiwiY2hpbGROb2RlcyIsImFkZFByb2plY3QiLCJwcm9qZWN0c0NvbnRhaW5lciIsInByb2plY3RMaXN0RWxlbWVudCIsInByb2plY3RJbnB1dEZvcm0iLCJwcm9qZWN0TmFtZUlucHV0IiwibGFzdEVsZW1lbnRDaGlsZCIsInNldFRpbWVvdXQiLCJmb2N1cyIsImFkZFByb2plY3RUb1NpZGViYXIiLCJpbnB1dEZvcm0iLCJmaXJzdEVsZW1lbnRDaGlsZCIsInByb2plY3RMaXN0IiwiY2hpbGRFbGVtZW50Q291bnQiLCJnZXRBdHRyaWJ1dGUiLCJwcmV2ZW50RGVmYXVsdCIsImFkZFRhc2siLCJpbnB1dEZpZWxkIiwidmFsaWRhdGVVc2VySW5wdXQiLCJjcmVhdGVUYXNrIiwidGFza1RleHRTcGFuIiwicHJlcGVuZCIsImFkanVzdEVsZW1lbnRIZWlnaHQiLCJuZXdIZWlnaHQiLCJyb3VuZCIsIm9mZnNldEhlaWdodCIsInN0eWxlIiwiaGVpZ2h0Iiwid2luZG93Iiwib25sb2FkIiwib2JzZXJ2ZXIiLCJNdXRhdGlvbk9ic2VydmVyIiwiZW50cmllcyIsImVudHJ5IiwiYWRkZWROb2RlcyIsInRhc2tDb250YWluZXJzIiwibG9nIiwiY29udGFpbmVyIiwid3JpdGluZ0FyZWEiLCJvYnNlcnZlIiwiY2hpbGRMaXN0IiwibW9iaWxlVG9nZ2xlQnRuIiwiZ2V0RWxlbWVudEJ5SWQiLCJpbm5lcldpZHRoIiwidG9nZ2xlIiwic2lkZWJhciIsInRvZ2dsZVNpZGViYXIiLCJidXR0b24iLCJob21lVGFiIiwidG9kYXlUYWIiLCJ0aGlzV2Vla1RhYiIsImNvbmZpcm0iLCJlbGVtZW50IiwicHJldmlvdXNFbGVtZW50U2libGluZyIsInVwZGF0ZU5hbWVPbk5vdGVwYWQiLCJwcm9qZWN0VGFza3NDb250YWluZXIiLCJlZGl0UHJvamVjdCIsInRhc2tFbGVtZW50IiwidG9nZ2xlVGFzayIsInRhc2tMaXN0RWxlbWVudCIsInRhc2tTcGFuIiwibnVtYmVyT2ZUYXNrcyIsImFkZFRhc2tUb0RPTSIsImV2ZW50VGFyZ2V0IiwicHJpb3JpdHlDbGFzc0xpc3QiLCJ1cGRhdGVQcmlvcml0eSIsInRhc2tOYW1lIiwiZWRpdFRhc2siXSwic291cmNlUm9vdCI6IiJ9